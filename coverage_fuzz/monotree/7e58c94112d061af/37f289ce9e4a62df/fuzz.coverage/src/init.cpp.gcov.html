<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - fuzz_coverage.info - src/init.cpp</title>
  <link rel="stylesheet" type="text/css" href="../gcov.css">
</head>

<body>

          <table width="100%" border=0 cellspacing=0 cellpadding=0>
            <tr><td class="title">LCOV - code coverage report</td></tr>
            <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>

            <tr>
              <td width="100%">
                <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="10%" class="headerValue"><a href="../index.html" title="Click to go to top-level">top level</a> - <a href="index.html" title="Click to go to directory src">src</a> - init.cpp<span style="font-size: 80%;"> (source / <a href="init.cpp.func-c.html" title="Click to go to function table">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="5%"></td>
            <td width="5%" class="headerCovTableHead">Coverage</td>
            <td width="5%" class="headerCovTableHead" title="Covered + Uncovered code">Total</td>
            <td width="5%" class="headerCovTableHead" title="Exercised code only">Hit</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">fuzz_coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntryLo">22.6&nbsp;%</td>
            <td class="headerCovTableEntry">1132</td>
            <td class="headerCovTableEntry">256</td>
          </tr>
          <tr>
            <td class="headerItem">Test Date:</td>
            <td class="headerValue">2025-09-02 15:26:03</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntryLo">6.7&nbsp;%</td>
            <td class="headerCovTableEntry">45</td>
            <td class="headerCovTableEntry">3</td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td class="headerItem">Branches:</td>
            <td class="headerCovTableEntryLo">15.5&nbsp;%</td>
            <td class="headerCovTableEntry">3401</td>
            <td class="headerCovTableEntry">526</td>
          </tr>
                  <tr><td><img src="../glass.png" width=3 height=3 alt=""></td></tr>
                </table>
              </td>
            </tr>

            <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
          </table>

          <table cellpadding=0 cellspacing=0 border=0>
            <tr>
              <td><br></td>
            </tr>
            <tr>
              <td>
<pre class="sourceHeading">             Branch data     Line data    Source code</pre>
<pre class="source">
<span id="L1"><span class="lineNum">       1</span>                 :             : // Copyright (c) 2009-2010 Satoshi Nakamoto</span>
<span id="L2"><span class="lineNum">       2</span>                 :             : // Copyright (c) 2009-present The Bitcoin Core developers</span>
<span id="L3"><span class="lineNum">       3</span>                 :             : // Distributed under the MIT software license, see the accompanying</span>
<span id="L4"><span class="lineNum">       4</span>                 :             : // file COPYING or http://www.opensource.org/licenses/mit-license.php.</span>
<span id="L5"><span class="lineNum">       5</span>                 :             : </span>
<span id="L6"><span class="lineNum">       6</span>                 :             : #include &lt;bitcoin-build-config.h&gt; // IWYU pragma: keep</span>
<span id="L7"><span class="lineNum">       7</span>                 :             : </span>
<span id="L8"><span class="lineNum">       8</span>                 :             : #include &lt;init.h&gt;</span>
<span id="L9"><span class="lineNum">       9</span>                 :             : </span>
<span id="L10"><span class="lineNum">      10</span>                 :             : #include &lt;kernel/checks.h&gt;</span>
<span id="L11"><span class="lineNum">      11</span>                 :             : </span>
<span id="L12"><span class="lineNum">      12</span>                 :             : #include &lt;addrman.h&gt;</span>
<span id="L13"><span class="lineNum">      13</span>                 :             : #include &lt;banman.h&gt;</span>
<span id="L14"><span class="lineNum">      14</span>                 :             : #include &lt;blockfilter.h&gt;</span>
<span id="L15"><span class="lineNum">      15</span>                 :             : #include &lt;chain.h&gt;</span>
<span id="L16"><span class="lineNum">      16</span>                 :             : #include &lt;chainparams.h&gt;</span>
<span id="L17"><span class="lineNum">      17</span>                 :             : #include &lt;chainparamsbase.h&gt;</span>
<span id="L18"><span class="lineNum">      18</span>                 :             : #include &lt;clientversion.h&gt;</span>
<span id="L19"><span class="lineNum">      19</span>                 :             : #include &lt;common/args.h&gt;</span>
<span id="L20"><span class="lineNum">      20</span>                 :             : #include &lt;common/system.h&gt;</span>
<span id="L21"><span class="lineNum">      21</span>                 :             : #include &lt;consensus/amount.h&gt;</span>
<span id="L22"><span class="lineNum">      22</span>                 :             : #include &lt;consensus/consensus.h&gt;</span>
<span id="L23"><span class="lineNum">      23</span>                 :             : #include &lt;deploymentstatus.h&gt;</span>
<span id="L24"><span class="lineNum">      24</span>                 :             : #include &lt;hash.h&gt;</span>
<span id="L25"><span class="lineNum">      25</span>                 :             : #include &lt;httprpc.h&gt;</span>
<span id="L26"><span class="lineNum">      26</span>                 :             : #include &lt;httpserver.h&gt;</span>
<span id="L27"><span class="lineNum">      27</span>                 :             : #include &lt;index/blockfilterindex.h&gt;</span>
<span id="L28"><span class="lineNum">      28</span>                 :             : #include &lt;index/coinstatsindex.h&gt;</span>
<span id="L29"><span class="lineNum">      29</span>                 :             : #include &lt;index/txindex.h&gt;</span>
<span id="L30"><span class="lineNum">      30</span>                 :             : #include &lt;init/common.h&gt;</span>
<span id="L31"><span class="lineNum">      31</span>                 :             : #include &lt;interfaces/chain.h&gt;</span>
<span id="L32"><span class="lineNum">      32</span>                 :             : #include &lt;interfaces/init.h&gt;</span>
<span id="L33"><span class="lineNum">      33</span>                 :             : #include &lt;interfaces/ipc.h&gt;</span>
<span id="L34"><span class="lineNum">      34</span>                 :             : #include &lt;interfaces/mining.h&gt;</span>
<span id="L35"><span class="lineNum">      35</span>                 :             : #include &lt;interfaces/node.h&gt;</span>
<span id="L36"><span class="lineNum">      36</span>                 :             : #include &lt;ipc/exception.h&gt;</span>
<span id="L37"><span class="lineNum">      37</span>                 :             : #include &lt;kernel/caches.h&gt;</span>
<span id="L38"><span class="lineNum">      38</span>                 :             : #include &lt;kernel/context.h&gt;</span>
<span id="L39"><span class="lineNum">      39</span>                 :             : #include &lt;key.h&gt;</span>
<span id="L40"><span class="lineNum">      40</span>                 :             : #include &lt;logging.h&gt;</span>
<span id="L41"><span class="lineNum">      41</span>                 :             : #include &lt;mapport.h&gt;</span>
<span id="L42"><span class="lineNum">      42</span>                 :             : #include &lt;net.h&gt;</span>
<span id="L43"><span class="lineNum">      43</span>                 :             : #include &lt;net_permissions.h&gt;</span>
<span id="L44"><span class="lineNum">      44</span>                 :             : #include &lt;net_processing.h&gt;</span>
<span id="L45"><span class="lineNum">      45</span>                 :             : #include &lt;netbase.h&gt;</span>
<span id="L46"><span class="lineNum">      46</span>                 :             : #include &lt;netgroup.h&gt;</span>
<span id="L47"><span class="lineNum">      47</span>                 :             : #include &lt;node/blockmanager_args.h&gt;</span>
<span id="L48"><span class="lineNum">      48</span>                 :             : #include &lt;node/blockstorage.h&gt;</span>
<span id="L49"><span class="lineNum">      49</span>                 :             : #include &lt;node/caches.h&gt;</span>
<span id="L50"><span class="lineNum">      50</span>                 :             : #include &lt;node/chainstate.h&gt;</span>
<span id="L51"><span class="lineNum">      51</span>                 :             : #include &lt;node/chainstatemanager_args.h&gt;</span>
<span id="L52"><span class="lineNum">      52</span>                 :             : #include &lt;node/context.h&gt;</span>
<span id="L53"><span class="lineNum">      53</span>                 :             : #include &lt;node/interface_ui.h&gt;</span>
<span id="L54"><span class="lineNum">      54</span>                 :             : #include &lt;node/kernel_notifications.h&gt;</span>
<span id="L55"><span class="lineNum">      55</span>                 :             : #include &lt;node/mempool_args.h&gt;</span>
<span id="L56"><span class="lineNum">      56</span>                 :             : #include &lt;node/mempool_persist.h&gt;</span>
<span id="L57"><span class="lineNum">      57</span>                 :             : #include &lt;node/mempool_persist_args.h&gt;</span>
<span id="L58"><span class="lineNum">      58</span>                 :             : #include &lt;node/miner.h&gt;</span>
<span id="L59"><span class="lineNum">      59</span>                 :             : #include &lt;node/peerman_args.h&gt;</span>
<span id="L60"><span class="lineNum">      60</span>                 :             : #include &lt;policy/feerate.h&gt;</span>
<span id="L61"><span class="lineNum">      61</span>                 :             : #include &lt;policy/fees.h&gt;</span>
<span id="L62"><span class="lineNum">      62</span>                 :             : #include &lt;policy/fees_args.h&gt;</span>
<span id="L63"><span class="lineNum">      63</span>                 :             : #include &lt;policy/policy.h&gt;</span>
<span id="L64"><span class="lineNum">      64</span>                 :             : #include &lt;policy/settings.h&gt;</span>
<span id="L65"><span class="lineNum">      65</span>                 :             : #include &lt;protocol.h&gt;</span>
<span id="L66"><span class="lineNum">      66</span>                 :             : #include &lt;rpc/blockchain.h&gt;</span>
<span id="L67"><span class="lineNum">      67</span>                 :             : #include &lt;rpc/register.h&gt;</span>
<span id="L68"><span class="lineNum">      68</span>                 :             : #include &lt;rpc/server.h&gt;</span>
<span id="L69"><span class="lineNum">      69</span>                 :             : #include &lt;rpc/util.h&gt;</span>
<span id="L70"><span class="lineNum">      70</span>                 :             : #include &lt;scheduler.h&gt;</span>
<span id="L71"><span class="lineNum">      71</span>                 :             : #include &lt;script/sigcache.h&gt;</span>
<span id="L72"><span class="lineNum">      72</span>                 :             : #include &lt;sync.h&gt;</span>
<span id="L73"><span class="lineNum">      73</span>                 :             : #include &lt;torcontrol.h&gt;</span>
<span id="L74"><span class="lineNum">      74</span>                 :             : #include &lt;txdb.h&gt;</span>
<span id="L75"><span class="lineNum">      75</span>                 :             : #include &lt;txmempool.h&gt;</span>
<span id="L76"><span class="lineNum">      76</span>                 :             : #include &lt;util/asmap.h&gt;</span>
<span id="L77"><span class="lineNum">      77</span>                 :             : #include &lt;util/batchpriority.h&gt;</span>
<span id="L78"><span class="lineNum">      78</span>                 :             : #include &lt;util/chaintype.h&gt;</span>
<span id="L79"><span class="lineNum">      79</span>                 :             : #include &lt;util/check.h&gt;</span>
<span id="L80"><span class="lineNum">      80</span>                 :             : #include &lt;util/fs.h&gt;</span>
<span id="L81"><span class="lineNum">      81</span>                 :             : #include &lt;util/fs_helpers.h&gt;</span>
<span id="L82"><span class="lineNum">      82</span>                 :             : #include &lt;util/moneystr.h&gt;</span>
<span id="L83"><span class="lineNum">      83</span>                 :             : #include &lt;util/result.h&gt;</span>
<span id="L84"><span class="lineNum">      84</span>                 :             : #include &lt;util/signalinterrupt.h&gt;</span>
<span id="L85"><span class="lineNum">      85</span>                 :             : #include &lt;util/strencodings.h&gt;</span>
<span id="L86"><span class="lineNum">      86</span>                 :             : #include &lt;util/string.h&gt;</span>
<span id="L87"><span class="lineNum">      87</span>                 :             : #include &lt;util/syserror.h&gt;</span>
<span id="L88"><span class="lineNum">      88</span>                 :             : #include &lt;util/thread.h&gt;</span>
<span id="L89"><span class="lineNum">      89</span>                 :             : #include &lt;util/threadnames.h&gt;</span>
<span id="L90"><span class="lineNum">      90</span>                 :             : #include &lt;util/time.h&gt;</span>
<span id="L91"><span class="lineNum">      91</span>                 :             : #include &lt;util/translation.h&gt;</span>
<span id="L92"><span class="lineNum">      92</span>                 :             : #include &lt;validation.h&gt;</span>
<span id="L93"><span class="lineNum">      93</span>                 :             : #include &lt;validationinterface.h&gt;</span>
<span id="L94"><span class="lineNum">      94</span>                 :             : #include &lt;walletinitinterface.h&gt;</span>
<span id="L95"><span class="lineNum">      95</span>                 :             : </span>
<span id="L96"><span class="lineNum">      96</span>                 :             : #include &lt;algorithm&gt;</span>
<span id="L97"><span class="lineNum">      97</span>                 :             : #include &lt;cerrno&gt;</span>
<span id="L98"><span class="lineNum">      98</span>                 :             : #include &lt;condition_variable&gt;</span>
<span id="L99"><span class="lineNum">      99</span>                 :             : #include &lt;cstdint&gt;</span>
<span id="L100"><span class="lineNum">     100</span>                 :             : #include &lt;cstdio&gt;</span>
<span id="L101"><span class="lineNum">     101</span>                 :             : #include &lt;fstream&gt;</span>
<span id="L102"><span class="lineNum">     102</span>                 :             : #include &lt;functional&gt;</span>
<span id="L103"><span class="lineNum">     103</span>                 :             : #include &lt;set&gt;</span>
<span id="L104"><span class="lineNum">     104</span>                 :             : #include &lt;string&gt;</span>
<span id="L105"><span class="lineNum">     105</span>                 :             : #include &lt;thread&gt;</span>
<span id="L106"><span class="lineNum">     106</span>                 :             : #include &lt;vector&gt;</span>
<span id="L107"><span class="lineNum">     107</span>                 :             : </span>
<span id="L108"><span class="lineNum">     108</span>                 :             : #ifndef WIN32</span>
<span id="L109"><span class="lineNum">     109</span>                 :             : #include &lt;csignal&gt;</span>
<span id="L110"><span class="lineNum">     110</span>                 :             : #include &lt;sys/stat.h&gt;</span>
<span id="L111"><span class="lineNum">     111</span>                 :             : #endif</span>
<span id="L112"><span class="lineNum">     112</span>                 :             : </span>
<span id="L113"><span class="lineNum">     113</span>                 :             : #include &lt;boost/signals2/signal.hpp&gt;</span>
<span id="L114"><span class="lineNum">     114</span>                 :             : </span>
<span id="L115"><span class="lineNum">     115</span>                 :             : #ifdef ENABLE_ZMQ</span>
<span id="L116"><span class="lineNum">     116</span>                 :             : #include &lt;zmq/zmqabstractnotifier.h&gt;</span>
<span id="L117"><span class="lineNum">     117</span>                 :             : #include &lt;zmq/zmqnotificationinterface.h&gt;</span>
<span id="L118"><span class="lineNum">     118</span>                 :             : #include &lt;zmq/zmqrpc.h&gt;</span>
<span id="L119"><span class="lineNum">     119</span>                 :             : #endif</span>
<span id="L120"><span class="lineNum">     120</span>                 :             : </span>
<span id="L121"><span class="lineNum">     121</span>                 :             : using common::AmountErrMsg;</span>
<span id="L122"><span class="lineNum">     122</span>                 :             : using common::InvalidPortErrMsg;</span>
<span id="L123"><span class="lineNum">     123</span>                 :             : using common::ResolveErrMsg;</span>
<span id="L124"><span class="lineNum">     124</span>                 :             : </span>
<span id="L125"><span class="lineNum">     125</span>                 :             : using node::ApplyArgsManOptions;</span>
<span id="L126"><span class="lineNum">     126</span>                 :             : using node::BlockManager;</span>
<span id="L127"><span class="lineNum">     127</span>                 :             : using node::CalculateCacheSizes;</span>
<span id="L128"><span class="lineNum">     128</span>                 :             : using node::ChainstateLoadResult;</span>
<span id="L129"><span class="lineNum">     129</span>                 :             : using node::ChainstateLoadStatus;</span>
<span id="L130"><span class="lineNum">     130</span>                 :             : using node::DEFAULT_PERSIST_MEMPOOL;</span>
<span id="L131"><span class="lineNum">     131</span>                 :             : using node::DEFAULT_PRINT_MODIFIED_FEE;</span>
<span id="L132"><span class="lineNum">     132</span>                 :             : using node::DEFAULT_STOPATHEIGHT;</span>
<span id="L133"><span class="lineNum">     133</span>                 :             : using node::DumpMempool;</span>
<span id="L134"><span class="lineNum">     134</span>                 :             : using node::ImportBlocks;</span>
<span id="L135"><span class="lineNum">     135</span>                 :             : using node::KernelNotifications;</span>
<span id="L136"><span class="lineNum">     136</span>                 :             : using node::LoadChainstate;</span>
<span id="L137"><span class="lineNum">     137</span>                 :             : using node::LoadMempool;</span>
<span id="L138"><span class="lineNum">     138</span>                 :             : using node::MempoolPath;</span>
<span id="L139"><span class="lineNum">     139</span>                 :             : using node::NodeContext;</span>
<span id="L140"><span class="lineNum">     140</span>                 :             : using node::ShouldPersistMempool;</span>
<span id="L141"><span class="lineNum">     141</span>                 :             : using node::VerifyLoadedChainstate;</span>
<span id="L142"><span class="lineNum">     142</span>                 :             : using util::Join;</span>
<span id="L143"><span class="lineNum">     143</span>                 :             : using util::ReplaceAll;</span>
<span id="L144"><span class="lineNum">     144</span>                 :             : using util::ToString;</span>
<span id="L145"><span class="lineNum">     145</span>                 :             : </span>
<span id="L146"><span class="lineNum">     146</span>                 :             : static constexpr bool DEFAULT_PROXYRANDOMIZE{true};</span>
<span id="L147"><span class="lineNum">     147</span>                 :             : static constexpr bool DEFAULT_REST_ENABLE{false};</span>
<span id="L148"><span class="lineNum">     148</span>                 :             : static constexpr bool DEFAULT_I2P_ACCEPT_INCOMING{true};</span>
<span id="L149"><span class="lineNum">     149</span>                 :             : static constexpr bool DEFAULT_STOPAFTERBLOCKIMPORT{false};</span>
<span id="L150"><span class="lineNum">     150</span>                 :             : </span>
<span id="L151"><span class="lineNum">     151</span>                 :             : #ifdef WIN32</span>
<span id="L152"><span class="lineNum">     152</span>                 :             : // Win32 LevelDB doesn't use filedescriptors, and the ones used for</span>
<span id="L153"><span class="lineNum">     153</span>                 :             : // accessing block files don't count towards the fd_set size limit</span>
<span id="L154"><span class="lineNum">     154</span>                 :             : // anyway.</span>
<span id="L155"><span class="lineNum">     155</span>                 :             : #define MIN_LEVELDB_FDS 0</span>
<span id="L156"><span class="lineNum">     156</span>                 :             : #else</span>
<span id="L157"><span class="lineNum">     157</span>                 :             : #define MIN_LEVELDB_FDS 150</span>
<span id="L158"><span class="lineNum">     158</span>                 :             : #endif</span>
<span id="L159"><span class="lineNum">     159</span>                 :             : </span>
<span id="L160"><span class="lineNum">     160</span>                 :             : static constexpr int MIN_CORE_FDS = MIN_LEVELDB_FDS + NUM_FDS_MESSAGE_CAPTURE;</span>
<span id="L161"><span class="lineNum">     161</span>                 :             : static const char* DEFAULT_ASMAP_FILENAME=&quot;ip_asn.map&quot;;</span>
<span id="L162"><span class="lineNum">     162</span>                 :             : </span>
<span id="L163"><span class="lineNum">     163</span>                 :             : /**</span>
<span id="L164"><span class="lineNum">     164</span>                 :             :  * The PID file facilities.</span>
<span id="L165"><span class="lineNum">     165</span>                 :             :  */</span>
<span id="L166"><span class="lineNum">     166</span>                 :             : static const char* BITCOIN_PID_FILENAME = &quot;bitcoind.pid&quot;;</span>
<span id="L167"><span class="lineNum">     167</span>                 :             : /**</span>
<span id="L168"><span class="lineNum">     168</span>                 :             :  * True if this process has created a PID file.</span>
<span id="L169"><span class="lineNum">     169</span>                 :             :  * Used to determine whether we should remove the PID file on shutdown.</span>
<span id="L170"><span class="lineNum">     170</span>                 :             :  */</span>
<span id="L171"><span class="lineNum">     171</span>                 :             : static bool g_generated_pid{false};</span>
<span id="L172"><span class="lineNum">     172</span>                 :             : </span>
<span id="L173"><span class="lineNum">     173</span>                 :<span class="tlaUNC">           0 : static fs::path GetPidFile(const ArgsManager&amp; args)</span></span>
<span id="L174"><span class="lineNum">     174</span>                 :             : {</span>
<span id="L175"><span class="lineNum">     175</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     return AbsPathForConfigVal(args, args.GetPathArg(&quot;-pid&quot;, BITCOIN_PID_FILENAME));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L176"><span class="lineNum">     176</span>                 :             : }</span>
<span id="L177"><span class="lineNum">     177</span>                 :             : </span>
<span id="L178"><span class="lineNum">     178</span>                 :<span class="tlaUNC">           0 : [[nodiscard]] static bool CreatePidFile(const ArgsManager&amp; args)</span></span>
<span id="L179"><span class="lineNum">     179</span>                 :             : {</span>
<span id="L180"><span class="lineNum">     180</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (args.IsArgNegated(&quot;-pid&quot;)) return true;</span></span>
<span id="L181"><span class="lineNum">     181</span>                 :             : </span>
<span id="L182"><span class="lineNum">     182</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     std::ofstream file{GetPidFile(args)};</span></span>
<span id="L183"><span class="lineNum">     183</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (file) {</span></span>
<span id="L184"><span class="lineNum">     184</span>                 :             : #ifdef WIN32</span>
<span id="L185"><span class="lineNum">     185</span>                 :             :         tfm::format(file, &quot;%d\n&quot;, GetCurrentProcessId());</span>
<span id="L186"><span class="lineNum">     186</span>                 :             : #else</span>
<span id="L187"><span class="lineNum">     187</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         tfm::format(file, &quot;%d\n&quot;, getpid());</span></span>
<span id="L188"><span class="lineNum">     188</span>                 :             : #endif</span>
<span id="L189"><span class="lineNum">     189</span>                 :<span class="tlaUNC">           0 :         g_generated_pid = true;</span></span>
<span id="L190"><span class="lineNum">     190</span>                 :<span class="tlaUNC">           0 :         return true;</span></span>
<span id="L191"><span class="lineNum">     191</span>                 :             :     } else {</span>
<span id="L192"><span class="lineNum">     192</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         return InitError(strprintf(_(&quot;Unable to create the PID file '%s': %s&quot;), fs::PathToString(GetPidFile(args)), SysErrorString(errno)));</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L193"><span class="lineNum">     193</span>                 :             :     }</span>
<span id="L194"><span class="lineNum">     194</span>                 :<span class="tlaUNC">           0 : }</span></span>
<span id="L195"><span class="lineNum">     195</span>                 :             : </span>
<span id="L196"><span class="lineNum">     196</span>                 :<span class="tlaUNC">           0 : static void RemovePidFile(const ArgsManager&amp; args)</span></span>
<span id="L197"><span class="lineNum">     197</span>                 :             : {</span>
<span id="L198"><span class="lineNum">     198</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!g_generated_pid) return;</span></span>
<span id="L199"><span class="lineNum">     199</span>                 :<span class="tlaUNC">           0 :     const auto pid_path{GetPidFile(args)};</span></span>
<span id="L200"><span class="lineNum">     200</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (std::error_code error; !fs::remove(pid_path, error)) {</span></span>
<span id="L201"><span class="lineNum">     201</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         std::string msg{error ? error.message() : &quot;File does not exist&quot;};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L202"><span class="lineNum">     202</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         LogPrintf(&quot;Unable to remove PID file (%s): %s\n&quot;, fs::PathToString(pid_path), msg);</span></span>
<span id="L203"><span class="lineNum">     203</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L204"><span class="lineNum">     204</span>                 :<span class="tlaUNC">           0 : }</span></span>
<span id="L205"><span class="lineNum">     205</span>                 :             : </span>
<span id="L206"><span class="lineNum">     206</span>                 :             : static std::optional&lt;util::SignalInterrupt&gt; g_shutdown;</span>
<span id="L207"><span class="lineNum">     207</span>                 :             : </span>
<span id="L208"><span class="lineNum">     208</span>                 :<span class="tlaUNC">           0 : void InitContext(NodeContext&amp; node)</span></span>
<span id="L209"><span class="lineNum">     209</span>                 :             : {</span>
<span id="L210"><span class="lineNum">     210</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     assert(!g_shutdown);</span></span>
<span id="L211"><span class="lineNum">     211</span>                 :<span class="tlaUNC">           0 :     g_shutdown.emplace();</span></span>
<span id="L212"><span class="lineNum">     212</span>                 :             : </span>
<span id="L213"><span class="lineNum">     213</span>                 :<span class="tlaUNC">           0 :     node.args = &amp;gArgs;</span></span>
<span id="L214"><span class="lineNum">     214</span>                 :<span class="tlaUNC">           0 :     node.shutdown_signal = &amp;*g_shutdown;</span></span>
<span id="L215"><span class="lineNum">     215</span>                 :<span class="tlaUNC">           0 :     node.shutdown_request = [&amp;node] {</span></span>
<span id="L216"><span class="lineNum">     216</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         assert(node.shutdown_signal);</span></span>
<span id="L217"><span class="lineNum">     217</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (!(*node.shutdown_signal)()) return false;</span></span>
<span id="L218"><span class="lineNum">     218</span>                 :             :         // Wake any threads that may be waiting for the tip to change.</span>
<span id="L219"><span class="lineNum">     219</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (node.notifications) WITH_LOCK(node.notifications-&gt;m_tip_block_mutex, node.notifications-&gt;m_tip_block_cv.notify_all());</span></span>
<span id="L220"><span class="lineNum">     220</span>                 :             :         return true;</span>
<span id="L221"><span class="lineNum">     221</span>                 :<span class="tlaUNC">           0 :     };</span></span>
<span id="L222"><span class="lineNum">     222</span>                 :<span class="tlaUNC">           0 : }</span></span>
<span id="L223"><span class="lineNum">     223</span>                 :             : </span>
<span id="L224"><span class="lineNum">     224</span>                 :             : //////////////////////////////////////////////////////////////////////////////</span>
<span id="L225"><span class="lineNum">     225</span>                 :             : //</span>
<span id="L226"><span class="lineNum">     226</span>                 :             : // Shutdown</span>
<span id="L227"><span class="lineNum">     227</span>                 :             : //</span>
<span id="L228"><span class="lineNum">     228</span>                 :             : </span>
<span id="L229"><span class="lineNum">     229</span>                 :             : //</span>
<span id="L230"><span class="lineNum">     230</span>                 :             : // Thread management and startup/shutdown:</span>
<span id="L231"><span class="lineNum">     231</span>                 :             : //</span>
<span id="L232"><span class="lineNum">     232</span>                 :             : // The network-processing threads are all part of a thread group</span>
<span id="L233"><span class="lineNum">     233</span>                 :             : // created by AppInit() or the Qt main() function.</span>
<span id="L234"><span class="lineNum">     234</span>                 :             : //</span>
<span id="L235"><span class="lineNum">     235</span>                 :             : // A clean exit happens when the SignalInterrupt object is triggered, which</span>
<span id="L236"><span class="lineNum">     236</span>                 :             : // makes the main thread's SignalInterrupt::wait() call return, and join all</span>
<span id="L237"><span class="lineNum">     237</span>                 :             : // other ongoing threads in the thread group to the main thread.</span>
<span id="L238"><span class="lineNum">     238</span>                 :             : // Shutdown() is then called to clean up database connections, and stop other</span>
<span id="L239"><span class="lineNum">     239</span>                 :             : // threads that should only be stopped after the main network-processing</span>
<span id="L240"><span class="lineNum">     240</span>                 :             : // threads have exited.</span>
<span id="L241"><span class="lineNum">     241</span>                 :             : //</span>
<span id="L242"><span class="lineNum">     242</span>                 :             : // Shutdown for Qt is very similar, only it uses a QTimer to detect</span>
<span id="L243"><span class="lineNum">     243</span>                 :             : // ShutdownRequested() getting set, and then does the normal Qt</span>
<span id="L244"><span class="lineNum">     244</span>                 :             : // shutdown thing.</span>
<span id="L245"><span class="lineNum">     245</span>                 :             : //</span>
<span id="L246"><span class="lineNum">     246</span>                 :             : </span>
<span id="L247"><span class="lineNum">     247</span>                 :<span class="tlaUNC">           0 : bool ShutdownRequested(node::NodeContext&amp; node)</span></span>
<span id="L248"><span class="lineNum">     248</span>                 :             : {</span>
<span id="L249"><span class="lineNum">     249</span>                 :<span class="tlaUNC">           0 :     return bool{*Assert(node.shutdown_signal)};</span></span>
<span id="L250"><span class="lineNum">     250</span>                 :             : }</span>
<span id="L251"><span class="lineNum">     251</span>                 :             : </span>
<span id="L252"><span class="lineNum">     252</span>                 :             : #if HAVE_SYSTEM</span>
<span id="L253"><span class="lineNum">     253</span>                 :<span class="tlaUNC">           0 : static void ShutdownNotify(const ArgsManager&amp; args)</span></span>
<span id="L254"><span class="lineNum">     254</span>                 :             : {</span>
<span id="L255"><span class="lineNum">     255</span>                 :<span class="tlaUNC">           0 :     std::vector&lt;std::thread&gt; threads;</span></span>
<span id="L256"><span class="lineNum">     256</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     for (const auto&amp; cmd : args.GetArgs(&quot;-shutdownnotify&quot;)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L257"><span class="lineNum">     257</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         threads.emplace_back(runCommand, cmd);</span></span>
<span id="L258"><span class="lineNum">     258</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L259"><span class="lineNum">     259</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     for (auto&amp; t : threads) {</span></span>
<span id="L260"><span class="lineNum">     260</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         t.join();</span></span>
<span id="L261"><span class="lineNum">     261</span>                 :             :     }</span>
<span id="L262"><span class="lineNum">     262</span>                 :<span class="tlaUNC">           0 : }</span></span>
<span id="L263"><span class="lineNum">     263</span>                 :             : #endif</span>
<span id="L264"><span class="lineNum">     264</span>                 :             : </span>
<span id="L265"><span class="lineNum">     265</span>                 :<span class="tlaUNC">           0 : void Interrupt(NodeContext&amp; node)</span></span>
<span id="L266"><span class="lineNum">     266</span>                 :             : {</span>
<span id="L267"><span class="lineNum">     267</span>                 :             : #if HAVE_SYSTEM</span>
<span id="L268"><span class="lineNum">     268</span>                 :<span class="tlaUNC">           0 :     ShutdownNotify(*node.args);</span></span>
<span id="L269"><span class="lineNum">     269</span>                 :             : #endif</span>
<span id="L270"><span class="lineNum">     270</span>                 :<span class="tlaUNC">           0 :     InterruptHTTPServer();</span></span>
<span id="L271"><span class="lineNum">     271</span>                 :<span class="tlaUNC">           0 :     InterruptHTTPRPC();</span></span>
<span id="L272"><span class="lineNum">     272</span>                 :<span class="tlaUNC">           0 :     InterruptRPC();</span></span>
<span id="L273"><span class="lineNum">     273</span>                 :<span class="tlaUNC">           0 :     InterruptREST();</span></span>
<span id="L274"><span class="lineNum">     274</span>                 :<span class="tlaUNC">           0 :     InterruptTorControl();</span></span>
<span id="L275"><span class="lineNum">     275</span>                 :<span class="tlaUNC">           0 :     InterruptMapPort();</span></span>
<span id="L276"><span class="lineNum">     276</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (node.connman)</span></span>
<span id="L277"><span class="lineNum">     277</span>                 :<span class="tlaUNC">           0 :         node.connman-&gt;Interrupt();</span></span>
<span id="L278"><span class="lineNum">     278</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     for (auto* index : node.indexes) {</span></span>
<span id="L279"><span class="lineNum">     279</span>                 :<span class="tlaUNC">           0 :         index-&gt;Interrupt();</span></span>
<span id="L280"><span class="lineNum">     280</span>                 :             :     }</span>
<span id="L281"><span class="lineNum">     281</span>                 :<span class="tlaUNC">           0 : }</span></span>
<span id="L282"><span class="lineNum">     282</span>                 :             : </span>
<span id="L283"><span class="lineNum">     283</span>                 :<span class="tlaUNC">           0 : void Shutdown(NodeContext&amp; node)</span></span>
<span id="L284"><span class="lineNum">     284</span>                 :             : {</span>
<span id="L285"><span class="lineNum">     285</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     static Mutex g_shutdown_mutex;</span></span>
<span id="L286"><span class="lineNum">     286</span>                 :<span class="tlaUNC">           0 :     TRY_LOCK(g_shutdown_mutex, lock_shutdown);</span></span>
<span id="L287"><span class="lineNum">     287</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!lock_shutdown) return;</span></span>
<span id="L288"><span class="lineNum">     288</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     LogInfo(&quot;Shutdown in progress...&quot;);</span></span>
<span id="L289"><span class="lineNum">     289</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     Assert(node.args);</span></span>
<span id="L290"><span class="lineNum">     290</span>                 :             : </span>
<span id="L291"><span class="lineNum">     291</span>                 :             :     /// Note: Shutdown() must be able to handle cases in which initialization failed part of the way,</span>
<span id="L292"><span class="lineNum">     292</span>                 :             :     /// for example if the data directory was found to be locked.</span>
<span id="L293"><span class="lineNum">     293</span>                 :             :     /// Be sure that anything that writes files or flushes caches only does this if the respective</span>
<span id="L294"><span class="lineNum">     294</span>                 :             :     /// module was initialized.</span>
<span id="L295"><span class="lineNum">     295</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     util::ThreadRename(&quot;shutoff&quot;);</span></span>
<span id="L296"><span class="lineNum">     296</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (node.mempool) node.mempool-&gt;AddTransactionsUpdated(1);</span></span>
<span id="L297"><span class="lineNum">     297</span>                 :             : </span>
<span id="L298"><span class="lineNum">     298</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     StopHTTPRPC();</span></span>
<span id="L299"><span class="lineNum">     299</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     StopREST();</span></span>
<span id="L300"><span class="lineNum">     300</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     StopRPC();</span></span>
<span id="L301"><span class="lineNum">     301</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     StopHTTPServer();</span></span>
<span id="L302"><span class="lineNum">     302</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     for (auto&amp; client : node.chain_clients) {</span></span>
<span id="L303"><span class="lineNum">     303</span>                 :<span class="tlaUNC">           0 :         try {</span></span>
<span id="L304"><span class="lineNum">     304</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             client-&gt;stop();</span></span>
<span id="L305"><span class="lineNum">     305</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC">           0 :         } catch (const ipc::Exception&amp; e) {</span></span>
<span id="L306"><span class="lineNum">     306</span>   [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaUNC">           0 :             LogDebug(BCLog::IPC, &quot;Chain client did not disconnect cleanly: %s&quot;, e.what());</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L307"><span class="lineNum">     307</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC">           0 :             client.reset();</span></span>
<span id="L308"><span class="lineNum">     308</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC">           0 :         }</span></span>
<span id="L309"><span class="lineNum">     309</span>                 :             :     }</span>
<span id="L310"><span class="lineNum">     310</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     StopMapPort();</span></span>
<span id="L311"><span class="lineNum">     311</span>                 :             : </span>
<span id="L312"><span class="lineNum">     312</span>                 :             :     // Because these depend on each-other, we make sure that neither can be</span>
<span id="L313"><span class="lineNum">     313</span>                 :             :     // using the other before destroying them.</span>
<span id="L314"><span class="lineNum">     314</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (node.peerman &amp;&amp; node.validation_signals) node.validation_signals-&gt;UnregisterValidationInterface(node.peerman.get());</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L315"><span class="lineNum">     315</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (node.connman) node.connman-&gt;Stop();</span></span>
<span id="L316"><span class="lineNum">     316</span>                 :             : </span>
<span id="L317"><span class="lineNum">     317</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     StopTorControl();</span></span>
<span id="L318"><span class="lineNum">     318</span>                 :             : </span>
<span id="L319"><span class="lineNum">     319</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (node.background_init_thread.joinable()) node.background_init_thread.join();</span></span>
<span id="L320"><span class="lineNum">     320</span>                 :             :     // After everything has been shut down, but before things get flushed, stop the</span>
<span id="L321"><span class="lineNum">     321</span>                 :             :     // the scheduler. After this point, SyncWithValidationInterfaceQueue() should not be called anymore</span>
<span id="L322"><span class="lineNum">     322</span>                 :             :     // as this would prevent the shutdown from completing.</span>
<span id="L323"><span class="lineNum">     323</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (node.scheduler) node.scheduler-&gt;stop();</span></span>
<span id="L324"><span class="lineNum">     324</span>                 :             : </span>
<span id="L325"><span class="lineNum">     325</span>                 :             :     // After the threads that potentially access these pointers have been stopped,</span>
<span id="L326"><span class="lineNum">     326</span>                 :             :     // destruct and reset all to nullptr.</span>
<span id="L327"><span class="lineNum">     327</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.peerman.reset();</span></span>
<span id="L328"><span class="lineNum">     328</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.connman.reset();</span></span>
<span id="L329"><span class="lineNum">     329</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.banman.reset();</span></span>
<span id="L330"><span class="lineNum">     330</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.addrman.reset();</span></span>
<span id="L331"><span class="lineNum">     331</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.netgroupman.reset();</span></span>
<span id="L332"><span class="lineNum">     332</span>                 :             : </span>
<span id="L333"><span class="lineNum">     333</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (node.mempool &amp;&amp; node.mempool-&gt;GetLoadTried() &amp;&amp; ShouldPersistMempool(*node.args)) {</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not executed"> # </span>]
<span id="L334"><span class="lineNum">     334</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         DumpMempool(*node.mempool, MempoolPath(*node.args));</span></span>
<span id="L335"><span class="lineNum">     335</span>                 :             :     }</span>
<span id="L336"><span class="lineNum">     336</span>                 :             : </span>
<span id="L337"><span class="lineNum">     337</span>                 :             :     // Drop transactions we were still watching, record fee estimations and unregister</span>
<span id="L338"><span class="lineNum">     338</span>                 :             :     // fee estimator from validation interface.</span>
<span id="L339"><span class="lineNum">     339</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (node.fee_estimator) {</span></span>
<span id="L340"><span class="lineNum">     340</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         node.fee_estimator-&gt;Flush();</span></span>
<span id="L341"><span class="lineNum">     341</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (node.validation_signals) {</span></span>
<span id="L342"><span class="lineNum">     342</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             node.validation_signals-&gt;UnregisterValidationInterface(node.fee_estimator.get());</span></span>
<span id="L343"><span class="lineNum">     343</span>                 :             :         }</span>
<span id="L344"><span class="lineNum">     344</span>                 :             :     }</span>
<span id="L345"><span class="lineNum">     345</span>                 :             : </span>
<span id="L346"><span class="lineNum">     346</span>                 :             :     // FlushStateToDisk generates a ChainStateFlushed callback, which we should avoid missing</span>
<span id="L347"><span class="lineNum">     347</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (node.chainman) {</span></span>
<span id="L348"><span class="lineNum">     348</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         LOCK(cs_main);</span></span>
<span id="L349"><span class="lineNum">     349</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         for (Chainstate* chainstate : node.chainman-&gt;GetAll()) {</span></span>
<span id="L350"><span class="lineNum">     350</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (chainstate-&gt;CanFlushToDisk()) {</span></span>
<span id="L351"><span class="lineNum">     351</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 chainstate-&gt;ForceFlushStateToDisk();</span></span>
<span id="L352"><span class="lineNum">     352</span>                 :             :             }</span>
<span id="L353"><span class="lineNum">     353</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         }</span></span>
<span id="L354"><span class="lineNum">     354</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L355"><span class="lineNum">     355</span>                 :             : </span>
<span id="L356"><span class="lineNum">     356</span>                 :             :     // After there are no more peers/RPC left to give us new data which may generate</span>
<span id="L357"><span class="lineNum">     357</span>                 :             :     // CValidationInterface callbacks, flush them...</span>
<span id="L358"><span class="lineNum">     358</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (node.validation_signals) node.validation_signals-&gt;FlushBackgroundCallbacks();</span></span>
<span id="L359"><span class="lineNum">     359</span>                 :             : </span>
<span id="L360"><span class="lineNum">     360</span>                 :             :     // Stop and delete all indexes only after flushing background callbacks.</span>
<span id="L361"><span class="lineNum">     361</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     for (auto* index : node.indexes) index-&gt;Stop();</span></span>
<span id="L362"><span class="lineNum">     362</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (g_txindex) g_txindex.reset();</span></span>
<span id="L363"><span class="lineNum">     363</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (g_coin_stats_index) g_coin_stats_index.reset();</span></span>
<span id="L364"><span class="lineNum">     364</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     DestroyAllBlockFilterIndexes();</span></span>
<span id="L365"><span class="lineNum">     365</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.indexes.clear(); // all instances are nullptr now</span></span>
<span id="L366"><span class="lineNum">     366</span>                 :             : </span>
<span id="L367"><span class="lineNum">     367</span>                 :             :     // Any future callbacks will be dropped. This should absolutely be safe - if</span>
<span id="L368"><span class="lineNum">     368</span>                 :             :     // missing a callback results in an unrecoverable situation, unclean shutdown</span>
<span id="L369"><span class="lineNum">     369</span>                 :             :     // would too. The only reason to do the above flushes is to let the wallet catch</span>
<span id="L370"><span class="lineNum">     370</span>                 :             :     // up with our current chain to avoid any strange pruning edge cases and make</span>
<span id="L371"><span class="lineNum">     371</span>                 :             :     // next startup faster by avoiding rescan.</span>
<span id="L372"><span class="lineNum">     372</span>                 :             : </span>
<span id="L373"><span class="lineNum">     373</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (node.chainman) {</span></span>
<span id="L374"><span class="lineNum">     374</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         LOCK(cs_main);</span></span>
<span id="L375"><span class="lineNum">     375</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         for (Chainstate* chainstate : node.chainman-&gt;GetAll()) {</span></span>
<span id="L376"><span class="lineNum">     376</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (chainstate-&gt;CanFlushToDisk()) {</span></span>
<span id="L377"><span class="lineNum">     377</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 chainstate-&gt;ForceFlushStateToDisk();</span></span>
<span id="L378"><span class="lineNum">     378</span>                 :<span class="tlaUNC">           0 :                 chainstate-&gt;ResetCoinsViews();</span></span>
<span id="L379"><span class="lineNum">     379</span>                 :             :             }</span>
<span id="L380"><span class="lineNum">     380</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         }</span></span>
<span id="L381"><span class="lineNum">     381</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L382"><span class="lineNum">     382</span>                 :             : </span>
<span id="L383"><span class="lineNum">     383</span>                 :             :     // If any -ipcbind clients are still connected, disconnect them now so they</span>
<span id="L384"><span class="lineNum">     384</span>                 :             :     // do not block shutdown.</span>
<span id="L385"><span class="lineNum">     385</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (interfaces::Ipc* ipc = node.init-&gt;ipc()) {</span></span>
<span id="L386"><span class="lineNum">     386</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         ipc-&gt;disconnectIncoming();</span></span>
<span id="L387"><span class="lineNum">     387</span>                 :             :     }</span>
<span id="L388"><span class="lineNum">     388</span>                 :             : </span>
<span id="L389"><span class="lineNum">     389</span>                 :             : #ifdef ENABLE_ZMQ</span>
<span id="L390"><span class="lineNum">     390</span>                 :             :     if (g_zmq_notification_interface) {</span>
<span id="L391"><span class="lineNum">     391</span>                 :             :         if (node.validation_signals) node.validation_signals-&gt;UnregisterValidationInterface(g_zmq_notification_interface.get());</span>
<span id="L392"><span class="lineNum">     392</span>                 :             :         g_zmq_notification_interface.reset();</span>
<span id="L393"><span class="lineNum">     393</span>                 :             :     }</span>
<span id="L394"><span class="lineNum">     394</span>                 :             : #endif</span>
<span id="L395"><span class="lineNum">     395</span>                 :             : </span>
<span id="L396"><span class="lineNum">     396</span>                 :<span class="tlaUNC">           0 :     node.chain_clients.clear();</span></span>
<span id="L397"><span class="lineNum">     397</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (node.validation_signals) {</span></span>
<span id="L398"><span class="lineNum">     398</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         node.validation_signals-&gt;UnregisterAllValidationInterfaces();</span></span>
<span id="L399"><span class="lineNum">     399</span>                 :             :     }</span>
<span id="L400"><span class="lineNum">     400</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.mempool.reset();</span></span>
<span id="L401"><span class="lineNum">     401</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.fee_estimator.reset();</span></span>
<span id="L402"><span class="lineNum">     402</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.chainman.reset();</span></span>
<span id="L403"><span class="lineNum">     403</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.validation_signals.reset();</span></span>
<span id="L404"><span class="lineNum">     404</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.scheduler.reset();</span></span>
<span id="L405"><span class="lineNum">     405</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.ecc_context.reset();</span></span>
<span id="L406"><span class="lineNum">     406</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.kernel.reset();</span></span>
<span id="L407"><span class="lineNum">     407</span>                 :             : </span>
<span id="L408"><span class="lineNum">     408</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     RemovePidFile(*node.args);</span></span>
<span id="L409"><span class="lineNum">     409</span>                 :             : </span>
<span id="L410"><span class="lineNum">     410</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     LogInfo(&quot;Shutdown done&quot;);</span></span>
<span id="L411"><span class="lineNum">     411</span>                 :<span class="tlaUNC">           0 : }</span></span>
<span id="L412"><span class="lineNum">     412</span>                 :             : </span>
<span id="L413"><span class="lineNum">     413</span>                 :             : /**</span>
<span id="L414"><span class="lineNum">     414</span>                 :             :  * Signal handlers are very limited in what they are allowed to do.</span>
<span id="L415"><span class="lineNum">     415</span>                 :             :  * The execution context the handler is invoked in is not guaranteed,</span>
<span id="L416"><span class="lineNum">     416</span>                 :             :  * so we restrict handler operations to just touching variables:</span>
<span id="L417"><span class="lineNum">     417</span>                 :             :  */</span>
<span id="L418"><span class="lineNum">     418</span>                 :             : #ifndef WIN32</span>
<span id="L419"><span class="lineNum">     419</span>                 :<span class="tlaUNC">           0 : static void HandleSIGTERM(int)</span></span>
<span id="L420"><span class="lineNum">     420</span>                 :             : {</span>
<span id="L421"><span class="lineNum">     421</span>                 :             :     // Return value is intentionally ignored because there is not a better way</span>
<span id="L422"><span class="lineNum">     422</span>                 :             :     // of handling this failure in a signal handler.</span>
<span id="L423"><span class="lineNum">     423</span>                 :<span class="tlaUNC">           0 :     (void)(*Assert(g_shutdown))();</span></span>
<span id="L424"><span class="lineNum">     424</span>                 :<span class="tlaUNC">           0 : }</span></span>
<span id="L425"><span class="lineNum">     425</span>                 :             : </span>
<span id="L426"><span class="lineNum">     426</span>                 :<span class="tlaUNC">           0 : static void HandleSIGHUP(int)</span></span>
<span id="L427"><span class="lineNum">     427</span>                 :             : {</span>
<span id="L428"><span class="lineNum">     428</span>                 :<span class="tlaUNC">           0 :     LogInstance().m_reopen_file = true;</span></span>
<span id="L429"><span class="lineNum">     429</span>                 :<span class="tlaUNC">           0 : }</span></span>
<span id="L430"><span class="lineNum">     430</span>                 :             : #else</span>
<span id="L431"><span class="lineNum">     431</span>                 :             : static BOOL WINAPI consoleCtrlHandler(DWORD dwCtrlType)</span>
<span id="L432"><span class="lineNum">     432</span>                 :             : {</span>
<span id="L433"><span class="lineNum">     433</span>                 :             :     if (!(*Assert(g_shutdown))()) {</span>
<span id="L434"><span class="lineNum">     434</span>                 :             :         LogError(&quot;Failed to send shutdown signal on Ctrl-C\n&quot;);</span>
<span id="L435"><span class="lineNum">     435</span>                 :             :         return false;</span>
<span id="L436"><span class="lineNum">     436</span>                 :             :     }</span>
<span id="L437"><span class="lineNum">     437</span>                 :             :     Sleep(INFINITE);</span>
<span id="L438"><span class="lineNum">     438</span>                 :             :     return true;</span>
<span id="L439"><span class="lineNum">     439</span>                 :             : }</span>
<span id="L440"><span class="lineNum">     440</span>                 :             : #endif</span>
<span id="L441"><span class="lineNum">     441</span>                 :             : </span>
<span id="L442"><span class="lineNum">     442</span>                 :             : #ifndef WIN32</span>
<span id="L443"><span class="lineNum">     443</span>                 :<span class="tlaUNC">           0 : static void registerSignalHandler(int signal, void(*handler)(int))</span></span>
<span id="L444"><span class="lineNum">     444</span>                 :             : {</span>
<span id="L445"><span class="lineNum">     445</span>                 :<span class="tlaUNC">           0 :     struct sigaction sa;</span></span>
<span id="L446"><span class="lineNum">     446</span>                 :<span class="tlaUNC">           0 :     sa.sa_handler = handler;</span></span>
<span id="L447"><span class="lineNum">     447</span>                 :<span class="tlaUNC">           0 :     sigemptyset(&amp;sa.sa_mask);</span></span>
<span id="L448"><span class="lineNum">     448</span>                 :<span class="tlaUNC">           0 :     sa.sa_flags = 0;</span></span>
<span id="L449"><span class="lineNum">     449</span>                 :<span class="tlaUNC">           0 :     sigaction(signal, &amp;sa, nullptr);</span></span>
<span id="L450"><span class="lineNum">     450</span>                 :<span class="tlaUNC">           0 : }</span></span>
<span id="L451"><span class="lineNum">     451</span>                 :             : #endif</span>
<span id="L452"><span class="lineNum">     452</span>                 :             : </span>
<span id="L453"><span class="lineNum">     453</span>                 :<span class="tlaGNC">        1748 : void SetupServerArgs(ArgsManager&amp; argsman, bool can_listen_ipc)</span></span>
<span id="L454"><span class="lineNum">     454</span>                 :             : {</span>
<span id="L455"><span class="lineNum">     455</span>                 :<span class="tlaGNC">        1748 :     SetupHelpOptions(argsman);</span></span>
<span id="L456"><span class="lineNum">     456</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-help-debug&quot;, &quot;Print help message with debugging options and exit&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::DEBUG_TEST); // server-only for now</span></span>
<span id="L457"><span class="lineNum">     457</span>                 :             : </span>
<span id="L458"><span class="lineNum">     458</span>                 :<span class="tlaGNC">        1748 :     init::AddLoggingArgs(argsman);</span></span>
<span id="L459"><span class="lineNum">     459</span>                 :             : </span>
<span id="L460"><span class="lineNum">     460</span>                 :<span class="tlaGNC">        1748 :     const auto defaultBaseParams = CreateBaseChainParams(ChainType::MAIN);</span></span>
<span id="L461"><span class="lineNum">     461</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     const auto testnetBaseParams = CreateBaseChainParams(ChainType::TESTNET);</span></span>
<span id="L462"><span class="lineNum">     462</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     const auto testnet4BaseParams = CreateBaseChainParams(ChainType::TESTNET4);</span></span>
<span id="L463"><span class="lineNum">     463</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     const auto signetBaseParams = CreateBaseChainParams(ChainType::SIGNET);</span></span>
<span id="L464"><span class="lineNum">     464</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     const auto regtestBaseParams = CreateBaseChainParams(ChainType::REGTEST);</span></span>
<span id="L465"><span class="lineNum">     465</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     const auto defaultChainParams = CreateChainParams(argsman, ChainType::MAIN);</span></span>
<span id="L466"><span class="lineNum">     466</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     const auto testnetChainParams = CreateChainParams(argsman, ChainType::TESTNET);</span></span>
<span id="L467"><span class="lineNum">     467</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     const auto testnet4ChainParams = CreateChainParams(argsman, ChainType::TESTNET4);</span></span>
<span id="L468"><span class="lineNum">     468</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     const auto signetChainParams = CreateChainParams(argsman, ChainType::SIGNET);</span></span>
<span id="L469"><span class="lineNum">     469</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     const auto regtestChainParams = CreateChainParams(argsman, ChainType::REGTEST);</span></span>
<span id="L470"><span class="lineNum">     470</span>                 :             : </span>
<span id="L471"><span class="lineNum">     471</span>                 :             :     // Hidden Options</span>
<span id="L472"><span class="lineNum">     472</span>                 :<span class="tlaGNC">        1748 :     std::vector&lt;std::string&gt; hidden_args = {</span></span>
<span id="L473"><span class="lineNum">     473</span>                 :             :         &quot;-dbcrashratio&quot;, &quot;-forcecompactdb&quot;,</span>
<span id="L474"><span class="lineNum">     474</span>                 :             :         // GUI args. These will be overwritten by SetupUIArgs for the GUI</span>
<span id="L475"><span class="lineNum">     475</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :         &quot;-choosedatadir&quot;, &quot;-lang=&lt;lang&gt;&quot;, &quot;-min&quot;, &quot;-resetguisettings&quot;, &quot;-splash&quot;, &quot;-uiplatform&quot;};</span></span>
<span id="L476"><span class="lineNum">     476</span>                 :             : </span>
<span id="L477"><span class="lineNum">     477</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-version&quot;, &quot;Print version and exit&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L478"><span class="lineNum">     478</span>                 :             : #if HAVE_SYSTEM</span>
<span id="L479"><span class="lineNum">     479</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-alertnotify=&lt;cmd&gt;&quot;, &quot;Execute command when an alert is raised (%s in cmd is replaced by message)&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L480"><span class="lineNum">     480</span>                 :             : #endif</span>
<span id="L481"><span class="lineNum">     481</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-assumevalid=&lt;hex&gt;&quot;, strprintf(&quot;If this block is in the chain assume that it and its ancestors are valid and potentially skip their script verification (0 to verify all, default: %s, testnet3: %s, testnet4: %s, signet: %s)&quot;, defaultChainParams-&gt;GetConsensus().defaultAssumeValid.GetHex(), testnetChainParams-&gt;GetConsensus().defaultAssumeValid.GetHex(), testnet4ChainParams-&gt;GetConsensus().defaultAssumeValid.GetHex(), signetChainParams-&gt;GetConsensus().defaultAssumeValid.GetHex()), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 1748 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 1748 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L482"><span class="lineNum">     482</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-blocksdir=&lt;dir&gt;&quot;, &quot;Specify directory to hold blocks subdirectory for *.dat files (default: &lt;datadir&gt;)&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L483"><span class="lineNum">     483</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-blocksxor&quot;,</span></span>
<span id="L484"><span class="lineNum">     484</span>                 :<span class="tlaUNC">           0 :                    strprintf(&quot;Whether an XOR-key applies to blocksdir *.dat files. &quot;</span></span>
<span id="L485"><span class="lineNum">     485</span>                 :             :                              &quot;The created XOR-key will be zeros for an existing blocksdir or when `-blocksxor=0` is &quot;</span>
<span id="L486"><span class="lineNum">     486</span>                 :             :                              &quot;set, and random for a freshly initialized blocksdir. &quot;</span>
<span id="L487"><span class="lineNum">     487</span>                 :             :                              &quot;(default: %u)&quot;,</span>
<span id="L488"><span class="lineNum">     488</span>                 :             :                              kernel::DEFAULT_XOR_BLOCKSDIR),</span>
<span id="L489"><span class="lineNum">     489</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :                    ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span id="L490"><span class="lineNum">     490</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-fastprune&quot;, &quot;Use smaller block files and lower minimum prune height for testing purposes&quot;, ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L491"><span class="lineNum">     491</span>                 :             : #if HAVE_SYSTEM</span>
<span id="L492"><span class="lineNum">     492</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-blocknotify=&lt;cmd&gt;&quot;, &quot;Execute command when the best block changes (%s in cmd is replaced by block hash)&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L493"><span class="lineNum">     493</span>                 :             : #endif</span>
<span id="L494"><span class="lineNum">     494</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-blockreconstructionextratxn=&lt;n&gt;&quot;, strprintf(&quot;Extra transactions to keep in memory for compact block reconstructions (default: %u)&quot;, DEFAULT_BLOCK_RECONSTRUCTION_EXTRA_TXN), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L495"><span class="lineNum">     495</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-blocksonly&quot;, strprintf(&quot;Whether to reject transactions from network peers. Disables automatic broadcast and rebroadcast of transactions, unless the source peer has the 'forcerelay' permission. RPC transactions are not affected. (default: %u)&quot;, DEFAULT_BLOCKSONLY), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L496"><span class="lineNum">     496</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-coinstatsindex&quot;, strprintf(&quot;Maintain coinstats index used by the gettxoutsetinfo RPC (default: %u)&quot;, DEFAULT_COINSTATSINDEX), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L497"><span class="lineNum">     497</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-conf=&lt;file&gt;&quot;, strprintf(&quot;Specify path to read-only configuration file. Relative paths will be prefixed by datadir location (only useable from command line, not configuration file) (default: %s)&quot;, BITCOIN_CONF_FILENAME), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L498"><span class="lineNum">     498</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-datadir=&lt;dir&gt;&quot;, &quot;Specify data directory&quot;, ArgsManager::ALLOW_ANY | ArgsManager::DISALLOW_NEGATION, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L499"><span class="lineNum">     499</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-dbbatchsize&quot;, strprintf(&quot;Maximum database write batch size in bytes (default: %u)&quot;, nDefaultDbBatchSize), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L500"><span class="lineNum">     500</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-dbcache=&lt;n&gt;&quot;, strprintf(&quot;Maximum database cache size &lt;n&gt; MiB (minimum %d, default: %d). Make sure you have enough RAM. In addition, unused memory allocated to the mempool is shared with this cache (see -maxmempool).&quot;, MIN_DB_CACHE &gt;&gt; 20, DEFAULT_DB_CACHE &gt;&gt; 20), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L501"><span class="lineNum">     501</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-includeconf=&lt;file&gt;&quot;, &quot;Specify additional configuration file, relative to the -datadir path (only useable from configuration file, not command line)&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L502"><span class="lineNum">     502</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-allowignoredconf&quot;, strprintf(&quot;For backwards compatibility, treat an unused %s file in the datadir as a warning, not an error.&quot;, BITCOIN_CONF_FILENAME), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L503"><span class="lineNum">     503</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-loadblock=&lt;file&gt;&quot;, &quot;Imports blocks from external file on startup&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L504"><span class="lineNum">     504</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-maxmempool=&lt;n&gt;&quot;, strprintf(&quot;Keep the transaction memory pool below &lt;n&gt; megabytes (default: %u)&quot;, DEFAULT_MAX_MEMPOOL_SIZE_MB), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L505"><span class="lineNum">     505</span>                 :             :     // TODO: remove in v31.0</span>
<span id="L506"><span class="lineNum">     506</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-maxorphantx=&lt;n&gt;&quot;, strprintf(&quot;(Removed option, see release notes)&quot;), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L507"><span class="lineNum">     507</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-mempoolexpiry=&lt;n&gt;&quot;, strprintf(&quot;Do not keep transactions in the mempool longer than &lt;n&gt; hours (default: %u)&quot;, DEFAULT_MEMPOOL_EXPIRY_HOURS), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L508"><span class="lineNum">     508</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-minimumchainwork=&lt;hex&gt;&quot;, strprintf(&quot;Minimum work assumed to exist on a valid chain in hex (default: %s, testnet3: %s, testnet4: %s, signet: %s)&quot;, defaultChainParams-&gt;GetConsensus().nMinimumChainWork.GetHex(), testnetChainParams-&gt;GetConsensus().nMinimumChainWork.GetHex(), testnet4ChainParams-&gt;GetConsensus().nMinimumChainWork.GetHex(), signetChainParams-&gt;GetConsensus().nMinimumChainWork.GetHex()), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 1748 times"> + </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaGBC" title="Branch 12 was taken 1748 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not taken"> - </span>]
<span id="L509"><span class="lineNum">     509</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-par=&lt;n&gt;&quot;, strprintf(&quot;Set the number of script verification threads (0 = auto, up to %d, &lt;0 = leave that many cores free, default: %d)&quot;,</span></span>
<span id="L510"><span class="lineNum">     510</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :         MAX_SCRIPTCHECK_THREADS, DEFAULT_SCRIPTCHECK_THREADS), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span id="L511"><span class="lineNum">     511</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-persistmempool&quot;, strprintf(&quot;Whether to save the mempool on shutdown and load on restart (default: %u)&quot;, DEFAULT_PERSIST_MEMPOOL), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L512"><span class="lineNum">     512</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-persistmempoolv1&quot;,</span></span>
<span id="L513"><span class="lineNum">     513</span>                 :<span class="tlaUNC">           0 :                    strprintf(&quot;Whether a mempool.dat file created by -persistmempool or the savemempool RPC will be written in the legacy format &quot;</span></span>
<span id="L514"><span class="lineNum">     514</span>                 :             :                              &quot;(version 1) or the current format (version 2). This temporary option will be removed in the future. (default: %u)&quot;,</span>
<span id="L515"><span class="lineNum">     515</span>                 :             :                              DEFAULT_PERSIST_V1_DAT),</span>
<span id="L516"><span class="lineNum">     516</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :                    ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span id="L517"><span class="lineNum">     517</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-pid=&lt;file&gt;&quot;, strprintf(&quot;Specify pid file. Relative paths will be prefixed by a net-specific datadir location. (default: %s)&quot;, BITCOIN_PID_FILENAME), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L518"><span class="lineNum">     518</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-prune=&lt;n&gt;&quot;, strprintf(&quot;Reduce storage requirements by enabling pruning (deleting) of old blocks. This allows the pruneblockchain RPC to be called to delete specific blocks and enables automatic pruning of old blocks if a target size in MiB is provided. This mode is incompatible with -txindex. &quot;</span></span>
<span id="L519"><span class="lineNum">     519</span>                 :             :             &quot;Warning: Reverting this setting requires re-downloading the entire blockchain. &quot;</span>
<span id="L520"><span class="lineNum">     520</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :             &quot;(default: 0 = disable pruning blocks, 1 = allow manual pruning via RPC, &gt;=%u = automatically prune block files to stay under the specified target size in MiB)&quot;, MIN_DISK_SPACE_FOR_BLOCK_FILES / 1024 / 1024), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span id="L521"><span class="lineNum">     521</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-reindex&quot;, &quot;If enabled, wipe chain state and block index, and rebuild them from blk*.dat files on disk. Also wipe and rebuild other optional indexes that are active. If an assumeutxo snapshot was loaded, its chainstate will be wiped as well. The snapshot can then be reloaded via RPC.&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L522"><span class="lineNum">     522</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-reindex-chainstate&quot;, &quot;If enabled, wipe chain state, and rebuild it from blk*.dat files on disk. If an assumeutxo snapshot was loaded, its chainstate will be wiped as well. The snapshot can then be reloaded via RPC.&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L523"><span class="lineNum">     523</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-settings=&lt;file&gt;&quot;, strprintf(&quot;Specify path to dynamic settings data file. Can be disabled with -nosettings. File is written at runtime and not meant to be edited by users (use %s instead for custom settings). Relative paths will be prefixed by datadir location. (default: %s)&quot;, BITCOIN_CONF_FILENAME, BITCOIN_SETTINGS_FILENAME), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L524"><span class="lineNum">     524</span>                 :             : #if HAVE_SYSTEM</span>
<span id="L525"><span class="lineNum">     525</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-startupnotify=&lt;cmd&gt;&quot;, &quot;Execute command on startup.&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L526"><span class="lineNum">     526</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-shutdownnotify=&lt;cmd&gt;&quot;, &quot;Execute command immediately before beginning shutdown. The need for shutdown may be urgent, so be careful not to delay it long (if the command doesn't require interaction with the server, consider having it fork into the background).&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L527"><span class="lineNum">     527</span>                 :             : #endif</span>
<span id="L528"><span class="lineNum">     528</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-txindex&quot;, strprintf(&quot;Maintain a full transaction index, used by the getrawtransaction rpc call (default: %u)&quot;, DEFAULT_TXINDEX), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L529"><span class="lineNum">     529</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-blockfilterindex=&lt;type&gt;&quot;,</span></span>
<span id="L530"><span class="lineNum">     530</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        3496 :                  strprintf(&quot;Maintain an index of compact filters by block (default: %s, values: %s).&quot;, DEFAULT_BLOCKFILTERINDEX, ListBlockFilterTypes()) +</span></span>
<span id="L531"><span class="lineNum">     531</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :                  &quot; If &lt;type&gt; is not supplied or if &lt;type&gt; = 1, indexes for all known types are enabled.&quot;,</span></span>
<span id="L532"><span class="lineNum">     532</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :                  ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span id="L533"><span class="lineNum">     533</span>                 :             : </span>
<span id="L534"><span class="lineNum">     534</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-addnode=&lt;ip&gt;&quot;, strprintf(&quot;Add a node to connect to and attempt to keep the connection open (see the addnode RPC help for more info). This option can be specified multiple times to add multiple nodes; connections are limited to %u at a time and are counted separately from the -maxconnections limit.&quot;, MAX_ADDNODE_CONNECTIONS), ArgsManager::ALLOW_ANY | ArgsManager::NETWORK_ONLY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L535"><span class="lineNum">     535</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-asmap=&lt;file&gt;&quot;, strprintf(&quot;Specify asn mapping used for bucketing of the peers (default: %s). Relative paths will be prefixed by the net-specific datadir location.&quot;, DEFAULT_ASMAP_FILENAME), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L536"><span class="lineNum">     536</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-bantime=&lt;n&gt;&quot;, strprintf(&quot;Default duration (in seconds) of manually configured bans (default: %u)&quot;, DEFAULT_MISBEHAVING_BANTIME), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L537"><span class="lineNum">     537</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-bind=&lt;addr&gt;[:&lt;port&gt;][=onion]&quot;, strprintf(&quot;Bind to given address and always listen on it (default: 0.0.0.0). Use [host]:port notation for IPv6. Append =onion to tag any incoming connections to that address and port as incoming Tor connections (default: 127.0.0.1:%u=onion, testnet3: 127.0.0.1:%u=onion, testnet4: 127.0.0.1:%u=onion, signet: 127.0.0.1:%u=onion, regtest: 127.0.0.1:%u=onion)&quot;, defaultChainParams-&gt;GetDefaultPort() + 1, testnetChainParams-&gt;GetDefaultPort() + 1, testnet4ChainParams-&gt;GetDefaultPort() + 1, signetChainParams-&gt;GetDefaultPort() + 1, regtestChainParams-&gt;GetDefaultPort() + 1), ArgsManager::ALLOW_ANY | ArgsManager::NETWORK_ONLY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L538"><span class="lineNum">     538</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-cjdnsreachable&quot;, &quot;If set, then this host is configured for CJDNS (connecting to fc00::/8 addresses would lead us to the CJDNS network, see doc/cjdns.md) (default: 0)&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L539"><span class="lineNum">     539</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-connect=&lt;ip&gt;&quot;, &quot;Connect only to the specified node; -noconnect disables automatic connections (the rules for this peer are the same as for -addnode). This option can be specified multiple times to connect to multiple nodes.&quot;, ArgsManager::ALLOW_ANY | ArgsManager::NETWORK_ONLY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L540"><span class="lineNum">     540</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-discover&quot;, &quot;Discover own IP addresses (default: 1 when listening and no -externalip or -proxy)&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L541"><span class="lineNum">     541</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-dns&quot;, strprintf(&quot;Allow DNS lookups for -addnode, -seednode and -connect (default: %u)&quot;, DEFAULT_NAME_LOOKUP), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L542"><span class="lineNum">     542</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-dnsseed&quot;, strprintf(&quot;Query for peer addresses via DNS lookup, if low on addresses (default: %u unless -connect used or -maxconnections=0)&quot;, DEFAULT_DNSSEED), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L543"><span class="lineNum">     543</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-externalip=&lt;ip&gt;&quot;, &quot;Specify your own public address&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L544"><span class="lineNum">     544</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-fixedseeds&quot;, strprintf(&quot;Allow fixed seeds if DNS seeds don't provide peers (default: %u)&quot;, DEFAULT_FIXEDSEEDS), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L545"><span class="lineNum">     545</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-forcednsseed&quot;, strprintf(&quot;Always query for peer addresses via DNS lookup (default: %u)&quot;, DEFAULT_FORCEDNSSEED), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L546"><span class="lineNum">     546</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-listen&quot;, strprintf(&quot;Accept connections from outside (default: %u if no -proxy, -connect or -maxconnections=0)&quot;, DEFAULT_LISTEN), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L547"><span class="lineNum">     547</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-listenonion&quot;, strprintf(&quot;Automatically create Tor onion service (default: %d)&quot;, DEFAULT_LISTEN_ONION), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L548"><span class="lineNum">     548</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-maxconnections=&lt;n&gt;&quot;, strprintf(&quot;Maintain at most &lt;n&gt; automatic connections to peers (default: %u). This limit does not apply to connections manually added via -addnode or the addnode RPC, which have a separate limit of %u.&quot;, DEFAULT_MAX_PEER_CONNECTIONS, MAX_ADDNODE_CONNECTIONS), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L549"><span class="lineNum">     549</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-maxreceivebuffer=&lt;n&gt;&quot;, strprintf(&quot;Maximum per-connection receive buffer, &lt;n&gt;*1000 bytes (default: %u)&quot;, DEFAULT_MAXRECEIVEBUFFER), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L550"><span class="lineNum">     550</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-maxsendbuffer=&lt;n&gt;&quot;, strprintf(&quot;Maximum per-connection memory usage for the send buffer, &lt;n&gt;*1000 bytes (default: %u)&quot;, DEFAULT_MAXSENDBUFFER), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L551"><span class="lineNum">     551</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-maxuploadtarget=&lt;n&gt;&quot;, strprintf(&quot;Tries to keep outbound traffic under the given target per 24h. Limit does not apply to peers with 'download' permission or blocks created within past week. 0 = no limit (default: %s). Optional suffix units [k|K|m|M|g|G|t|T] (default: M). Lowercase is 1000 base while uppercase is 1024 base&quot;, DEFAULT_MAX_UPLOAD_TARGET), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L552"><span class="lineNum">     552</span>                 :             : #ifdef HAVE_SOCKADDR_UN</span>
<span id="L553"><span class="lineNum">     553</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-onion=&lt;ip:port|path&gt;&quot;, &quot;Use separate SOCKS5 proxy to reach peers via Tor onion services, set -noonion to disable (default: -proxy). May be a local file path prefixed with 'unix:'.&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L554"><span class="lineNum">     554</span>                 :             : #else</span>
<span id="L555"><span class="lineNum">     555</span>                 :             :     argsman.AddArg(&quot;-onion=&lt;ip:port&gt;&quot;, &quot;Use separate SOCKS5 proxy to reach peers via Tor onion services, set -noonion to disable (default: -proxy)&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span>
<span id="L556"><span class="lineNum">     556</span>                 :             : #endif</span>
<span id="L557"><span class="lineNum">     557</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-i2psam=&lt;ip:port&gt;&quot;, &quot;I2P SAM proxy to reach I2P peers and accept I2P connections (default: none)&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L558"><span class="lineNum">     558</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-i2pacceptincoming&quot;, strprintf(&quot;Whether to accept inbound I2P connections (default: %i). Ignored if -i2psam is not set. Listening for inbound I2P connections is done through the SAM proxy, not by binding to a local address and port.&quot;, DEFAULT_I2P_ACCEPT_INCOMING), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L559"><span class="lineNum">     559</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        5244 :     argsman.AddArg(&quot;-onlynet=&lt;net&gt;&quot;, &quot;Make automatic outbound connections only to network &lt;net&gt; (&quot; + Join(GetNetworkNames(), &quot;, &quot;) + &quot;). Inbound and manual connections are not affected by this option. It can be specified multiple times to allow multiple networks.&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 1748 times"> + </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not taken"> - </span>]
<span id="L560"><span class="lineNum">     560</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-v2transport&quot;, strprintf(&quot;Support v2 transport (default: %u)&quot;, DEFAULT_V2_TRANSPORT), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L561"><span class="lineNum">     561</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-peerbloomfilters&quot;, strprintf(&quot;Support filtering of blocks and transaction with bloom filters (default: %u)&quot;, DEFAULT_PEERBLOOMFILTERS), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L562"><span class="lineNum">     562</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-peerblockfilters&quot;, strprintf(&quot;Serve compact block filters to peers per BIP 157 (default: %u)&quot;, DEFAULT_PEERBLOCKFILTERS), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L563"><span class="lineNum">     563</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-txreconciliation&quot;, strprintf(&quot;Enable transaction reconciliations per BIP 330 (default: %d)&quot;, DEFAULT_TXRECONCILIATION_ENABLE), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L564"><span class="lineNum">     564</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-port=&lt;port&gt;&quot;, strprintf(&quot;Listen for connections on &lt;port&gt; (default: %u, testnet3: %u, testnet4: %u, signet: %u, regtest: %u). Not relevant for I2P (see doc/i2p.md). If set to a value x, the default onion listening port will be set to x+1.&quot;, defaultChainParams-&gt;GetDefaultPort(), testnetChainParams-&gt;GetDefaultPort(), testnet4ChainParams-&gt;GetDefaultPort(), signetChainParams-&gt;GetDefaultPort(), regtestChainParams-&gt;GetDefaultPort()), ArgsManager::ALLOW_ANY | ArgsManager::NETWORK_ONLY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L565"><span class="lineNum">     565</span>                 :<span class="tlaGNC">        1748 :     const std::string proxy_doc_for_value =</span></span>
<span id="L566"><span class="lineNum">     566</span>                 :             : #ifdef HAVE_SOCKADDR_UN</span>
<span id="L567"><span class="lineNum">     567</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :         &quot;&lt;ip&gt;[:&lt;port&gt;]|unix:&lt;path&gt;&quot;;</span></span>
<span id="L568"><span class="lineNum">     568</span>                 :             : #else</span>
<span id="L569"><span class="lineNum">     569</span>                 :             :         &quot;&lt;ip&gt;[:&lt;port&gt;]&quot;;</span>
<span id="L570"><span class="lineNum">     570</span>                 :             : #endif</span>
<span id="L571"><span class="lineNum">     571</span>                 :<span class="tlaGNC">        1748 :     const std::string proxy_doc_for_unix_socket =</span></span>
<span id="L572"><span class="lineNum">     572</span>                 :             : #ifdef HAVE_SOCKADDR_UN</span>
<span id="L573"><span class="lineNum">     573</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :         &quot;May be a local file path prefixed with 'unix:' if the proxy supports it. &quot;;</span></span>
<span id="L574"><span class="lineNum">     574</span>                 :             : #else</span>
<span id="L575"><span class="lineNum">     575</span>                 :             :         &quot;&quot;;</span>
<span id="L576"><span class="lineNum">     576</span>                 :             : #endif</span>
<span id="L577"><span class="lineNum">     577</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-proxy=&quot; + proxy_doc_for_value + &quot;[=&lt;network&gt;]&quot;,</span></span>
<span id="L578"><span class="lineNum">     578</span>                 :<span class="tlaUNC">           0 :                    &quot;Connect through SOCKS5 proxy, set -noproxy to disable. &quot; +</span></span>
<span id="L579"><span class="lineNum">     579</span>                 :<span class="tlaGNC">        1748 :                    proxy_doc_for_unix_socket +</span></span>
<span id="L580"><span class="lineNum">     580</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        3496 :                    &quot;Could end in =network to set the proxy only for that network. &quot; +</span></span>
<span id="L581"><span class="lineNum">     581</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        3496 :                    &quot;The network can be any of ipv4, ipv6, tor or cjdns. &quot; +</span></span>
<span id="L582"><span class="lineNum">     582</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :                    &quot;(default: disabled)&quot;,</span></span>
<span id="L583"><span class="lineNum">     583</span>                 :             :                    ArgsManager::ALLOW_ANY | ArgsManager::DISALLOW_ELISION,</span>
<span id="L584"><span class="lineNum">     584</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :                    OptionsCategory::CONNECTION);</span></span>
<span id="L585"><span class="lineNum">     585</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-proxyrandomize&quot;, strprintf(&quot;Randomize credentials for every proxy connection. This enables Tor stream isolation (default: %u)&quot;, DEFAULT_PROXYRANDOMIZE), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L586"><span class="lineNum">     586</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-seednode=&lt;ip&gt;&quot;, &quot;Connect to a node to retrieve peer addresses, and disconnect. This option can be specified multiple times to connect to multiple nodes. During startup, seednodes will be tried before dnsseeds.&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L587"><span class="lineNum">     587</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-networkactive&quot;, &quot;Enable all P2P network activity (default: 1). Can be changed by the setnetworkactive RPC command&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L588"><span class="lineNum">     588</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-timeout=&lt;n&gt;&quot;, strprintf(&quot;Specify socket connection timeout in milliseconds. If an initial attempt to connect is unsuccessful after this amount of time, drop it (minimum: 1, default: %d)&quot;, DEFAULT_CONNECT_TIMEOUT), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L589"><span class="lineNum">     589</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-peertimeout=&lt;n&gt;&quot;, strprintf(&quot;Specify a p2p connection timeout delay in seconds. After connecting to a peer, wait this amount of time before considering disconnection based on inactivity (minimum: 1, default: %d)&quot;, DEFAULT_PEER_CONNECT_TIMEOUT), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L590"><span class="lineNum">     590</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-torcontrol=&lt;ip&gt;:&lt;port&gt;&quot;, strprintf(&quot;Tor control host and port to use if onion listening enabled (default: %s). If no port is specified, the default port of %i will be used.&quot;, DEFAULT_TOR_CONTROL, DEFAULT_TOR_CONTROL_PORT), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L591"><span class="lineNum">     591</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-torpassword=&lt;pass&gt;&quot;, &quot;Tor control port password (default: empty)&quot;, ArgsManager::ALLOW_ANY | ArgsManager::SENSITIVE, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L592"><span class="lineNum">     592</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-natpmp&quot;, strprintf(&quot;Use PCP or NAT-PMP to map the listening port (default: %u)&quot;, DEFAULT_NATPMP), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L593"><span class="lineNum">     593</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-whitebind=&lt;[permissions@]addr&gt;&quot;, &quot;Bind to the given address and add permission flags to the peers connecting to it. &quot;</span></span>
<span id="L594"><span class="lineNum">     594</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        3496 :         &quot;Use [host]:port notation for IPv6. Allowed permissions: &quot; + Join(NET_PERMISSIONS_DOC, &quot;, &quot;) + &quot;. &quot;</span></span>
<span id="L595"><span class="lineNum">     595</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        3496 :         &quot;Specify multiple permissions separated by commas (default: download,noban,mempool,relay). Can be specified multiple times.&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span id="L596"><span class="lineNum">     596</span>                 :             : </span>
<span id="L597"><span class="lineNum">     597</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-whitelist=&lt;[permissions@]IP address or network&gt;&quot;, &quot;Add permission flags to the peers using the given IP address (e.g. 1.2.3.4) or &quot;</span></span>
<span id="L598"><span class="lineNum">     598</span>                 :             :         &quot;CIDR-notated network (e.g. 1.2.3.0/24). Uses the same permissions as &quot;</span>
<span id="L599"><span class="lineNum">     599</span>                 :             :         &quot;-whitebind. &quot;</span>
<span id="L600"><span class="lineNum">     600</span>                 :             :         &quot;Additional flags \&quot;in\&quot; and \&quot;out\&quot; control whether permissions apply to incoming connections and/or manual (default: incoming only). &quot;</span>
<span id="L601"><span class="lineNum">     601</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :         &quot;Can be specified multiple times.&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);</span></span>
<span id="L602"><span class="lineNum">     602</span>                 :             : </span>
<span id="L603"><span class="lineNum">     603</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     g_wallet_init_interface.AddWalletOptions(argsman);</span></span>
<span id="L604"><span class="lineNum">     604</span>                 :             : </span>
<span id="L605"><span class="lineNum">     605</span>                 :             : #ifdef ENABLE_ZMQ</span>
<span id="L606"><span class="lineNum">     606</span>                 :             :     argsman.AddArg(&quot;-zmqpubhashblock=&lt;address&gt;&quot;, &quot;Enable publish hash block in &lt;address&gt;&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::ZMQ);</span>
<span id="L607"><span class="lineNum">     607</span>                 :             :     argsman.AddArg(&quot;-zmqpubhashtx=&lt;address&gt;&quot;, &quot;Enable publish hash transaction in &lt;address&gt;&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::ZMQ);</span>
<span id="L608"><span class="lineNum">     608</span>                 :             :     argsman.AddArg(&quot;-zmqpubrawblock=&lt;address&gt;&quot;, &quot;Enable publish raw block in &lt;address&gt;&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::ZMQ);</span>
<span id="L609"><span class="lineNum">     609</span>                 :             :     argsman.AddArg(&quot;-zmqpubrawtx=&lt;address&gt;&quot;, &quot;Enable publish raw transaction in &lt;address&gt;&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::ZMQ);</span>
<span id="L610"><span class="lineNum">     610</span>                 :             :     argsman.AddArg(&quot;-zmqpubsequence=&lt;address&gt;&quot;, &quot;Enable publish hash block and tx sequence in &lt;address&gt;&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::ZMQ);</span>
<span id="L611"><span class="lineNum">     611</span>                 :             :     argsman.AddArg(&quot;-zmqpubhashblockhwm=&lt;n&gt;&quot;, strprintf(&quot;Set publish hash block outbound message high water mark (default: %d)&quot;, CZMQAbstractNotifier::DEFAULT_ZMQ_SNDHWM), ArgsManager::ALLOW_ANY, OptionsCategory::ZMQ);</span>
<span id="L612"><span class="lineNum">     612</span>                 :             :     argsman.AddArg(&quot;-zmqpubhashtxhwm=&lt;n&gt;&quot;, strprintf(&quot;Set publish hash transaction outbound message high water mark (default: %d)&quot;, CZMQAbstractNotifier::DEFAULT_ZMQ_SNDHWM), ArgsManager::ALLOW_ANY, OptionsCategory::ZMQ);</span>
<span id="L613"><span class="lineNum">     613</span>                 :             :     argsman.AddArg(&quot;-zmqpubrawblockhwm=&lt;n&gt;&quot;, strprintf(&quot;Set publish raw block outbound message high water mark (default: %d)&quot;, CZMQAbstractNotifier::DEFAULT_ZMQ_SNDHWM), ArgsManager::ALLOW_ANY, OptionsCategory::ZMQ);</span>
<span id="L614"><span class="lineNum">     614</span>                 :             :     argsman.AddArg(&quot;-zmqpubrawtxhwm=&lt;n&gt;&quot;, strprintf(&quot;Set publish raw transaction outbound message high water mark (default: %d)&quot;, CZMQAbstractNotifier::DEFAULT_ZMQ_SNDHWM), ArgsManager::ALLOW_ANY, OptionsCategory::ZMQ);</span>
<span id="L615"><span class="lineNum">     615</span>                 :             :     argsman.AddArg(&quot;-zmqpubsequencehwm=&lt;n&gt;&quot;, strprintf(&quot;Set publish hash sequence message high water mark (default: %d)&quot;, CZMQAbstractNotifier::DEFAULT_ZMQ_SNDHWM), ArgsManager::ALLOW_ANY, OptionsCategory::ZMQ);</span>
<span id="L616"><span class="lineNum">     616</span>                 :             : #else</span>
<span id="L617"><span class="lineNum">     617</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     hidden_args.emplace_back(&quot;-zmqpubhashblock=&lt;address&gt;&quot;);</span></span>
<span id="L618"><span class="lineNum">     618</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     hidden_args.emplace_back(&quot;-zmqpubhashtx=&lt;address&gt;&quot;);</span></span>
<span id="L619"><span class="lineNum">     619</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     hidden_args.emplace_back(&quot;-zmqpubrawblock=&lt;address&gt;&quot;);</span></span>
<span id="L620"><span class="lineNum">     620</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     hidden_args.emplace_back(&quot;-zmqpubrawtx=&lt;address&gt;&quot;);</span></span>
<span id="L621"><span class="lineNum">     621</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     hidden_args.emplace_back(&quot;-zmqpubsequence=&lt;n&gt;&quot;);</span></span>
<span id="L622"><span class="lineNum">     622</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     hidden_args.emplace_back(&quot;-zmqpubhashblockhwm=&lt;n&gt;&quot;);</span></span>
<span id="L623"><span class="lineNum">     623</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     hidden_args.emplace_back(&quot;-zmqpubhashtxhwm=&lt;n&gt;&quot;);</span></span>
<span id="L624"><span class="lineNum">     624</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     hidden_args.emplace_back(&quot;-zmqpubrawblockhwm=&lt;n&gt;&quot;);</span></span>
<span id="L625"><span class="lineNum">     625</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     hidden_args.emplace_back(&quot;-zmqpubrawtxhwm=&lt;n&gt;&quot;);</span></span>
<span id="L626"><span class="lineNum">     626</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     hidden_args.emplace_back(&quot;-zmqpubsequencehwm=&lt;n&gt;&quot;);</span></span>
<span id="L627"><span class="lineNum">     627</span>                 :             : #endif</span>
<span id="L628"><span class="lineNum">     628</span>                 :             : </span>
<span id="L629"><span class="lineNum">     629</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-checkblocks=&lt;n&gt;&quot;, strprintf(&quot;How many blocks to check at startup (default: %u, 0 = all)&quot;, DEFAULT_CHECKBLOCKS), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L630"><span class="lineNum">     630</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-checklevel=&lt;n&gt;&quot;, strprintf(&quot;How thorough the block verification of -checkblocks is: %s (0-4, default: %u)&quot;, Join(CHECKLEVEL_DOC, &quot;, &quot;), DEFAULT_CHECKLEVEL), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L631"><span class="lineNum">     631</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-checkblockindex&quot;, strprintf(&quot;Do a consistency check for the block tree, chainstate, and other validation data structures every &lt;n&gt; operations. Use 0 to disable. (default: %u, regtest: %u)&quot;, defaultChainParams-&gt;DefaultConsistencyChecks(), regtestChainParams-&gt;DefaultConsistencyChecks()), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L632"><span class="lineNum">     632</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-checkaddrman=&lt;n&gt;&quot;, strprintf(&quot;Run addrman consistency checks every &lt;n&gt; operations. Use 0 to disable. (default: %u)&quot;, DEFAULT_ADDRMAN_CONSISTENCY_CHECKS), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L633"><span class="lineNum">     633</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-checkmempool=&lt;n&gt;&quot;, strprintf(&quot;Run mempool consistency checks every &lt;n&gt; transactions. Use 0 to disable. (default: %u, regtest: %u)&quot;, defaultChainParams-&gt;DefaultConsistencyChecks(), regtestChainParams-&gt;DefaultConsistencyChecks()), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L634"><span class="lineNum">     634</span>                 :             :     // Checkpoints were removed. We keep `-checkpoints` as a hidden arg to display a more user friendly error when set.</span>
<span id="L635"><span class="lineNum">     635</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-checkpoints&quot;, &quot;&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::HIDDEN);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L636"><span class="lineNum">     636</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-deprecatedrpc=&lt;method&gt;&quot;, &quot;Allows deprecated RPC method(s) to be used&quot;, ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L637"><span class="lineNum">     637</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-stopafterblockimport&quot;, strprintf(&quot;Stop running after importing blocks from disk (default: %u)&quot;, DEFAULT_STOPAFTERBLOCKIMPORT), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L638"><span class="lineNum">     638</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-stopatheight&quot;, strprintf(&quot;Stop running after reaching the given height in the main chain (default: %u)&quot;, DEFAULT_STOPATHEIGHT), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L639"><span class="lineNum">     639</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-limitancestorcount=&lt;n&gt;&quot;, strprintf(&quot;Do not accept transactions if number of in-mempool ancestors is &lt;n&gt; or more (default: %u)&quot;, DEFAULT_ANCESTOR_LIMIT), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L640"><span class="lineNum">     640</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-limitancestorsize=&lt;n&gt;&quot;, strprintf(&quot;Do not accept transactions whose size with all in-mempool ancestors exceeds &lt;n&gt; kilobytes (default: %u)&quot;, DEFAULT_ANCESTOR_SIZE_LIMIT_KVB), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L641"><span class="lineNum">     641</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-limitdescendantcount=&lt;n&gt;&quot;, strprintf(&quot;Do not accept transactions if any ancestor would have &lt;n&gt; or more in-mempool descendants (default: %u)&quot;, DEFAULT_DESCENDANT_LIMIT), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L642"><span class="lineNum">     642</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-limitdescendantsize=&lt;n&gt;&quot;, strprintf(&quot;Do not accept transactions if any ancestor would have more than &lt;n&gt; kilobytes of in-mempool descendants (default: %u).&quot;, DEFAULT_DESCENDANT_SIZE_LIMIT_KVB), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L643"><span class="lineNum">     643</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        5244 :     argsman.AddArg(&quot;-test=&lt;option&gt;&quot;, &quot;Pass a test-only option. Options include : &quot; + Join(TEST_OPTIONS_DOC, &quot;, &quot;) + &quot;.&quot;, ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L644"><span class="lineNum">     644</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-capturemessages&quot;, &quot;Capture all P2P messages to disk&quot;, ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L645"><span class="lineNum">     645</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        5244 :     argsman.AddArg(&quot;-mocktime=&lt;n&gt;&quot;, &quot;Replace actual time with &quot; + UNIX_EPOCH_TIME + &quot; (default: 0)&quot;, ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L646"><span class="lineNum">     646</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-maxsigcachesize=&lt;n&gt;&quot;, strprintf(&quot;Limit sum of signature cache and script execution cache sizes to &lt;n&gt; MiB (default: %u)&quot;, DEFAULT_VALIDATION_CACHE_BYTES &gt;&gt; 20), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L647"><span class="lineNum">     647</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-maxtipage=&lt;n&gt;&quot;,</span></span>
<span id="L648"><span class="lineNum">     648</span>                 :<span class="tlaUNC">           0 :                    strprintf(&quot;Maximum tip age in seconds to consider node in initial block download (default: %u)&quot;,</span></span>
<span id="L649"><span class="lineNum">     649</span>                 :<span class="tlaGNC">        1748 :                              Ticks&lt;std::chrono::seconds&gt;(DEFAULT_MAX_TIP_AGE)),</span></span>
<span id="L650"><span class="lineNum">     650</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :                    ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span id="L651"><span class="lineNum">     651</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-printpriority&quot;, strprintf(&quot;Log transaction fee rate in %s/kvB when mining blocks (default: %u)&quot;, CURRENCY_UNIT, DEFAULT_PRINT_MODIFIED_FEE), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L652"><span class="lineNum">     652</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-uacomment=&lt;cmt&gt;&quot;, &quot;Append comment to the user agent string&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L653"><span class="lineNum">     653</span>                 :             : </span>
<span id="L654"><span class="lineNum">     654</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     SetupChainParamsBaseOptions(argsman);</span></span>
<span id="L655"><span class="lineNum">     655</span>                 :             : </span>
<span id="L656"><span class="lineNum">     656</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-acceptnonstdtxn&quot;, strprintf(&quot;Relay and mine \&quot;non-standard\&quot; transactions (test networks only; default: %u)&quot;, DEFAULT_ACCEPT_NON_STD_TXN), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::NODE_RELAY);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L657"><span class="lineNum">     657</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-incrementalrelayfee=&lt;amt&gt;&quot;, strprintf(&quot;Fee rate (in %s/kvB) used to define cost of relay, used for mempool limiting and replacement policy. (default: %s)&quot;, CURRENCY_UNIT, FormatMoney(DEFAULT_INCREMENTAL_RELAY_FEE)), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::NODE_RELAY);</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L658"><span class="lineNum">     658</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-dustrelayfee=&lt;amt&gt;&quot;, strprintf(&quot;Fee rate (in %s/kvB) used to define dust, the value of an output such that it will cost more than its value in fees at this fee rate to spend it. (default: %s)&quot;, CURRENCY_UNIT, FormatMoney(DUST_RELAY_TX_FEE)), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::NODE_RELAY);</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L659"><span class="lineNum">     659</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-acceptstalefeeestimates&quot;, strprintf(&quot;Read fee estimates even if they are stale (%sdefault: %u) fee estimates are considered stale if they are %s hours old&quot;, &quot;regtest only; &quot;, DEFAULT_ACCEPT_STALE_FEE_ESTIMATES, Ticks&lt;std::chrono::hours&gt;(MAX_FILE_AGE)), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::DEBUG_TEST);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L660"><span class="lineNum">     660</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-bytespersigop&quot;, strprintf(&quot;Equivalent bytes per sigop in transactions for relay and mining (default: %u)&quot;, DEFAULT_BYTES_PER_SIGOP), ArgsManager::ALLOW_ANY, OptionsCategory::NODE_RELAY);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L661"><span class="lineNum">     661</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-datacarrier&quot;, strprintf(&quot;(DEPRECATED) Relay and mine data carrier transactions (default: %u)&quot;, DEFAULT_ACCEPT_DATACARRIER), ArgsManager::ALLOW_ANY, OptionsCategory::NODE_RELAY);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L662"><span class="lineNum">     662</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-datacarriersize&quot;,</span></span>
<span id="L663"><span class="lineNum">     663</span>                 :<span class="tlaUNC">           0 :                    strprintf(&quot;(DEPRECATED) Relay and mine transactions whose data-carrying raw scriptPubKeys in aggregate &quot;</span></span>
<span id="L664"><span class="lineNum">     664</span>                 :             :                              &quot;are of this size or less, allowing multiple outputs (default: %u)&quot;,</span>
<span id="L665"><span class="lineNum">     665</span>                 :             :                              MAX_OP_RETURN_RELAY),</span>
<span id="L666"><span class="lineNum">     666</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :                    ArgsManager::ALLOW_ANY, OptionsCategory::NODE_RELAY);</span></span>
<span id="L667"><span class="lineNum">     667</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-permitbaremultisig&quot;, strprintf(&quot;Relay transactions creating non-P2SH multisig outputs (default: %u)&quot;, DEFAULT_PERMIT_BAREMULTISIG), ArgsManager::ALLOW_ANY,</span></span>
<span id="L668"><span class="lineNum">     668</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :                    OptionsCategory::NODE_RELAY);</span></span>
<span id="L669"><span class="lineNum">     669</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-minrelaytxfee=&lt;amt&gt;&quot;, strprintf(&quot;Fees (in %s/kvB) smaller than this are considered zero fee for relaying, mining and transaction creation (default: %s)&quot;,</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L670"><span class="lineNum">     670</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :         CURRENCY_UNIT, FormatMoney(DEFAULT_MIN_RELAY_TX_FEE)), ArgsManager::ALLOW_ANY, OptionsCategory::NODE_RELAY);</span></span>
<span id="L671"><span class="lineNum">     671</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-whitelistforcerelay&quot;, strprintf(&quot;Add 'forcerelay' permission to whitelisted peers with default permissions. This will relay transactions even if the transactions were already in the mempool. (default: %d)&quot;, DEFAULT_WHITELISTFORCERELAY), ArgsManager::ALLOW_ANY, OptionsCategory::NODE_RELAY);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L672"><span class="lineNum">     672</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-whitelistrelay&quot;, strprintf(&quot;Add 'relay' permission to whitelisted peers with default permissions. This will accept relayed transactions even when not relaying transactions (default: %d)&quot;, DEFAULT_WHITELISTRELAY), ArgsManager::ALLOW_ANY, OptionsCategory::NODE_RELAY);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L673"><span class="lineNum">     673</span>                 :             : </span>
<span id="L674"><span class="lineNum">     674</span>                 :             : </span>
<span id="L675"><span class="lineNum">     675</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-blockmaxweight=&lt;n&gt;&quot;, strprintf(&quot;Set maximum BIP141 block weight (default: %d)&quot;, DEFAULT_BLOCK_MAX_WEIGHT), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::BLOCK_CREATION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L676"><span class="lineNum">     676</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-blockreservedweight=&lt;n&gt;&quot;, strprintf(&quot;Reserve space for the fixed-size block header plus the largest coinbase transaction the mining software may add to the block. (default: %d).&quot;, DEFAULT_BLOCK_RESERVED_WEIGHT), ArgsManager::ALLOW_ANY, OptionsCategory::BLOCK_CREATION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L677"><span class="lineNum">     677</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-blockmintxfee=&lt;amt&gt;&quot;, strprintf(&quot;Set lowest fee rate (in %s/kvB) for transactions to be included in block creation. (default: %s)&quot;, CURRENCY_UNIT, FormatMoney(DEFAULT_BLOCK_MIN_TX_FEE)), ArgsManager::ALLOW_ANY, OptionsCategory::BLOCK_CREATION);</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L678"><span class="lineNum">     678</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-blockversion=&lt;n&gt;&quot;, &quot;Override block version to test forking scenarios&quot;, ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::BLOCK_CREATION);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L679"><span class="lineNum">     679</span>                 :             : </span>
<span id="L680"><span class="lineNum">     680</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-rest&quot;, strprintf(&quot;Accept public REST requests (default: %u)&quot;, DEFAULT_REST_ENABLE), ArgsManager::ALLOW_ANY, OptionsCategory::RPC);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L681"><span class="lineNum">     681</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-rpcallowip=&lt;ip&gt;&quot;, &quot;Allow JSON-RPC connections from specified source. Valid values for &lt;ip&gt; are a single IP (e.g. 1.2.3.4), a network/netmask (e.g. 1.2.3.4/255.255.255.0), a network/CIDR (e.g. 1.2.3.4/24), all ipv4 (0.0.0.0/0), or all ipv6 (::/0). RFC4193 is allowed only if -cjdnsreachable=0. This option can be specified multiple times&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::RPC);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L682"><span class="lineNum">     682</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-rpcauth=&lt;userpw&gt;&quot;, &quot;Username and HMAC-SHA-256 hashed password for JSON-RPC connections. The field &lt;userpw&gt; comes in the format: &lt;USERNAME&gt;:&lt;SALT&gt;$&lt;HASH&gt;. A canonical python script is included in share/rpcauth. The client then connects normally using the rpcuser=&lt;USERNAME&gt;/rpcpassword=&lt;PASSWORD&gt; pair of arguments. This option can be specified multiple times&quot;, ArgsManager::ALLOW_ANY | ArgsManager::SENSITIVE, OptionsCategory::RPC);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L683"><span class="lineNum">     683</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-rpcbind=&lt;addr&gt;[:port]&quot;, &quot;Bind to given address to listen for JSON-RPC connections. Do not expose the RPC server to untrusted networks such as the public internet! This option is ignored unless -rpcallowip is also passed. Port is optional and overrides -rpcport. Use [host]:port notation for IPv6. This option can be specified multiple times (default: 127.0.0.1 and ::1 i.e., localhost)&quot;, ArgsManager::ALLOW_ANY | ArgsManager::NETWORK_ONLY, OptionsCategory::RPC);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L684"><span class="lineNum">     684</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-rpcdoccheck&quot;, strprintf(&quot;Throw a non-fatal error at runtime if the documentation for an RPC is incorrect (default: %u)&quot;, DEFAULT_RPC_DOC_CHECK), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::RPC);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L685"><span class="lineNum">     685</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-rpccookiefile=&lt;loc&gt;&quot;, &quot;Location of the auth cookie. Relative paths will be prefixed by a net-specific datadir location. (default: data dir)&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::RPC);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L686"><span class="lineNum">     686</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-rpccookieperms=&lt;readable-by&gt;&quot;, strprintf(&quot;Set permissions on the RPC auth cookie file so that it is readable by [owner|group|all] (default: owner [via umask 0077])&quot;), ArgsManager::ALLOW_ANY, OptionsCategory::RPC);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L687"><span class="lineNum">     687</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-rpcpassword=&lt;pw&gt;&quot;, &quot;Password for JSON-RPC connections&quot;, ArgsManager::ALLOW_ANY | ArgsManager::SENSITIVE, OptionsCategory::RPC);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L688"><span class="lineNum">     688</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-rpcport=&lt;port&gt;&quot;, strprintf(&quot;Listen for JSON-RPC connections on &lt;port&gt; (default: %u, testnet3: %u, testnet4: %u, signet: %u, regtest: %u)&quot;, defaultBaseParams-&gt;RPCPort(), testnetBaseParams-&gt;RPCPort(), testnet4BaseParams-&gt;RPCPort(), signetBaseParams-&gt;RPCPort(), regtestBaseParams-&gt;RPCPort()), ArgsManager::ALLOW_ANY | ArgsManager::NETWORK_ONLY, OptionsCategory::RPC);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L689"><span class="lineNum">     689</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-rpcservertimeout=&lt;n&gt;&quot;, strprintf(&quot;Timeout during HTTP requests (default: %d)&quot;, DEFAULT_HTTP_SERVER_TIMEOUT), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::RPC);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L690"><span class="lineNum">     690</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-rpcthreads=&lt;n&gt;&quot;, strprintf(&quot;Set the number of threads to service RPC calls (default: %d)&quot;, DEFAULT_HTTP_THREADS), ArgsManager::ALLOW_ANY, OptionsCategory::RPC);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L691"><span class="lineNum">     691</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-rpcuser=&lt;user&gt;&quot;, &quot;Username for JSON-RPC connections&quot;, ArgsManager::ALLOW_ANY | ArgsManager::SENSITIVE, OptionsCategory::RPC);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L692"><span class="lineNum">     692</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-rpcwhitelist=&lt;whitelist&gt;&quot;, &quot;Set a whitelist to filter incoming RPC calls for a specific user. The field &lt;whitelist&gt; comes in the format: &lt;USERNAME&gt;:&lt;rpc 1&gt;,&lt;rpc 2&gt;,...,&lt;rpc n&gt;. If multiple whitelists are set for a given user, they are set-intersected. See -rpcwhitelistdefault documentation for information on default whitelist behavior.&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::RPC);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L693"><span class="lineNum">     693</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-rpcwhitelistdefault&quot;, &quot;Sets default behavior for rpc whitelisting. Unless rpcwhitelistdefault is set to 0, if any -rpcwhitelist is set, the rpc server acts as if all rpc users are subject to empty-unless-otherwise-specified whitelists. If rpcwhitelistdefault is set to 1 and no -rpcwhitelist is set, rpc server acts as if all rpc users are subject to empty whitelists.&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::RPC);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L694"><span class="lineNum">     694</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-rpcworkqueue=&lt;n&gt;&quot;, strprintf(&quot;Set the maximum depth of the work queue to service RPC calls (default: %d)&quot;, DEFAULT_HTTP_WORKQUEUE), ArgsManager::ALLOW_ANY | ArgsManager::DEBUG_ONLY, OptionsCategory::RPC);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L695"><span class="lineNum">     695</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-server&quot;, &quot;Accept command line and JSON-RPC commands&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::RPC);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L696"><span class="lineNum">     696</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     if (can_listen_ipc) {</span></span>
<span id="L697"><span class="lineNum">     697</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         argsman.AddArg(&quot;-ipcbind=&lt;address&gt;&quot;, &quot;Bind to Unix socket address and listen for incoming connections. Valid address values are \&quot;unix\&quot; to listen on the default path, &lt;datadir&gt;/node.sock, or \&quot;unix:/custom/path\&quot; to specify a custom path. Can be specified multiple times to listen on multiple paths. Default behavior is not to listen on any path. If relative paths are specified, they are interpreted relative to the network data directory. If paths include any parent directory components and the parent directories do not exist, they will be created.&quot;, ArgsManager::ALLOW_ANY, OptionsCategory::IPC);</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L698"><span class="lineNum">     698</span>                 :             :     }</span>
<span id="L699"><span class="lineNum">     699</span>                 :             : </span>
<span id="L700"><span class="lineNum">     700</span>                 :             : #if HAVE_DECL_FORK</span>
<span id="L701"><span class="lineNum">     701</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-daemon&quot;, strprintf(&quot;Run in the background as a daemon and accept commands (default: %d)&quot;, DEFAULT_DAEMON), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L702"><span class="lineNum">     702</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     argsman.AddArg(&quot;-daemonwait&quot;, strprintf(&quot;Wait for initialization to be finished before exiting. This implies -daemon (default: %d)&quot;, DEFAULT_DAEMONWAIT), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L703"><span class="lineNum">     703</span>                 :             : #else</span>
<span id="L704"><span class="lineNum">     704</span>                 :             :     hidden_args.emplace_back(&quot;-daemon&quot;);</span>
<span id="L705"><span class="lineNum">     705</span>                 :             :     hidden_args.emplace_back(&quot;-daemonwait&quot;);</span>
<span id="L706"><span class="lineNum">     706</span>                 :             : #endif</span>
<span id="L707"><span class="lineNum">     707</span>                 :             : </span>
<span id="L708"><span class="lineNum">     708</span>                 :             :     // Add the hidden options</span>
<span id="L709"><span class="lineNum">     709</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     argsman.AddHiddenArgs(hidden_args);</span></span>
<span id="L710"><span class="lineNum">     710</span>                 :<span class="tlaGNC">        1748 : }</span></span>
<span id="L711"><span class="lineNum">     711</span>                 :             : </span>
<span id="L712"><span class="lineNum">     712</span>                 :             : #if HAVE_SYSTEM</span>
<span id="L713"><span class="lineNum">     713</span>                 :<span class="tlaUNC">           0 : static void StartupNotify(const ArgsManager&amp; args)</span></span>
<span id="L714"><span class="lineNum">     714</span>                 :             : {</span>
<span id="L715"><span class="lineNum">     715</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     std::string cmd = args.GetArg(&quot;-startupnotify&quot;, &quot;&quot;);</span></span>
<span id="L716"><span class="lineNum">     716</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!cmd.empty()) {</span></span>
<span id="L717"><span class="lineNum">     717</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         std::thread t(runCommand, cmd);</span></span>
<span id="L718"><span class="lineNum">     718</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         t.detach(); // thread runs free</span></span>
<span id="L719"><span class="lineNum">     719</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L720"><span class="lineNum">     720</span>                 :<span class="tlaUNC">           0 : }</span></span>
<span id="L721"><span class="lineNum">     721</span>                 :             : #endif</span>
<span id="L722"><span class="lineNum">     722</span>                 :             : </span>
<span id="L723"><span class="lineNum">     723</span>                 :<span class="tlaUNC">           0 : static bool AppInitServers(NodeContext&amp; node)</span></span>
<span id="L724"><span class="lineNum">     724</span>                 :             : {</span>
<span id="L725"><span class="lineNum">     725</span>                 :<span class="tlaUNC">           0 :     const ArgsManager&amp; args = *Assert(node.args);</span></span>
<span id="L726"><span class="lineNum">     726</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!InitHTTPServer(*Assert(node.shutdown_signal))) {</span></span>
<span id="L727"><span class="lineNum">     727</span>                 :             :         return false;</span>
<span id="L728"><span class="lineNum">     728</span>                 :             :     }</span>
<span id="L729"><span class="lineNum">     729</span>                 :<span class="tlaUNC">           0 :     StartRPC();</span></span>
<span id="L730"><span class="lineNum">     730</span>                 :<span class="tlaUNC">           0 :     node.rpc_interruption_point = RpcInterruptionPoint;</span></span>
<span id="L731"><span class="lineNum">     731</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!StartHTTPRPC(&amp;node))</span></span>
<span id="L732"><span class="lineNum">     732</span>                 :             :         return false;</span>
<span id="L733"><span class="lineNum">     733</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (args.GetBoolArg(&quot;-rest&quot;, DEFAULT_REST_ENABLE)) StartREST(&amp;node);</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L734"><span class="lineNum">     734</span>                 :<span class="tlaUNC">           0 :     StartHTTPServer();</span></span>
<span id="L735"><span class="lineNum">     735</span>                 :<span class="tlaUNC">           0 :     return true;</span></span>
<span id="L736"><span class="lineNum">     736</span>                 :             : }</span>
<span id="L737"><span class="lineNum">     737</span>                 :             : </span>
<span id="L738"><span class="lineNum">     738</span>                 :             : // Parameter interaction based on rules</span>
<span id="L739"><span class="lineNum">     739</span>                 :<span class="tlaUNC">           0 : void InitParameterInteraction(ArgsManager&amp; args)</span></span>
<span id="L740"><span class="lineNum">     740</span>                 :             : {</span>
<span id="L741"><span class="lineNum">     741</span>                 :             :     // when specifying an explicit binding address, you want to listen on it</span>
<span id="L742"><span class="lineNum">     742</span>                 :             :     // even when -connect or -proxy is specified</span>
<span id="L743"><span class="lineNum">     743</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!args.GetArgs(&quot;-bind&quot;).empty()) {</span></span>
<span id="L744"><span class="lineNum">     744</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (args.SoftSetBoolArg(&quot;-listen&quot;, true))</span></span>
<span id="L745"><span class="lineNum">     745</span>                 :<span class="tlaUNC">           0 :             LogInfo(&quot;parameter interaction: -bind set -&gt; setting -listen=1\n&quot;);</span></span>
<span id="L746"><span class="lineNum">     746</span>                 :             :     }</span>
<span id="L747"><span class="lineNum">     747</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!args.GetArgs(&quot;-whitebind&quot;).empty()) {</span></span>
<span id="L748"><span class="lineNum">     748</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (args.SoftSetBoolArg(&quot;-listen&quot;, true))</span></span>
<span id="L749"><span class="lineNum">     749</span>                 :<span class="tlaUNC">           0 :             LogInfo(&quot;parameter interaction: -whitebind set -&gt; setting -listen=1\n&quot;);</span></span>
<span id="L750"><span class="lineNum">     750</span>                 :             :     }</span>
<span id="L751"><span class="lineNum">     751</span>                 :             : </span>
<span id="L752"><span class="lineNum">     752</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (!args.GetArgs(&quot;-connect&quot;).empty() || args.IsArgNegated(&quot;-connect&quot;) || args.GetIntArg(&quot;-maxconnections&quot;, DEFAULT_MAX_PEER_CONNECTIONS) &lt;= 0) {</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span><span class="tlaUNC" title="Branch 13 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 14 was not executed"> # </span><span class="tlaUNC" title="Branch 15 was not executed"> # </span><span class="tlaUNC" title="Branch 16 was not executed"> # </span><span class="tlaUNC" title="Branch 17 was not executed"> # </span><span class="tlaUNC" title="Branch 18 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 19 was not executed"> # </span><span class="tlaUNC" title="Branch 20 was not executed"> # </span><span class="tlaUNC" title="Branch 21 was not executed"> # </span><span class="tlaUNC" title="Branch 22 was not executed"> # </span><span class="tlaUNC" title="Branch 23 was not executed"> # </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 24 was not executed"> # </span><span class="tlaUNC" title="Branch 25 was not executed"> # </span><span class="tlaUNC" title="Branch 26 was not executed"> # </span><span class="tlaUNC" title="Branch 27 was not executed"> # </span>]
<span id="L753"><span class="lineNum">     753</span>                 :             :         // when only connecting to trusted nodes, do not seed via DNS, or listen by default</span>
<span id="L754"><span class="lineNum">     754</span>                 :             :         // do the same when connections are disabled</span>
<span id="L755"><span class="lineNum">     755</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (args.SoftSetBoolArg(&quot;-dnsseed&quot;, false))</span></span>
<span id="L756"><span class="lineNum">     756</span>                 :<span class="tlaUNC">           0 :             LogInfo(&quot;parameter interaction: -connect or -maxconnections=0 set -&gt; setting -dnsseed=0\n&quot;);</span></span>
<span id="L757"><span class="lineNum">     757</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (args.SoftSetBoolArg(&quot;-listen&quot;, false))</span></span>
<span id="L758"><span class="lineNum">     758</span>                 :<span class="tlaUNC">           0 :             LogInfo(&quot;parameter interaction: -connect or -maxconnections=0 set -&gt; setting -listen=0\n&quot;);</span></span>
<span id="L759"><span class="lineNum">     759</span>                 :             :     }</span>
<span id="L760"><span class="lineNum">     760</span>                 :             : </span>
<span id="L761"><span class="lineNum">     761</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     std::string proxy_arg = args.GetArg(&quot;-proxy&quot;, &quot;&quot;);</span></span>
<span id="L762"><span class="lineNum">     762</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (proxy_arg != &quot;&quot; &amp;&amp; proxy_arg != &quot;0&quot;) {</span></span>
<span id="L763"><span class="lineNum">     763</span>                 :             :         // to protect privacy, do not listen by default if a default proxy server is specified</span>
<span id="L764"><span class="lineNum">     764</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (args.SoftSetBoolArg(&quot;-listen&quot;, false))</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L765"><span class="lineNum">     765</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;parameter interaction: -proxy set -&gt; setting -listen=0\n&quot;);</span></span>
<span id="L766"><span class="lineNum">     766</span>                 :             :         // to protect privacy, do not map ports when a proxy is set. The user may still specify -listen=1</span>
<span id="L767"><span class="lineNum">     767</span>                 :             :         // to listen locally, so don't rely on this happening through -listen below.</span>
<span id="L768"><span class="lineNum">     768</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (args.SoftSetBoolArg(&quot;-natpmp&quot;, false)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L769"><span class="lineNum">     769</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;parameter interaction: -proxy set -&gt; setting -natpmp=0\n&quot;);</span></span>
<span id="L770"><span class="lineNum">     770</span>                 :             :         }</span>
<span id="L771"><span class="lineNum">     771</span>                 :             :         // to protect privacy, do not discover addresses by default</span>
<span id="L772"><span class="lineNum">     772</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (args.SoftSetBoolArg(&quot;-discover&quot;, false))</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L773"><span class="lineNum">     773</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;parameter interaction: -proxy set -&gt; setting -discover=0\n&quot;);</span></span>
<span id="L774"><span class="lineNum">     774</span>                 :             :     }</span>
<span id="L775"><span class="lineNum">     775</span>                 :             : </span>
<span id="L776"><span class="lineNum">     776</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (!args.GetBoolArg(&quot;-listen&quot;, DEFAULT_LISTEN)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L777"><span class="lineNum">     777</span>                 :             :         // do not map ports or try to retrieve public IP when not listening (pointless)</span>
<span id="L778"><span class="lineNum">     778</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (args.SoftSetBoolArg(&quot;-natpmp&quot;, false)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L779"><span class="lineNum">     779</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;parameter interaction: -listen=0 -&gt; setting -natpmp=0\n&quot;);</span></span>
<span id="L780"><span class="lineNum">     780</span>                 :             :         }</span>
<span id="L781"><span class="lineNum">     781</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (args.SoftSetBoolArg(&quot;-discover&quot;, false))</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L782"><span class="lineNum">     782</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;parameter interaction: -listen=0 -&gt; setting -discover=0\n&quot;);</span></span>
<span id="L783"><span class="lineNum">     783</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (args.SoftSetBoolArg(&quot;-listenonion&quot;, false))</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L784"><span class="lineNum">     784</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;parameter interaction: -listen=0 -&gt; setting -listenonion=0\n&quot;);</span></span>
<span id="L785"><span class="lineNum">     785</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (args.SoftSetBoolArg(&quot;-i2pacceptincoming&quot;, false)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L786"><span class="lineNum">     786</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;parameter interaction: -listen=0 -&gt; setting -i2pacceptincoming=0\n&quot;);</span></span>
<span id="L787"><span class="lineNum">     787</span>                 :             :         }</span>
<span id="L788"><span class="lineNum">     788</span>                 :             :     }</span>
<span id="L789"><span class="lineNum">     789</span>                 :             : </span>
<span id="L790"><span class="lineNum">     790</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (!args.GetArgs(&quot;-externalip&quot;).empty()) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L791"><span class="lineNum">     791</span>                 :             :         // if an explicit public IP is specified, do not try to find others</span>
<span id="L792"><span class="lineNum">     792</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (args.SoftSetBoolArg(&quot;-discover&quot;, false))</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L793"><span class="lineNum">     793</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;parameter interaction: -externalip set -&gt; setting -discover=0\n&quot;);</span></span>
<span id="L794"><span class="lineNum">     794</span>                 :             :     }</span>
<span id="L795"><span class="lineNum">     795</span>                 :             : </span>
<span id="L796"><span class="lineNum">     796</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (args.GetBoolArg(&quot;-blocksonly&quot;, DEFAULT_BLOCKSONLY)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L797"><span class="lineNum">     797</span>                 :             :         // disable whitelistrelay in blocksonly mode</span>
<span id="L798"><span class="lineNum">     798</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (args.SoftSetBoolArg(&quot;-whitelistrelay&quot;, false))</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L799"><span class="lineNum">     799</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;parameter interaction: -blocksonly=1 -&gt; setting -whitelistrelay=0\n&quot;);</span></span>
<span id="L800"><span class="lineNum">     800</span>                 :             :         // Reduce default mempool size in blocksonly mode to avoid unexpected resource usage</span>
<span id="L801"><span class="lineNum">     801</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (args.SoftSetArg(&quot;-maxmempool&quot;, ToString(DEFAULT_BLOCKSONLY_MAX_MEMPOOL_SIZE_MB)))</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L802"><span class="lineNum">     802</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;parameter interaction: -blocksonly=1 -&gt; setting -maxmempool=%d\n&quot;, DEFAULT_BLOCKSONLY_MAX_MEMPOOL_SIZE_MB);</span></span>
<span id="L803"><span class="lineNum">     803</span>                 :             :     }</span>
<span id="L804"><span class="lineNum">     804</span>                 :             : </span>
<span id="L805"><span class="lineNum">     805</span>                 :             :     // Forcing relay from whitelisted hosts implies we will accept relays from them in the first place.</span>
<span id="L806"><span class="lineNum">     806</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (args.GetBoolArg(&quot;-whitelistforcerelay&quot;, DEFAULT_WHITELISTFORCERELAY)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L807"><span class="lineNum">     807</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (args.SoftSetBoolArg(&quot;-whitelistrelay&quot;, true))</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L808"><span class="lineNum">     808</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;parameter interaction: -whitelistforcerelay=1 -&gt; setting -whitelistrelay=1\n&quot;);</span></span>
<span id="L809"><span class="lineNum">     809</span>                 :             :     }</span>
<span id="L810"><span class="lineNum">     810</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     const auto onlynets = args.GetArgs(&quot;-onlynet&quot;);</span></span>
<span id="L811"><span class="lineNum">     811</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!onlynets.empty()) {</span></span>
<span id="L812"><span class="lineNum">     812</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         bool clearnet_reachable = std::any_of(onlynets.begin(), onlynets.end(), [](const auto&amp; net) {</span></span>
<span id="L813"><span class="lineNum">     813</span>                 :<span class="tlaUNC">           0 :             const auto n = ParseNetwork(net);</span></span>
<span id="L814"><span class="lineNum">     814</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return n == NET_IPV4 || n == NET_IPV6;</span></span>
<span id="L815"><span class="lineNum">     815</span>                 :             :         });</span>
<span id="L816"><span class="lineNum">     816</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (!clearnet_reachable &amp;&amp; args.SoftSetBoolArg(&quot;-dnsseed&quot;, false)) {</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not executed"> # </span>]
<span id="L817"><span class="lineNum">     817</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;parameter interaction: -onlynet excludes IPv4 and IPv6 -&gt; setting -dnsseed=0\n&quot;);</span></span>
<span id="L818"><span class="lineNum">     818</span>                 :             :         }</span>
<span id="L819"><span class="lineNum">     819</span>                 :             :     }</span>
<span id="L820"><span class="lineNum">     820</span>                 :<span class="tlaUNC">           0 : }</span></span>
<span id="L821"><span class="lineNum">     821</span>                 :             : </span>
<span id="L822"><span class="lineNum">     822</span>                 :             : /**</span>
<span id="L823"><span class="lineNum">     823</span>                 :             :  * Initialize global loggers.</span>
<span id="L824"><span class="lineNum">     824</span>                 :             :  *</span>
<span id="L825"><span class="lineNum">     825</span>                 :             :  * Note that this is called very early in the process lifetime, so you should be</span>
<span id="L826"><span class="lineNum">     826</span>                 :             :  * careful about what global state you rely on here.</span>
<span id="L827"><span class="lineNum">     827</span>                 :             :  */</span>
<span id="L828"><span class="lineNum">     828</span>                 :<span class="tlaGNC">        1748 : void InitLogging(const ArgsManager&amp; args)</span></span>
<span id="L829"><span class="lineNum">     829</span>                 :             : {</span>
<span id="L830"><span class="lineNum">     830</span>                 :<span class="tlaGNC">        1748 :     init::SetLoggingOptions(args);</span></span>
<span id="L831"><span class="lineNum">     831</span>                 :<span class="tlaGNC">        1748 :     init::LogPackageVersion();</span></span>
<span id="L832"><span class="lineNum">     832</span>                 :<span class="tlaGNC">        1748 : }</span></span>
<span id="L833"><span class="lineNum">     833</span>                 :             : </span>
<span id="L834"><span class="lineNum">     834</span>                 :             : namespace { // Variables internal to initialization process only</span>
<span id="L835"><span class="lineNum">     835</span>                 :             : </span>
<span id="L836"><span class="lineNum">     836</span>                 :             : int nMaxConnections;</span>
<span id="L837"><span class="lineNum">     837</span>                 :             : int available_fds;</span>
<span id="L838"><span class="lineNum">     838</span>                 :             : ServiceFlags g_local_services = ServiceFlags(NODE_NETWORK_LIMITED | NODE_WITNESS);</span>
<span id="L839"><span class="lineNum">     839</span>                 :             : int64_t peer_connect_timeout;</span>
<span id="L840"><span class="lineNum">     840</span>                 :             : std::set&lt;BlockFilterType&gt; g_enabled_filter_types;</span>
<span id="L841"><span class="lineNum">     841</span>                 :             : </span>
<span id="L842"><span class="lineNum">     842</span>                 :             : } // namespace</span>
<span id="L843"><span class="lineNum">     843</span>                 :             : </span>
<span id="L844"><span class="lineNum">     844</span>                 :<span class="tlaUNC">           0 : [[noreturn]] static void new_handler_terminate()</span></span>
<span id="L845"><span class="lineNum">     845</span>                 :             : {</span>
<span id="L846"><span class="lineNum">     846</span>                 :             :     // Rather than throwing std::bad-alloc if allocation fails, terminate</span>
<span id="L847"><span class="lineNum">     847</span>                 :             :     // immediately to (try to) avoid chain corruption.</span>
<span id="L848"><span class="lineNum">     848</span>                 :             :     // Since logging may itself allocate memory, set the handler directly</span>
<span id="L849"><span class="lineNum">     849</span>                 :             :     // to terminate first.</span>
<span id="L850"><span class="lineNum">     850</span>                 :<span class="tlaUNC">           0 :     std::set_new_handler(std::terminate);</span></span>
<span id="L851"><span class="lineNum">     851</span>                 :<span class="tlaUNC">           0 :     LogError(&quot;Out of memory. Terminating.\n&quot;);</span></span>
<span id="L852"><span class="lineNum">     852</span>                 :             : </span>
<span id="L853"><span class="lineNum">     853</span>                 :             :     // The log was successful, terminate now.</span>
<span id="L854"><span class="lineNum">     854</span>                 :<span class="tlaUNC">           0 :     std::terminate();</span></span>
<span id="L855"><span class="lineNum">     855</span>                 :             : };</span>
<span id="L856"><span class="lineNum">     856</span>                 :             : </span>
<span id="L857"><span class="lineNum">     857</span>                 :<span class="tlaUNC">           0 : bool AppInitBasicSetup(const ArgsManager&amp; args, std::atomic&lt;int&gt;&amp; exit_status)</span></span>
<span id="L858"><span class="lineNum">     858</span>                 :             : {</span>
<span id="L859"><span class="lineNum">     859</span>                 :             :     // ********************************************************* Step 1: setup</span>
<span id="L860"><span class="lineNum">     860</span>                 :             : #ifdef _MSC_VER</span>
<span id="L861"><span class="lineNum">     861</span>                 :             :     // Turn off Microsoft heap dump noise</span>
<span id="L862"><span class="lineNum">     862</span>                 :             :     _CrtSetReportMode(_CRT_WARN, _CRTDBG_MODE_FILE);</span>
<span id="L863"><span class="lineNum">     863</span>                 :             :     _CrtSetReportFile(_CRT_WARN, CreateFileA(&quot;NUL&quot;, GENERIC_WRITE, 0, nullptr, OPEN_EXISTING, 0, 0));</span>
<span id="L864"><span class="lineNum">     864</span>                 :             :     // Disable confusing &quot;helpful&quot; text message on abort, Ctrl-C</span>
<span id="L865"><span class="lineNum">     865</span>                 :             :     _set_abort_behavior(0, _WRITE_ABORT_MSG | _CALL_REPORTFAULT);</span>
<span id="L866"><span class="lineNum">     866</span>                 :             : #endif</span>
<span id="L867"><span class="lineNum">     867</span>                 :             : #ifdef WIN32</span>
<span id="L868"><span class="lineNum">     868</span>                 :             :     // Enable heap terminate-on-corruption</span>
<span id="L869"><span class="lineNum">     869</span>                 :             :     HeapSetInformation(nullptr, HeapEnableTerminationOnCorruption, nullptr, 0);</span>
<span id="L870"><span class="lineNum">     870</span>                 :             : #endif</span>
<span id="L871"><span class="lineNum">     871</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!SetupNetworking()) {</span></span>
<span id="L872"><span class="lineNum">     872</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         return InitError(Untranslated(&quot;Initializing networking failed.&quot;));</span></span>
<span id="L873"><span class="lineNum">     873</span>                 :             :     }</span>
<span id="L874"><span class="lineNum">     874</span>                 :             : </span>
<span id="L875"><span class="lineNum">     875</span>                 :             : #ifndef WIN32</span>
<span id="L876"><span class="lineNum">     876</span>                 :             :     // Clean shutdown on SIGTERM</span>
<span id="L877"><span class="lineNum">     877</span>                 :<span class="tlaUNC">           0 :     registerSignalHandler(SIGTERM, HandleSIGTERM);</span></span>
<span id="L878"><span class="lineNum">     878</span>                 :<span class="tlaUNC">           0 :     registerSignalHandler(SIGINT, HandleSIGTERM);</span></span>
<span id="L879"><span class="lineNum">     879</span>                 :             : </span>
<span id="L880"><span class="lineNum">     880</span>                 :             :     // Reopen debug.log on SIGHUP</span>
<span id="L881"><span class="lineNum">     881</span>                 :<span class="tlaUNC">           0 :     registerSignalHandler(SIGHUP, HandleSIGHUP);</span></span>
<span id="L882"><span class="lineNum">     882</span>                 :             : </span>
<span id="L883"><span class="lineNum">     883</span>                 :             :     // Ignore SIGPIPE, otherwise it will bring the daemon down if the client closes unexpectedly</span>
<span id="L884"><span class="lineNum">     884</span>                 :<span class="tlaUNC">           0 :     signal(SIGPIPE, SIG_IGN);</span></span>
<span id="L885"><span class="lineNum">     885</span>                 :             : #else</span>
<span id="L886"><span class="lineNum">     886</span>                 :             :     SetConsoleCtrlHandler(consoleCtrlHandler, true);</span>
<span id="L887"><span class="lineNum">     887</span>                 :             : #endif</span>
<span id="L888"><span class="lineNum">     888</span>                 :             : </span>
<span id="L889"><span class="lineNum">     889</span>                 :<span class="tlaUNC">           0 :     std::set_new_handler(new_handler_terminate);</span></span>
<span id="L890"><span class="lineNum">     890</span>                 :             : </span>
<span id="L891"><span class="lineNum">     891</span>                 :<span class="tlaUNC">           0 :     return true;</span></span>
<span id="L892"><span class="lineNum">     892</span>                 :             : }</span>
<span id="L893"><span class="lineNum">     893</span>                 :             : </span>
<span id="L894"><span class="lineNum">     894</span>                 :<span class="tlaGNC">        1748 : bool AppInitParameterInteraction(const ArgsManager&amp; args)</span></span>
<span id="L895"><span class="lineNum">     895</span>                 :             : {</span>
<span id="L896"><span class="lineNum">     896</span>                 :<span class="tlaGNC">        1748 :     const CChainParams&amp; chainparams = Params();</span></span>
<span id="L897"><span class="lineNum">     897</span>                 :             :     // ********************************************************* Step 2: parameter interactions</span>
<span id="L898"><span class="lineNum">     898</span>                 :             : </span>
<span id="L899"><span class="lineNum">     899</span>                 :             :     // also see: InitParameterInteraction()</span>
<span id="L900"><span class="lineNum">     900</span>                 :             : </span>
<span id="L901"><span class="lineNum">     901</span>                 :             :     // We removed checkpoints but keep the option to warn users who still have it in their config.</span>
<span id="L902"><span class="lineNum">     902</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaGBC" title="Branch 3 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     if (args.IsArgSet(&quot;-checkpoints&quot;)) {</span></span>
<span id="L903"><span class="lineNum">     903</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         InitWarning(_(&quot;Option '-checkpoints' is set but checkpoints were removed. This option has no effect.&quot;));</span></span>
<span id="L904"><span class="lineNum">     904</span>                 :             :     }</span>
<span id="L905"><span class="lineNum">     905</span>                 :             : </span>
<span id="L906"><span class="lineNum">     906</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        5244 :     if (args.IsArgSet(&quot;-datacarriersize&quot;) || args.IsArgSet(&quot;-datacarrier&quot;)) {</span></span>
<span class="lineNum">        </span> <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaGBC" title="Branch 8 was taken 1748 times"> + </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaGBC" title="Branch 10 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaUNC" title="Branch 12 was not taken"> - </span><span class="tlaGBC" title="Branch 13 was taken 1748 times"> + </span> 
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 14 was not taken"> - </span><span class="tlaUNC" title="Branch 15 was not taken"> - </span>]
<span id="L907"><span class="lineNum">     907</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         InitWarning(_(&quot;Options '-datacarrier' or '-datacarriersize' are set but are marked as deprecated. They will be removed in a future version.&quot;));</span></span>
<span id="L908"><span class="lineNum">     908</span>                 :             :     }</span>
<span id="L909"><span class="lineNum">     909</span>                 :             : </span>
<span id="L910"><span class="lineNum">     910</span>                 :             :     // We no longer limit the orphanage based on number of transactions but keep the option to warn users who still have it in their config.</span>
<span id="L911"><span class="lineNum">     911</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaGBC" title="Branch 3 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     if (args.IsArgSet(&quot;-maxorphantx&quot;)) {</span></span>
<span id="L912"><span class="lineNum">     912</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         InitWarning(_(&quot;Option '-maxorphantx' is set but no longer has any effect (see release notes). Please remove it from your configuration.&quot;));</span></span>
<span id="L913"><span class="lineNum">     913</span>                 :             :     }</span>
<span id="L914"><span class="lineNum">     914</span>                 :             : </span>
<span id="L915"><span class="lineNum">     915</span>                 :             :     // Error if network-specific options (-addnode, -connect, etc) are</span>
<span id="L916"><span class="lineNum">     916</span>                 :             :     // specified in default section of config file, but not overridden</span>
<span id="L917"><span class="lineNum">     917</span>                 :             :     // on the command line or in this chain's section of the config file.</span>
<span id="L918"><span class="lineNum">     918</span>                 :<span class="tlaGNC">        1748 :     ChainType chain = args.GetChainType();</span></span>
<span id="L919"><span class="lineNum">     919</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     if (chain == ChainType::SIGNET) {</span></span>
<span id="L920"><span class="lineNum">     920</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         LogInfo(&quot;Signet derived magic (message start): %s&quot;, HexStr(chainparams.MessageStart()));</span></span>
<span id="L921"><span class="lineNum">     921</span>                 :             :     }</span>
<span id="L922"><span class="lineNum">     922</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     bilingual_str errors;</span></span>
<span id="L923"><span class="lineNum">     923</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaGBC" title="Branch 3 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     for (const auto&amp; arg : args.GetUnsuitableSectionOnlyArgs()) {</span></span>
<span id="L924"><span class="lineNum">     924</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         errors += strprintf(_(&quot;Config setting for %s only applied on %s network when in [%s] section.&quot;), arg, ChainTypeToString(chain), ChainTypeToString(chain)) + Untranslated(&quot;\n&quot;);</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>       <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span>]
<span id="L925"><span class="lineNum">     925</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L926"><span class="lineNum">     926</span>                 :             : </span>
<span id="L927"><span class="lineNum">     927</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     if (!errors.empty()) {</span></span>
<span id="L928"><span class="lineNum">     928</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         return InitError(errors);</span></span>
<span id="L929"><span class="lineNum">     929</span>                 :             :     }</span>
<span id="L930"><span class="lineNum">     930</span>                 :             : </span>
<span id="L931"><span class="lineNum">     931</span>                 :             :     // Testnet3 deprecation warning</span>
<span id="L932"><span class="lineNum">     932</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     if (chain == ChainType::TESTNET) {</span></span>
<span id="L933"><span class="lineNum">     933</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         LogInfo(&quot;Warning: Support for testnet3 is deprecated and will be removed in an upcoming release. Consider switching to testnet4.\n&quot;);</span></span>
<span id="L934"><span class="lineNum">     934</span>                 :             :     }</span>
<span id="L935"><span class="lineNum">     935</span>                 :             : </span>
<span id="L936"><span class="lineNum">     936</span>                 :             :     // Warn if unrecognized section name are present in the config file.</span>
<span id="L937"><span class="lineNum">     937</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     bilingual_str warnings;</span></span>
<span id="L938"><span class="lineNum">     938</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaGBC" title="Branch 3 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     for (const auto&amp; section : args.GetUnrecognizedSections()) {</span></span>
<span id="L939"><span class="lineNum">     939</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         warnings += Untranslated(strprintf(&quot;%s:%i &quot;, section.m_file, section.m_line)) + strprintf(_(&quot;Section [%s] is not recognized.&quot;), section.m_name) + Untranslated(&quot;\n&quot;);</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not executed"> # </span>]
<span id="L940"><span class="lineNum">     940</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L941"><span class="lineNum">     941</span>                 :             : </span>
<span id="L942"><span class="lineNum">     942</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     if (!warnings.empty()) {</span></span>
<span id="L943"><span class="lineNum">     943</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         InitWarning(warnings);</span></span>
<span id="L944"><span class="lineNum">     944</span>                 :             :     }</span>
<span id="L945"><span class="lineNum">     945</span>                 :             : </span>
<span id="L946"><span class="lineNum">     946</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     if (!fs::is_directory(args.GetBlocksDirPath())) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaGBC" title="Branch 5 was taken 1748 times"> + </span>]
<span id="L947"><span class="lineNum">     947</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         return InitError(strprintf(_(&quot;Specified blocks directory \&quot;%s\&quot; does not exist.&quot;), args.GetArg(&quot;-blocksdir&quot;, &quot;&quot;)));</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not executed"> # </span>]
<span id="L948"><span class="lineNum">     948</span>                 :             :     }</span>
<span id="L949"><span class="lineNum">     949</span>                 :             : </span>
<span id="L950"><span class="lineNum">     950</span>                 :             :     // parse and validate enabled filter types</span>
<span id="L951"><span class="lineNum">     951</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     std::string blockfilterindex_value = args.GetArg(&quot;-blockfilterindex&quot;, DEFAULT_BLOCKFILTERINDEX);</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L952"><span class="lineNum">     952</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     if (blockfilterindex_value == &quot;&quot; || blockfilterindex_value == &quot;1&quot;) {</span></span>
<span id="L953"><span class="lineNum">     953</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         g_enabled_filter_types = AllBlockFilterTypes();</span></span>
<span id="L954"><span class="lineNum">     954</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     } else if (blockfilterindex_value != &quot;0&quot;) {</span></span>
<span id="L955"><span class="lineNum">     955</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         const std::vector&lt;std::string&gt; names = args.GetArgs(&quot;-blockfilterindex&quot;);</span></span>
<span id="L956"><span class="lineNum">     956</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         for (const auto&amp; name : names) {</span></span>
<span id="L957"><span class="lineNum">     957</span>                 :<span class="tlaUNC">           0 :             BlockFilterType filter_type;</span></span>
<span id="L958"><span class="lineNum">     958</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (!BlockFilterTypeByName(name, filter_type)) {</span></span>
<span id="L959"><span class="lineNum">     959</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 return InitError(strprintf(_(&quot;Unknown -blockfilterindex value %s.&quot;), name));</span></span>
<span id="L960"><span class="lineNum">     960</span>                 :             :             }</span>
<span id="L961"><span class="lineNum">     961</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             g_enabled_filter_types.insert(filter_type);</span></span>
<span id="L962"><span class="lineNum">     962</span>                 :             :         }</span>
<span id="L963"><span class="lineNum">     963</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L964"><span class="lineNum">     964</span>                 :             : </span>
<span id="L965"><span class="lineNum">     965</span>                 :             :     // Signal NODE_P2P_V2 if BIP324 v2 transport is enabled.</span>
<span id="L966"><span class="lineNum">     966</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1748 :     if (args.GetBoolArg(&quot;-v2transport&quot;, DEFAULT_V2_TRANSPORT)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L967"><span class="lineNum">     967</span>                 :<span class="tlaGNC">        1748 :         g_local_services = ServiceFlags(g_local_services | NODE_P2P_V2);</span></span>
<span id="L968"><span class="lineNum">     968</span>                 :             :     }</span>
<span id="L969"><span class="lineNum">     969</span>                 :             : </span>
<span id="L970"><span class="lineNum">     970</span>                 :             :     // Signal NODE_COMPACT_FILTERS if peerblockfilters and basic filters index are both enabled.</span>
<span id="L971"><span class="lineNum">     971</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1748 :     if (args.GetBoolArg(&quot;-peerblockfilters&quot;, DEFAULT_PEERBLOCKFILTERS)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaGBC" title="Branch 5 was taken 1748 times"> + </span>]
<span id="L972"><span class="lineNum">     972</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (g_enabled_filter_types.count(BlockFilterType::BASIC) != 1) {</span></span>
<span id="L973"><span class="lineNum">     973</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return InitError(_(&quot;Cannot set -peerblockfilters without -blockfilterindex.&quot;));</span></span>
<span id="L974"><span class="lineNum">     974</span>                 :             :         }</span>
<span id="L975"><span class="lineNum">     975</span>                 :             : </span>
<span id="L976"><span class="lineNum">     976</span>                 :<span class="tlaUNC">           0 :         g_local_services = ServiceFlags(g_local_services | NODE_COMPACT_FILTERS);</span></span>
<span id="L977"><span class="lineNum">     977</span>                 :             :     }</span>
<span id="L978"><span class="lineNum">     978</span>                 :             : </span>
<span id="L979"><span class="lineNum">     979</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1748 :     if (args.GetIntArg(&quot;-prune&quot;, 0)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaGBC" title="Branch 5 was taken 1748 times"> + </span>]
<span id="L980"><span class="lineNum">     980</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (args.GetBoolArg(&quot;-txindex&quot;, DEFAULT_TXINDEX))</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L981"><span class="lineNum">     981</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return InitError(_(&quot;Prune mode is incompatible with -txindex.&quot;));</span></span>
<span id="L982"><span class="lineNum">     982</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (args.GetBoolArg(&quot;-reindex-chainstate&quot;, false)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L983"><span class="lineNum">     983</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return InitError(_(&quot;Prune mode is incompatible with -reindex-chainstate. Use full -reindex instead.&quot;));</span></span>
<span id="L984"><span class="lineNum">     984</span>                 :             :         }</span>
<span id="L985"><span class="lineNum">     985</span>                 :             :     }</span>
<span id="L986"><span class="lineNum">     986</span>                 :             : </span>
<span id="L987"><span class="lineNum">     987</span>                 :             :     // If -forcednsseed is set to true, ensure -dnsseed has not been set to false</span>
<span id="L988"><span class="lineNum">     988</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     if (args.GetBoolArg(&quot;-forcednsseed&quot;, DEFAULT_FORCEDNSSEED) &amp;&amp; !args.GetBoolArg(&quot;-dnsseed&quot;, DEFAULT_DNSSEED)){</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaGBC" title="Branch 5 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 6 was not taken"> - </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaUNC" title="Branch 8 was not taken"> - </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaUNC" title="Branch 10 was not taken"> - </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaUNC" title="Branch 12 was not taken"> - </span><span class="tlaGBC" title="Branch 13 was taken 1748 times"> + </span> 
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 14 was not taken"> - </span><span class="tlaUNC" title="Branch 15 was not taken"> - </span>]
<span id="L989"><span class="lineNum">     989</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         return InitError(_(&quot;Cannot set -forcednsseed to true when setting -dnsseed to false.&quot;));</span></span>
<span id="L990"><span class="lineNum">     990</span>                 :             :     }</span>
<span id="L991"><span class="lineNum">     991</span>                 :             : </span>
<span id="L992"><span class="lineNum">     992</span>                 :             :     // -bind and -whitebind can't be set when not listening</span>
<span id="L993"><span class="lineNum">     993</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        5244 :     size_t nUserBind = args.GetArgs(&quot;-bind&quot;).size() + args.GetArgs(&quot;-whitebind&quot;).size();</span></span>
<span class="lineNum">        </span>    <span class="tlaGBC" title="Branch 4 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaGBC" title="Branch 6 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L994"><span class="lineNum">     994</span>   [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1748 :     if (nUserBind != 0 &amp;&amp; !args.GetBoolArg(&quot;-listen&quot;, DEFAULT_LISTEN)) {</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaUNC" title="Branch 6 was not taken"> - </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaUNC" title="Branch 8 was not taken"> - </span> 
<span class="lineNum">        </span>             <span class="tlaGBC" title="Branch 9 was taken 1748 times"> + </span>]
<span id="L995"><span class="lineNum">     995</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         return InitError(Untranslated(&quot;Cannot set -bind or -whitebind together with -listen=0&quot;));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L996"><span class="lineNum">     996</span>                 :             :     }</span>
<span id="L997"><span class="lineNum">     997</span>                 :             : </span>
<span id="L998"><span class="lineNum">     998</span>                 :             :     // if listen=0, then disallow listenonion=1</span>
<span id="L999"><span class="lineNum">     999</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     if (!args.GetBoolArg(&quot;-listen&quot;, DEFAULT_LISTEN) &amp;&amp; args.GetBoolArg(&quot;-listenonion&quot;, DEFAULT_LISTEN_ONION)) {</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaGBC" title="Branch 5 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 6 was not taken"> - </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span><span class="tlaUNC" title="Branch 8 was not taken"> - </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 9 was not taken"> - </span><span class="tlaUNC" title="Branch 10 was not taken"> - </span><span class="tlaUNC" title="Branch 11 was not taken"> - </span><span class="tlaUNC" title="Branch 12 was not taken"> - </span><span class="tlaGBC" title="Branch 13 was taken 1748 times"> + </span> 
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 14 was not taken"> - </span><span class="tlaUNC" title="Branch 15 was not taken"> - </span>]
<span id="L1000"><span class="lineNum">    1000</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         return InitError(Untranslated(&quot;Cannot set -listen=0 together with -listenonion=1&quot;));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1001"><span class="lineNum">    1001</span>                 :             :     }</span>
<span id="L1002"><span class="lineNum">    1002</span>                 :             : </span>
<span id="L1003"><span class="lineNum">    1003</span>                 :             :     // Make sure enough file descriptors are available. We need to reserve enough FDs to account for the bare minimum,</span>
<span id="L1004"><span class="lineNum">    1004</span>                 :             :     // plus all manual connections and all bound interfaces. Any remainder will be available for connection sockets</span>
<span id="L1005"><span class="lineNum">    1005</span>                 :             : </span>
<span id="L1006"><span class="lineNum">    1006</span>                 :             :     // Number of bound interfaces (we have at least one)</span>
<span id="L1007"><span class="lineNum">    1007</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     int nBind = std::max(nUserBind, size_t(1));</span></span>
<span id="L1008"><span class="lineNum">    1008</span>                 :             :     // Maximum number of connections with other nodes, this accounts for all types of outbounds and inbounds except for manual</span>
<span id="L1009"><span class="lineNum">    1009</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     int user_max_connection = args.GetIntArg(&quot;-maxconnections&quot;, DEFAULT_MAX_PEER_CONNECTIONS);</span></span>
<span id="L1010"><span class="lineNum">    1010</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     if (user_max_connection &lt; 0) {</span></span>
<span id="L1011"><span class="lineNum">    1011</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         return InitError(Untranslated(&quot;-maxconnections must be greater or equal than zero&quot;));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1012"><span class="lineNum">    1012</span>                 :             :     }</span>
<span id="L1013"><span class="lineNum">    1013</span>                 :             :     // Reserve enough FDs to account for the bare minimum, plus any manual connections, plus the bound interfaces</span>
<span id="L1014"><span class="lineNum">    1014</span>                 :<span class="tlaGNC">        1748 :     int min_required_fds = MIN_CORE_FDS + MAX_ADDNODE_CONNECTIONS + nBind;</span></span>
<span id="L1015"><span class="lineNum">    1015</span>                 :             : </span>
<span id="L1016"><span class="lineNum">    1016</span>                 :             :     // Try raising the FD limit to what we need (available_fds may be smaller than the requested amount if this fails)</span>
<span id="L1017"><span class="lineNum">    1017</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     available_fds = RaiseFileDescriptorLimit(user_max_connection + min_required_fds);</span></span>
<span id="L1018"><span class="lineNum">    1018</span>                 :             :     // If we are using select instead of poll, our actual limit may be even smaller</span>
<span id="L1019"><span class="lineNum">    1019</span>                 :             : #ifndef USE_POLL</span>
<span id="L1020"><span class="lineNum">    1020</span>                 :             :     available_fds = std::min(FD_SETSIZE, available_fds);</span>
<span id="L1021"><span class="lineNum">    1021</span>                 :             : #endif</span>
<span id="L1022"><span class="lineNum">    1022</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     if (available_fds &lt; min_required_fds)</span></span>
<span id="L1023"><span class="lineNum">    1023</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         return InitError(strprintf(_(&quot;Not enough file descriptors available. %d available, %d required.&quot;), available_fds, min_required_fds));</span></span>
<span id="L1024"><span class="lineNum">    1024</span>                 :             : </span>
<span id="L1025"><span class="lineNum">    1025</span>                 :             :     // Trim requested connection counts, to fit into system limitations</span>
<span id="L1026"><span class="lineNum">    1026</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     nMaxConnections = std::min(available_fds - min_required_fds, user_max_connection);</span></span>
<span id="L1027"><span class="lineNum">    1027</span>                 :             : </span>
<span id="L1028"><span class="lineNum">    1028</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     if (nMaxConnections &lt; user_max_connection)</span></span>
<span id="L1029"><span class="lineNum">    1029</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         InitWarning(strprintf(_(&quot;Reducing -maxconnections from %d to %d, because of system limitations.&quot;), user_max_connection, nMaxConnections));</span></span>
<span id="L1030"><span class="lineNum">    1030</span>                 :             : </span>
<span id="L1031"><span class="lineNum">    1031</span>                 :             :     // ********************************************************* Step 3: parameter-to-internal-flags</span>
<span id="L1032"><span class="lineNum">    1032</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaGBC" title="Branch 3 was taken 1748 times"> + </span> :<span class="tlaGNC">        1748 :     if (auto result{init::SetLoggingCategories(args)}; !result) return InitError(util::ErrorString(result));</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaUNC" title="Branch 6 was not taken"> - </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L1033"><span class="lineNum">    1033</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaGBC" title="Branch 3 was taken 1748 times"> + </span> :<span class="tlaGNC">        1748 :     if (auto result{init::SetLoggingLevel(args)}; !result) return InitError(util::ErrorString(result));</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span><span class="tlaUNC" title="Branch 6 was not taken"> - </span><span class="tlaUNC" title="Branch 7 was not taken"> - </span>]
<span id="L1034"><span class="lineNum">    1034</span>                 :             : </span>
<span id="L1035"><span class="lineNum">    1035</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     nConnectTimeout = args.GetIntArg(&quot;-timeout&quot;, DEFAULT_CONNECT_TIMEOUT);</span></span>
<span id="L1036"><span class="lineNum">    1036</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     if (nConnectTimeout &lt;= 0) {</span></span>
<span id="L1037"><span class="lineNum">    1037</span>                 :<span class="tlaUNC">           0 :         nConnectTimeout = DEFAULT_CONNECT_TIMEOUT;</span></span>
<span id="L1038"><span class="lineNum">    1038</span>                 :             :     }</span>
<span id="L1039"><span class="lineNum">    1039</span>                 :             : </span>
<span id="L1040"><span class="lineNum">    1040</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     peer_connect_timeout = args.GetIntArg(&quot;-peertimeout&quot;, DEFAULT_PEER_CONNECT_TIMEOUT);</span></span>
<span id="L1041"><span class="lineNum">    1041</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     if (peer_connect_timeout &lt;= 0) {</span></span>
<span id="L1042"><span class="lineNum">    1042</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         return InitError(Untranslated(&quot;peertimeout must be a positive integer.&quot;));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1043"><span class="lineNum">    1043</span>                 :             :     }</span>
<span id="L1044"><span class="lineNum">    1044</span>                 :             : </span>
<span id="L1045"><span class="lineNum">    1045</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     if (const auto arg{args.GetArg(&quot;-blockmintxfee&quot;)}) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaGBC" title="Branch 5 was taken 1748 times"> + </span>]
<span id="L1046"><span class="lineNum">    1046</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (!ParseMoney(*arg)) {</span></span>
<span id="L1047"><span class="lineNum">    1047</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             return InitError(AmountErrMsg(&quot;blockmintxfee&quot;, *arg));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1048"><span class="lineNum">    1048</span>                 :             :         }</span>
<span id="L1049"><span class="lineNum">    1049</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L1050"><span class="lineNum">    1050</span>                 :             : </span>
<span id="L1051"><span class="lineNum">    1051</span>                 :<span class="tlaGNC">        1748 :     {</span></span>
<span id="L1052"><span class="lineNum">    1052</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        1748 :         const auto max_block_weight = args.GetIntArg(&quot;-blockmaxweight&quot;, DEFAULT_BLOCK_MAX_WEIGHT);</span></span>
<span id="L1053"><span class="lineNum">    1053</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :         if (max_block_weight &gt; MAX_BLOCK_WEIGHT) {</span></span>
<span id="L1054"><span class="lineNum">    1054</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return InitError(strprintf(_(&quot;Specified -blockmaxweight (%d) exceeds consensus maximum block weight (%d)&quot;), max_block_weight, MAX_BLOCK_WEIGHT));</span></span>
<span id="L1055"><span class="lineNum">    1055</span>                 :             :         }</span>
<span id="L1056"><span class="lineNum">    1056</span>                 :             :     }</span>
<span id="L1057"><span class="lineNum">    1057</span>                 :             : </span>
<span id="L1058"><span class="lineNum">    1058</span>                 :<span class="tlaGNC">        1748 :     {</span></span>
<span id="L1059"><span class="lineNum">    1059</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        1748 :         const auto block_reserved_weight = args.GetIntArg(&quot;-blockreservedweight&quot;, DEFAULT_BLOCK_RESERVED_WEIGHT);</span></span>
<span id="L1060"><span class="lineNum">    1060</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :         if (block_reserved_weight &gt; MAX_BLOCK_WEIGHT) {</span></span>
<span id="L1061"><span class="lineNum">    1061</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return InitError(strprintf(_(&quot;Specified -blockreservedweight (%d) exceeds consensus maximum block weight (%d)&quot;), block_reserved_weight, MAX_BLOCK_WEIGHT));</span></span>
<span id="L1062"><span class="lineNum">    1062</span>                 :             :         }</span>
<span id="L1063"><span class="lineNum">    1063</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :         if (block_reserved_weight &lt; MINIMUM_BLOCK_RESERVED_WEIGHT) {</span></span>
<span id="L1064"><span class="lineNum">    1064</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return InitError(strprintf(_(&quot;Specified -blockreservedweight (%d) is lower than minimum safety value of (%d)&quot;), block_reserved_weight, MINIMUM_BLOCK_RESERVED_WEIGHT));</span></span>
<span id="L1065"><span class="lineNum">    1065</span>                 :             :         }</span>
<span id="L1066"><span class="lineNum">    1066</span>                 :             :     }</span>
<span id="L1067"><span class="lineNum">    1067</span>                 :             : </span>
<span id="L1068"><span class="lineNum">    1068</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     nBytesPerSigOp = args.GetIntArg(&quot;-bytespersigop&quot;, nBytesPerSigOp);</span></span>
<span id="L1069"><span class="lineNum">    1069</span>                 :             : </span>
<span id="L1070"><span class="lineNum">    1070</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     if (!g_wallet_init_interface.ParameterInteraction()) return false;</span></span>
<span id="L1071"><span class="lineNum">    1071</span>                 :             : </span>
<span id="L1072"><span class="lineNum">    1072</span>                 :             :     // Option to startup with mocktime set (used for regression testing):</span>
<span id="L1073"><span class="lineNum">    1073</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        3496 :     if (const auto mocktime{args.GetIntArg(&quot;-mocktime&quot;)}) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaGBC" title="Branch 5 was taken 1748 times"> + </span>]
<span id="L1074"><span class="lineNum">    1074</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         SetMockTime(std::chrono::seconds{*mocktime});</span></span>
<span id="L1075"><span class="lineNum">    1075</span>                 :             :     }</span>
<span id="L1076"><span class="lineNum">    1076</span>                 :             : </span>
<span id="L1077"><span class="lineNum">    1077</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaGNC">        1748 :     if (args.GetBoolArg(&quot;-peerbloomfilters&quot;, DEFAULT_PEERBLOOMFILTERS))</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaGBC" title="Branch 5 was taken 1748 times"> + </span>]
<span id="L1078"><span class="lineNum">    1078</span>                 :<span class="tlaUNC">           0 :         g_local_services = ServiceFlags(g_local_services | NODE_BLOOM);</span></span>
<span id="L1079"><span class="lineNum">    1079</span>                 :             : </span>
<span id="L1080"><span class="lineNum">    1080</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        1748 :     const std::vector&lt;std::string&gt; test_options = args.GetArgs(&quot;-test&quot;);</span></span>
<span id="L1081"><span class="lineNum">    1081</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :     if (!test_options.empty()) {</span></span>
<span id="L1082"><span class="lineNum">    1082</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (chainparams.GetChainType() != ChainType::REGTEST) {</span></span>
<span id="L1083"><span class="lineNum">    1083</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             return InitError(Untranslated(&quot;-test=&lt;option&gt; can only be used with regtest&quot;));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1084"><span class="lineNum">    1084</span>                 :             :         }</span>
<span id="L1085"><span class="lineNum">    1085</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         for (const std::string&amp; option : test_options) {</span></span>
<span id="L1086"><span class="lineNum">    1086</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             auto it = std::find_if(TEST_OPTIONS_DOC.begin(), TEST_OPTIONS_DOC.end(), [&amp;option](const std::string&amp; doc_option) {</span></span>
<span id="L1087"><span class="lineNum">    1087</span>                 :<span class="tlaUNC">           0 :                 size_t pos = doc_option.find(&quot; (&quot;);</span></span>
<span id="L1088"><span class="lineNum">    1088</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 return (pos != std::string::npos) &amp;&amp; (doc_option.substr(0, pos) == option);</span></span>
<span id="L1089"><span class="lineNum">    1089</span>                 :             :             });</span>
<span id="L1090"><span class="lineNum">    1090</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (it == TEST_OPTIONS_DOC.end()) {</span></span>
<span id="L1091"><span class="lineNum">    1091</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 InitWarning(strprintf(_(&quot;Unrecognised option \&quot;%s\&quot; provided in -test=&lt;option&gt;.&quot;), option));</span></span>
<span id="L1092"><span class="lineNum">    1092</span>                 :             :             }</span>
<span id="L1093"><span class="lineNum">    1093</span>                 :             :         }</span>
<span id="L1094"><span class="lineNum">    1094</span>                 :             :     }</span>
<span id="L1095"><span class="lineNum">    1095</span>                 :             : </span>
<span id="L1096"><span class="lineNum">    1096</span>                 :             :     // Also report errors from parsing before daemonization</span>
<span id="L1097"><span class="lineNum">    1097</span>                 :<span class="tlaGNC">        1748 :     {</span></span>
<span id="L1098"><span class="lineNum">    1098</span>                 :<span class="tlaGNC">        1748 :         kernel::Notifications notifications{};</span></span>
<span id="L1099"><span class="lineNum">    1099</span>                 :<span class="tlaGNC">        1748 :         ChainstateManager::Options chainman_opts_dummy{</span></span>
<span id="L1100"><span class="lineNum">    1100</span>                 :             :             .chainparams = chainparams,</span>
<span id="L1101"><span class="lineNum">    1101</span>                 :             :             .datadir = args.GetDataDirNet(),</span>
<span id="L1102"><span class="lineNum">    1102</span>                 :             :             .notifications = notifications,</span>
<span id="L1103"><span class="lineNum">    1103</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :         };</span></span>
<span id="L1104"><span class="lineNum">    1104</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :         auto chainman_result{ApplyArgsManOptions(args, chainman_opts_dummy)};</span></span>
<span id="L1105"><span class="lineNum">    1105</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :         if (!chainman_result) {</span></span>
<span id="L1106"><span class="lineNum">    1106</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return InitError(util::ErrorString(chainman_result));</span></span>
<span id="L1107"><span class="lineNum">    1107</span>                 :             :         }</span>
<span id="L1108"><span class="lineNum">    1108</span>                 :<span class="tlaGNC">        1748 :         BlockManager::Options blockman_opts_dummy{</span></span>
<span id="L1109"><span class="lineNum">    1109</span>                 :<span class="tlaGNC">        1748 :             .chainparams = chainman_opts_dummy.chainparams,</span></span>
<span id="L1110"><span class="lineNum">    1110</span>                 :             :             .blocks_dir = args.GetBlocksDirPath(),</span>
<span id="L1111"><span class="lineNum">    1111</span>                 :<span class="tlaGNC">        1748 :             .notifications = chainman_opts_dummy.notifications,</span></span>
<span id="L1112"><span class="lineNum">    1112</span>                 :             :             .block_tree_db_params = DBParams{</span>
<span id="L1113"><span class="lineNum">    1113</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        5244 :                 .path = args.GetDataDirNet() / &quot;blocks&quot; / &quot;index&quot;,</span></span>
<span id="L1114"><span class="lineNum">    1114</span>                 :             :                 .cache_bytes = 0,</span>
<span id="L1115"><span class="lineNum">    1115</span>                 :             :             },</span>
<span id="L1116"><span class="lineNum">    1116</span>   [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaGBC" title="Branch 2 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaGNC">        3496 :         };</span></span>
<span id="L1117"><span class="lineNum">    1117</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :         auto blockman_result{ApplyArgsManOptions(args, blockman_opts_dummy)};</span></span>
<span id="L1118"><span class="lineNum">    1118</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :         if (!blockman_result) {</span></span>
<span id="L1119"><span class="lineNum">    1119</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return InitError(util::ErrorString(blockman_result));</span></span>
<span id="L1120"><span class="lineNum">    1120</span>                 :             :         }</span>
<span id="L1121"><span class="lineNum">    1121</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :         CTxMemPool::Options mempool_opts{};</span></span>
<span id="L1122"><span class="lineNum">    1122</span>         [<span class="tlaGBC" title="Branch 0 was taken 1748 times"> + </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaGNC">        1748 :         auto mempool_result{ApplyArgsManOptions(args, chainparams, mempool_opts)};</span></span>
<span id="L1123"><span class="lineNum">    1123</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaGBC" title="Branch 1 was taken 1748 times"> + </span>]:<span class="tlaGNC">        1748 :         if (!mempool_result) {</span></span>
<span id="L1124"><span class="lineNum">    1124</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return InitError(util::ErrorString(mempool_result));</span></span>
<span id="L1125"><span class="lineNum">    1125</span>                 :             :         }</span>
<span id="L1126"><span class="lineNum">    1126</span>                 :<span class="tlaGNC">        3496 :     }</span></span>
<span id="L1127"><span class="lineNum">    1127</span>                 :             : </span>
<span id="L1128"><span class="lineNum">    1128</span>                 :<span class="tlaGNC">        1748 :     return true;</span></span>
<span id="L1129"><span class="lineNum">    1129</span>                 :<span class="tlaGNC">        6992 : }</span></span>
<span id="L1130"><span class="lineNum">    1130</span>                 :             : </span>
<span id="L1131"><span class="lineNum">    1131</span>                 :<span class="tlaUNC">           0 : static bool LockDirectory(const fs::path&amp; dir, bool probeOnly)</span></span>
<span id="L1132"><span class="lineNum">    1132</span>                 :             : {</span>
<span id="L1133"><span class="lineNum">    1133</span>                 :             :     // Make sure only a single process is using the directory.</span>
<span id="L1134"><span class="lineNum">    1134</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     switch (util::LockDirectory(dir, &quot;.lock&quot;, probeOnly)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1135"><span class="lineNum">    1135</span>                 :<span class="tlaUNC">           0 :     case util::LockResult::ErrorWrite:</span></span>
<span id="L1136"><span class="lineNum">    1136</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         return InitError(strprintf(_(&quot;Cannot write to directory '%s'; check permissions.&quot;), fs::PathToString(dir)));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1137"><span class="lineNum">    1137</span>                 :<span class="tlaUNC">           0 :     case util::LockResult::ErrorLock:</span></span>
<span id="L1138"><span class="lineNum">    1138</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         return InitError(strprintf(_(&quot;Cannot obtain a lock on directory %s. %s is probably already running.&quot;), fs::PathToString(dir), CLIENT_NAME));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1139"><span class="lineNum">    1139</span>                 :             :     case util::LockResult::Success: return true;</span>
<span id="L1140"><span class="lineNum">    1140</span>                 :             :     } // no default case, so the compiler can warn about missing cases</span>
<span id="L1141"><span class="lineNum">    1141</span>                 :<span class="tlaUNC">           0 :     assert(false);</span></span>
<span id="L1142"><span class="lineNum">    1142</span>                 :             : }</span>
<span id="L1143"><span class="lineNum">    1143</span>                 :<span class="tlaUNC">           0 : static bool LockDirectories(bool probeOnly)</span></span>
<span id="L1144"><span class="lineNum">    1144</span>                 :             : {</span>
<span id="L1145"><span class="lineNum">    1145</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     return LockDirectory(gArgs.GetDataDirNet(), probeOnly) &amp;&amp; \</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not executed"> # </span>]
<span id="L1146"><span class="lineNum">    1146</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :            LockDirectory(gArgs.GetBlocksDirPath(), probeOnly);</span></span>
<span id="L1147"><span class="lineNum">    1147</span>                 :             : }</span>
<span id="L1148"><span class="lineNum">    1148</span>                 :             : </span>
<span id="L1149"><span class="lineNum">    1149</span>                 :<span class="tlaUNC">           0 : bool AppInitSanityChecks(const kernel::Context&amp; kernel)</span></span>
<span id="L1150"><span class="lineNum">    1150</span>                 :             : {</span>
<span id="L1151"><span class="lineNum">    1151</span>                 :             :     // ********************************************************* Step 4: sanity checks</span>
<span id="L1152"><span class="lineNum">    1152</span>                 :<span class="tlaUNC">           0 :     auto result{kernel::SanityChecks(kernel)};</span></span>
<span id="L1153"><span class="lineNum">    1153</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!result) {</span></span>
<span id="L1154"><span class="lineNum">    1154</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         InitError(util::ErrorString(result));</span></span>
<span id="L1155"><span class="lineNum">    1155</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         return InitError(strprintf(_(&quot;Initialization sanity check failed. %s is shutting down.&quot;), CLIENT_NAME));</span></span>
<span id="L1156"><span class="lineNum">    1156</span>                 :             :     }</span>
<span id="L1157"><span class="lineNum">    1157</span>                 :             : </span>
<span id="L1158"><span class="lineNum">    1158</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!ECC_InitSanityCheck()) {</span></span>
<span id="L1159"><span class="lineNum">    1159</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         return InitError(strprintf(_(&quot;Elliptic curve cryptography sanity check failure. %s is shutting down.&quot;), CLIENT_NAME));</span></span>
<span id="L1160"><span class="lineNum">    1160</span>                 :             :     }</span>
<span id="L1161"><span class="lineNum">    1161</span>                 :             : </span>
<span id="L1162"><span class="lineNum">    1162</span>                 :             :     // Probe the directory locks to give an early error message, if possible</span>
<span id="L1163"><span class="lineNum">    1163</span>                 :             :     // We cannot hold the directory locks here, as the forking for daemon() hasn't yet happened,</span>
<span id="L1164"><span class="lineNum">    1164</span>                 :             :     // and a fork will cause weird behavior to them.</span>
<span id="L1165"><span class="lineNum">    1165</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     return LockDirectories(true);</span></span>
<span id="L1166"><span class="lineNum">    1166</span>                 :<span class="tlaUNC">           0 : }</span></span>
<span id="L1167"><span class="lineNum">    1167</span>                 :             : </span>
<span id="L1168"><span class="lineNum">    1168</span>                 :<span class="tlaUNC">           0 : bool AppInitLockDirectories()</span></span>
<span id="L1169"><span class="lineNum">    1169</span>                 :             : {</span>
<span id="L1170"><span class="lineNum">    1170</span>                 :             :     // After daemonization get the directory locks again and hold on to them until exit</span>
<span id="L1171"><span class="lineNum">    1171</span>                 :             :     // This creates a slight window for a race condition to happen, however this condition is harmless: it</span>
<span id="L1172"><span class="lineNum">    1172</span>                 :             :     // will at most make us exit without printing a message to console.</span>
<span id="L1173"><span class="lineNum">    1173</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!LockDirectories(false)) {</span></span>
<span id="L1174"><span class="lineNum">    1174</span>                 :             :         // Detailed error printed inside LockDirectory</span>
<span id="L1175"><span class="lineNum">    1175</span>                 :<span class="tlaUNC">           0 :         return false;</span></span>
<span id="L1176"><span class="lineNum">    1176</span>                 :             :     }</span>
<span id="L1177"><span class="lineNum">    1177</span>                 :             :     return true;</span>
<span id="L1178"><span class="lineNum">    1178</span>                 :             : }</span>
<span id="L1179"><span class="lineNum">    1179</span>                 :             : </span>
<span id="L1180"><span class="lineNum">    1180</span>                 :<span class="tlaUNC">           0 : bool AppInitInterfaces(NodeContext&amp; node)</span></span>
<span id="L1181"><span class="lineNum">    1181</span>                 :             : {</span>
<span id="L1182"><span class="lineNum">    1182</span>                 :<span class="tlaUNC">           0 :     node.chain = node.init-&gt;makeChain();</span></span>
<span id="L1183"><span class="lineNum">    1183</span>                 :<span class="tlaUNC">           0 :     node.mining = node.init-&gt;makeMining();</span></span>
<span id="L1184"><span class="lineNum">    1184</span>                 :<span class="tlaUNC">           0 :     return true;</span></span>
<span id="L1185"><span class="lineNum">    1185</span>                 :             : }</span>
<span id="L1186"><span class="lineNum">    1186</span>                 :             : </span>
<span id="L1187"><span class="lineNum">    1187</span>                 :<span class="tlaUNC">           0 : bool CheckHostPortOptions(const ArgsManager&amp; args) {</span></span>
<span id="L1188"><span class="lineNum">    1188</span>                 :<span class="tlaUNC">           0 :     for (const std::string port_option : {</span></span>
<span id="L1189"><span class="lineNum">    1189</span>                 :             :         &quot;-port&quot;,</span>
<span id="L1190"><span class="lineNum">    1190</span>                 :             :         &quot;-rpcport&quot;,</span>
<span id="L1191"><span class="lineNum">    1191</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     }) {</span></span>
<span id="L1192"><span class="lineNum">    1192</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (const auto port{args.GetArg(port_option)}) {</span></span>
<span id="L1193"><span class="lineNum">    1193</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             const auto n{ToIntegral&lt;uint16_t&gt;(*port)};</span></span>
<span id="L1194"><span class="lineNum">    1194</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (!n || *n == 0) {</span></span>
<span id="L1195"><span class="lineNum">    1195</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 return InitError(InvalidPortErrMsg(port_option, *port));</span></span>
<span id="L1196"><span class="lineNum">    1196</span>                 :             :             }</span>
<span id="L1197"><span class="lineNum">    1197</span>                 :<span class="tlaUNC">           0 :         }</span></span>
<span id="L1198"><span class="lineNum">    1198</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L1199"><span class="lineNum">    1199</span>                 :             : </span>
<span id="L1200"><span class="lineNum">    1200</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     for ([[maybe_unused]] const auto&amp; [param_name, unix, suffix_allowed] : std::vector&lt;std::tuple&lt;std::string, bool, bool&gt;&gt;{</span></span>
<span id="L1201"><span class="lineNum">    1201</span>                 :             :         // arg name          UNIX socket support  =suffix allowed</span>
<span id="L1202"><span class="lineNum">    1202</span>                 :             :         {&quot;-i2psam&quot;,          false,               false},</span>
<span id="L1203"><span class="lineNum">    1203</span>                 :             :         {&quot;-onion&quot;,           true,                false},</span>
<span id="L1204"><span class="lineNum">    1204</span>                 :             :         {&quot;-proxy&quot;,           true,                true},</span>
<span id="L1205"><span class="lineNum">    1205</span>                 :             :         {&quot;-bind&quot;,            false,               true},</span>
<span id="L1206"><span class="lineNum">    1206</span>                 :             :         {&quot;-rpcbind&quot;,         false,               false},</span>
<span id="L1207"><span class="lineNum">    1207</span>                 :             :         {&quot;-torcontrol&quot;,      false,               false},</span>
<span id="L1208"><span class="lineNum">    1208</span>                 :             :         {&quot;-whitebind&quot;,       false,               false},</span>
<span id="L1209"><span class="lineNum">    1209</span>                 :             :         {&quot;-zmqpubhashblock&quot;, true,                false},</span>
<span id="L1210"><span class="lineNum">    1210</span>                 :             :         {&quot;-zmqpubhashtx&quot;,    true,                false},</span>
<span id="L1211"><span class="lineNum">    1211</span>                 :             :         {&quot;-zmqpubrawblock&quot;,  true,                false},</span>
<span id="L1212"><span class="lineNum">    1212</span>                 :             :         {&quot;-zmqpubrawtx&quot;,     true,                false},</span>
<span id="L1213"><span class="lineNum">    1213</span>                 :             :         {&quot;-zmqpubsequence&quot;,  true,                false},</span>
<span id="L1214"><span class="lineNum">    1214</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     }) {</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L1215"><span class="lineNum">    1215</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         for (const std::string&amp; param_value : args.GetArgs(param_name)) {</span></span>
<span id="L1216"><span class="lineNum">    1216</span>                 :<span class="tlaUNC">           0 :             const std::string param_value_hostport{</span></span>
<span id="L1217"><span class="lineNum">    1217</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 suffix_allowed ? param_value.substr(0, param_value.rfind('=')) : param_value};</span></span>
<span id="L1218"><span class="lineNum">    1218</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             std::string host_out;</span></span>
<span id="L1219"><span class="lineNum">    1219</span>                 :<span class="tlaUNC">           0 :             uint16_t port_out{0};</span></span>
<span id="L1220"><span class="lineNum">    1220</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             if (!SplitHostPort(param_value_hostport, port_out, host_out)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1221"><span class="lineNum">    1221</span>                 :             : #ifdef HAVE_SOCKADDR_UN</span>
<span id="L1222"><span class="lineNum">    1222</span>                 :             :                 // Allow unix domain sockets for some options e.g. unix:/some/file/path</span>
<span id="L1223"><span class="lineNum">    1223</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 if (!unix || !param_value.starts_with(ADDR_PREFIX_UNIX)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1224"><span class="lineNum">    1224</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                     return InitError(InvalidPortErrMsg(param_name, param_value));</span></span>
<span id="L1225"><span class="lineNum">    1225</span>                 :             :                 }</span>
<span id="L1226"><span class="lineNum">    1226</span>                 :             : #else</span>
<span id="L1227"><span class="lineNum">    1227</span>                 :             :                 return InitError(InvalidPortErrMsg(param_name, param_value));</span>
<span id="L1228"><span class="lineNum">    1228</span>                 :             : #endif</span>
<span id="L1229"><span class="lineNum">    1229</span>                 :             :             }</span>
<span id="L1230"><span class="lineNum">    1230</span>                 :<span class="tlaUNC">           0 :         }</span></span>
<span id="L1231"><span class="lineNum">    1231</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L1232"><span class="lineNum">    1232</span>                 :             : </span>
<span id="L1233"><span class="lineNum">    1233</span>                 :<span class="tlaUNC">           0 :     return true;</span></span>
<span id="L1234"><span class="lineNum">    1234</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 : }</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span><span class="tlaUNC" title="Branch 13 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 14 was not executed"> # </span><span class="tlaUNC" title="Branch 15 was not executed"> # </span><span class="tlaUNC" title="Branch 16 was not executed"> # </span><span class="tlaUNC" title="Branch 17 was not executed"> # </span><span class="tlaUNC" title="Branch 18 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 19 was not executed"> # </span><span class="tlaUNC" title="Branch 20 was not executed"> # </span><span class="tlaUNC" title="Branch 21 was not executed"> # </span><span class="tlaUNC" title="Branch 22 was not executed"> # </span><span class="tlaUNC" title="Branch 23 was not executed"> # </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 24 was not executed"> # </span><span class="tlaUNC" title="Branch 25 was not executed"> # </span><span class="tlaUNC" title="Branch 26 was not executed"> # </span><span class="tlaUNC" title="Branch 27 was not executed"> # </span>]
<span id="L1235"><span class="lineNum">    1235</span>                 :             : </span>
<span id="L1236"><span class="lineNum">    1236</span>                 :             : // A GUI user may opt to retry once with do_reindex set if there is a failure during chainstate initialization.</span>
<span id="L1237"><span class="lineNum">    1237</span>                 :             : // The function therefore has to support re-entry.</span>
<span id="L1238"><span class="lineNum">    1238</span>                 :<span class="tlaUNC">           0 : static ChainstateLoadResult InitAndLoadChainstate(</span></span>
<span id="L1239"><span class="lineNum">    1239</span>                 :             :     NodeContext&amp; node,</span>
<span id="L1240"><span class="lineNum">    1240</span>                 :             :     bool do_reindex,</span>
<span id="L1241"><span class="lineNum">    1241</span>                 :             :     const bool do_reindex_chainstate,</span>
<span id="L1242"><span class="lineNum">    1242</span>                 :             :     const kernel::CacheSizes&amp; cache_sizes,</span>
<span id="L1243"><span class="lineNum">    1243</span>                 :             :     const ArgsManager&amp; args)</span>
<span id="L1244"><span class="lineNum">    1244</span>                 :             : {</span>
<span id="L1245"><span class="lineNum">    1245</span>                 :             :     // This function may be called twice, so any dirty state must be reset.</span>
<span id="L1246"><span class="lineNum">    1246</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.notifications.reset(); // Drop state, such as a cached tip block</span></span>
<span id="L1247"><span class="lineNum">    1247</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.mempool.reset();</span></span>
<span id="L1248"><span class="lineNum">    1248</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.chainman.reset(); // Drop state, such as an initialized m_block_tree_db</span></span>
<span id="L1249"><span class="lineNum">    1249</span>                 :             : </span>
<span id="L1250"><span class="lineNum">    1250</span>                 :<span class="tlaUNC">           0 :     const CChainParams&amp; chainparams = Params();</span></span>
<span id="L1251"><span class="lineNum">    1251</span>                 :             : </span>
<span id="L1252"><span class="lineNum">    1252</span>                 :<span class="tlaUNC">           0 :     Assert(!node.notifications); // Was reset above</span></span>
<span id="L1253"><span class="lineNum">    1253</span>                 :<span class="tlaUNC">           0 :     node.notifications = std::make_unique&lt;KernelNotifications&gt;(Assert(node.shutdown_request), node.exit_status, *Assert(node.warnings));</span></span>
<span id="L1254"><span class="lineNum">    1254</span>                 :<span class="tlaUNC">           0 :     ReadNotificationArgs(args, *node.notifications);</span></span>
<span id="L1255"><span class="lineNum">    1255</span>                 :             : </span>
<span id="L1256"><span class="lineNum">    1256</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     CTxMemPool::Options mempool_opts{</span></span>
<span id="L1257"><span class="lineNum">    1257</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         .check_ratio = chainparams.DefaultConsistencyChecks() ? 1 : 0,</span></span>
<span id="L1258"><span class="lineNum">    1258</span>                 :<span class="tlaUNC">           0 :         .signals = node.validation_signals.get(),</span></span>
<span id="L1259"><span class="lineNum">    1259</span>                 :<span class="tlaUNC">           0 :     };</span></span>
<span id="L1260"><span class="lineNum">    1260</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     Assert(ApplyArgsManOptions(args, chainparams, mempool_opts)); // no error can happen, already checked in AppInitParameterInteraction</span></span>
<span id="L1261"><span class="lineNum">    1261</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     bilingual_str mempool_error;</span></span>
<span id="L1262"><span class="lineNum">    1262</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     Assert(!node.mempool); // Was reset above</span></span>
<span id="L1263"><span class="lineNum">    1263</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.mempool = std::make_unique&lt;CTxMemPool&gt;(mempool_opts, mempool_error);</span></span>
<span id="L1264"><span class="lineNum">    1264</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!mempool_error.empty()) {</span></span>
<span id="L1265"><span class="lineNum">    1265</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         return {ChainstateLoadStatus::FAILURE_FATAL, mempool_error};</span></span>
<span id="L1266"><span class="lineNum">    1266</span>                 :             :     }</span>
<span id="L1267"><span class="lineNum">    1267</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     LogInfo(&quot;* Using %.1f MiB for in-memory UTXO set (plus up to %.1f MiB of unused mempool space)&quot;,</span></span>
<span id="L1268"><span class="lineNum">    1268</span>                 :             :             cache_sizes.coins * (1.0 / 1024 / 1024),</span>
<span id="L1269"><span class="lineNum">    1269</span>                 :             :             mempool_opts.max_size_bytes * (1.0 / 1024 / 1024));</span>
<span id="L1270"><span class="lineNum">    1270</span>                 :<span class="tlaUNC">           0 :     ChainstateManager::Options chainman_opts{</span></span>
<span id="L1271"><span class="lineNum">    1271</span>                 :             :         .chainparams = chainparams,</span>
<span id="L1272"><span class="lineNum">    1272</span>                 :             :         .datadir = args.GetDataDirNet(),</span>
<span id="L1273"><span class="lineNum">    1273</span>                 :<span class="tlaUNC">           0 :         .notifications = *node.notifications,</span></span>
<span id="L1274"><span class="lineNum">    1274</span>                 :<span class="tlaUNC">           0 :         .signals = node.validation_signals.get(),</span></span>
<span id="L1275"><span class="lineNum">    1275</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     };</span></span>
<span id="L1276"><span class="lineNum">    1276</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     Assert(ApplyArgsManOptions(args, chainman_opts)); // no error can happen, already checked in AppInitParameterInteraction</span></span>
<span id="L1277"><span class="lineNum">    1277</span>                 :             : </span>
<span id="L1278"><span class="lineNum">    1278</span>                 :<span class="tlaUNC">           0 :     BlockManager::Options blockman_opts{</span></span>
<span id="L1279"><span class="lineNum">    1279</span>                 :<span class="tlaUNC">           0 :         .chainparams = chainman_opts.chainparams,</span></span>
<span id="L1280"><span class="lineNum">    1280</span>                 :             :         .blocks_dir = args.GetBlocksDirPath(),</span>
<span id="L1281"><span class="lineNum">    1281</span>                 :<span class="tlaUNC">           0 :         .notifications = chainman_opts.notifications,</span></span>
<span id="L1282"><span class="lineNum">    1282</span>                 :             :         .block_tree_db_params = DBParams{</span>
<span id="L1283"><span class="lineNum">    1283</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             .path = args.GetDataDirNet() / &quot;blocks&quot; / &quot;index&quot;,</span></span>
<span id="L1284"><span class="lineNum">    1284</span>                 :<span class="tlaUNC">           0 :             .cache_bytes = cache_sizes.block_tree_db,</span></span>
<span id="L1285"><span class="lineNum">    1285</span>                 :             :             .wipe_data = do_reindex,</span>
<span id="L1286"><span class="lineNum">    1286</span>                 :             :         },</span>
<span id="L1287"><span class="lineNum">    1287</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     };</span></span>
<span id="L1288"><span class="lineNum">    1288</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     Assert(ApplyArgsManOptions(args, blockman_opts)); // no error can happen, already checked in AppInitParameterInteraction</span></span>
<span id="L1289"><span class="lineNum">    1289</span>                 :             : </span>
<span id="L1290"><span class="lineNum">    1290</span>                 :             :     // Creating the chainstate manager internally creates a BlockManager, opens</span>
<span id="L1291"><span class="lineNum">    1291</span>                 :             :     // the blocks tree db, and wipes existing block files in case of a reindex.</span>
<span id="L1292"><span class="lineNum">    1292</span>                 :             :     // The coinsdb is opened at a later point on LoadChainstate.</span>
<span id="L1293"><span class="lineNum">    1293</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     Assert(!node.chainman); // Was reset above</span></span>
<span id="L1294"><span class="lineNum">    1294</span>                 :<span class="tlaUNC">           0 :     try {</span></span>
<span id="L1295"><span class="lineNum">    1295</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         node.chainman = std::make_unique&lt;ChainstateManager&gt;(*Assert(node.shutdown_signal), chainman_opts, blockman_opts);</span></span>
<span id="L1296"><span class="lineNum">    1296</span>      [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span>]:<span class="tlaUNC">           0 :     } catch (dbwrapper_error&amp; e) {</span></span>
<span id="L1297"><span class="lineNum">    1297</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC">           0 :         LogError(&quot;%s&quot;, e.what());</span></span>
<span id="L1298"><span class="lineNum">    1298</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC">           0 :         return {ChainstateLoadStatus::FAILURE, _(&quot;Error opening block database&quot;)};</span></span>
<span id="L1299"><span class="lineNum">    1299</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC">           0 :     } catch (std::exception&amp; e) {</span></span>
<span id="L1300"><span class="lineNum">    1300</span>   [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span>]:<span class="tlaUNC">           0 :         return {ChainstateLoadStatus::FAILURE_FATAL, Untranslated(strprintf(&quot;Failed to initialize ChainstateManager: %s&quot;, e.what()))};</span></span>
<span id="L1301"><span class="lineNum">    1301</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L1302"><span class="lineNum">    1302</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     ChainstateManager&amp; chainman = *node.chainman;</span></span>
<span id="L1303"><span class="lineNum">    1303</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (chainman.m_interrupt) return {ChainstateLoadStatus::INTERRUPTED, {}};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1304"><span class="lineNum">    1304</span>                 :             : </span>
<span id="L1305"><span class="lineNum">    1305</span>                 :             :     // This is defined and set here instead of inline in validation.h to avoid a hard</span>
<span id="L1306"><span class="lineNum">    1306</span>                 :             :     // dependency between validation and index/base, since the latter is not in</span>
<span id="L1307"><span class="lineNum">    1307</span>                 :             :     // libbitcoinkernel.</span>
<span id="L1308"><span class="lineNum">    1308</span>                 :<span class="tlaUNC">           0 :     chainman.snapshot_download_completed = [&amp;node]() {</span></span>
<span id="L1309"><span class="lineNum">    1309</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (!node.chainman-&gt;m_blockman.IsPruneMode()) {</span></span>
<span id="L1310"><span class="lineNum">    1310</span>                 :<span class="tlaUNC">           0 :             LogInfo(&quot;[snapshot] re-enabling NODE_NETWORK services&quot;);</span></span>
<span id="L1311"><span class="lineNum">    1311</span>                 :<span class="tlaUNC">           0 :             node.connman-&gt;AddLocalServices(NODE_NETWORK);</span></span>
<span id="L1312"><span class="lineNum">    1312</span>                 :             :         }</span>
<span id="L1313"><span class="lineNum">    1313</span>                 :<span class="tlaUNC">           0 :         LogInfo(&quot;[snapshot] restarting indexes&quot;);</span></span>
<span id="L1314"><span class="lineNum">    1314</span>                 :             :         // Drain the validation interface queue to ensure that the old indexes</span>
<span id="L1315"><span class="lineNum">    1315</span>                 :             :         // don't have any pending work.</span>
<span id="L1316"><span class="lineNum">    1316</span>                 :<span class="tlaUNC">           0 :         Assert(node.validation_signals)-&gt;SyncWithValidationInterfaceQueue();</span></span>
<span id="L1317"><span class="lineNum">    1317</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         for (auto* index : node.indexes) {</span></span>
<span id="L1318"><span class="lineNum">    1318</span>                 :<span class="tlaUNC">           0 :             index-&gt;Interrupt();</span></span>
<span id="L1319"><span class="lineNum">    1319</span>                 :<span class="tlaUNC">           0 :             index-&gt;Stop();</span></span>
<span id="L1320"><span class="lineNum">    1320</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (!(index-&gt;Init() &amp;&amp; index-&gt;StartBackgroundSync())) {</span></span>
<span id="L1321"><span class="lineNum">    1321</span>                 :<span class="tlaUNC">           0 :                 LogPrintf(&quot;[snapshot] WARNING failed to restart index %s on snapshot chain\n&quot;, index-&gt;GetName());</span></span>
<span id="L1322"><span class="lineNum">    1322</span>                 :             :             }</span>
<span id="L1323"><span class="lineNum">    1323</span>                 :             :         }</span>
<span id="L1324"><span class="lineNum">    1324</span>                 :<span class="tlaUNC">           0 :     };</span></span>
<span id="L1325"><span class="lineNum">    1325</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node::ChainstateLoadOptions options;</span></span>
<span id="L1326"><span class="lineNum">    1326</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     options.mempool = Assert(node.mempool.get());</span></span>
<span id="L1327"><span class="lineNum">    1327</span>                 :<span class="tlaUNC">           0 :     options.wipe_chainstate_db = do_reindex || do_reindex_chainstate;</span></span>
<span id="L1328"><span class="lineNum">    1328</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     options.prune = chainman.m_blockman.IsPruneMode();</span></span>
<span id="L1329"><span class="lineNum">    1329</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     options.check_blocks = args.GetIntArg(&quot;-checkblocks&quot;, DEFAULT_CHECKBLOCKS);</span></span>
<span id="L1330"><span class="lineNum">    1330</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     options.check_level = args.GetIntArg(&quot;-checklevel&quot;, DEFAULT_CHECKLEVEL);</span></span>
<span id="L1331"><span class="lineNum">    1331</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     options.require_full_verification = args.IsArgSet(&quot;-checkblocks&quot;) || args.IsArgSet(&quot;-checklevel&quot;);</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not executed"> # </span>]
<span id="L1332"><span class="lineNum">    1332</span>                 :<span class="tlaUNC">           0 :     options.coins_error_cb = [] {</span></span>
<span id="L1333"><span class="lineNum">    1333</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         uiInterface.ThreadSafeMessageBox(</span></span>
<span id="L1334"><span class="lineNum">    1334</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             _(&quot;Error reading from database, shutting down.&quot;),</span></span>
<span id="L1335"><span class="lineNum">    1335</span>                 :<span class="tlaUNC">           0 :             &quot;&quot;, CClientUIInterface::MSG_ERROR);</span></span>
<span id="L1336"><span class="lineNum">    1336</span>                 :<span class="tlaUNC">           0 :     };</span></span>
<span id="L1337"><span class="lineNum">    1337</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     uiInterface.InitMessage(_(&quot;Loading block index&quot;));</span></span>
<span id="L1338"><span class="lineNum">    1338</span>                 :<span class="tlaUNC">           0 :     auto catch_exceptions = [](auto&amp;&amp; f) -&gt; ChainstateLoadResult {</span></span>
<span id="L1339"><span class="lineNum">    1339</span>                 :             :         try {</span>
<span id="L1340"><span class="lineNum">    1340</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return f();</span></span>
<span id="L1341"><span class="lineNum">    1341</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC">           0 :         } catch (const std::exception&amp; e) {</span></span>
<span id="L1342"><span class="lineNum">    1342</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC">           0 :             LogError(&quot;%s\n&quot;, e.what());</span></span>
<span id="L1343"><span class="lineNum">    1343</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC">           0 :             return std::make_tuple(node::ChainstateLoadStatus::FAILURE, _(&quot;Error loading databases&quot;));</span></span>
<span id="L1344"><span class="lineNum">    1344</span>                 :             :         }</span>
<span id="L1345"><span class="lineNum">    1345</span>                 :             :     };</span>
<span id="L1346"><span class="lineNum">    1346</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     auto [status, error] = catch_exceptions([&amp;] { return LoadChainstate(chainman, cache_sizes, options); });</span></span>
<span id="L1347"><span class="lineNum">    1347</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (status == node::ChainstateLoadStatus::SUCCESS) {</span></span>
<span id="L1348"><span class="lineNum">    1348</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         uiInterface.InitMessage(_(&quot;Verifying blocks&quot;));</span></span>
<span id="L1349"><span class="lineNum">    1349</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (chainman.m_blockman.m_have_pruned &amp;&amp; options.check_blocks &gt; MIN_BLOCKS_TO_KEEP) {</span></span>
<span id="L1350"><span class="lineNum">    1350</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogWarning(&quot;pruned datadir may not have more than %d blocks; only checking available blocks\n&quot;,</span></span>
<span id="L1351"><span class="lineNum">    1351</span>                 :             :                        MIN_BLOCKS_TO_KEEP);</span>
<span id="L1352"><span class="lineNum">    1352</span>                 :             :         }</span>
<span id="L1353"><span class="lineNum">    1353</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         std::tie(status, error) = catch_exceptions([&amp;] { return VerifyLoadedChainstate(chainman, options); });</span></span>
<span id="L1354"><span class="lineNum">    1354</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (status == node::ChainstateLoadStatus::SUCCESS) {</span></span>
<span id="L1355"><span class="lineNum">    1355</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;Block index and chainstate loaded&quot;);</span></span>
<span id="L1356"><span class="lineNum">    1356</span>                 :             :         }</span>
<span id="L1357"><span class="lineNum">    1357</span>                 :             :     }</span>
<span id="L1358"><span class="lineNum">    1358</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     return {status, error};</span></span>
<span id="L1359"><span class="lineNum">    1359</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 : };</span></span>
<span id="L1360"><span class="lineNum">    1360</span>                 :             : </span>
<span id="L1361"><span class="lineNum">    1361</span>                 :<span class="tlaUNC">           0 : bool AppInitMain(NodeContext&amp; node, interfaces::BlockAndHeaderTipInfo* tip_info)</span></span>
<span id="L1362"><span class="lineNum">    1362</span>                 :             : {</span>
<span id="L1363"><span class="lineNum">    1363</span>                 :<span class="tlaUNC">           0 :     const ArgsManager&amp; args = *Assert(node.args);</span></span>
<span id="L1364"><span class="lineNum">    1364</span>                 :<span class="tlaUNC">           0 :     const CChainParams&amp; chainparams = Params();</span></span>
<span id="L1365"><span class="lineNum">    1365</span>                 :             : </span>
<span id="L1366"><span class="lineNum">    1366</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     auto opt_max_upload = ParseByteUnits(args.GetArg(&quot;-maxuploadtarget&quot;, DEFAULT_MAX_UPLOAD_TARGET), ByteUnit::M);</span></span>
<span id="L1367"><span class="lineNum">    1367</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!opt_max_upload) {</span></span>
<span id="L1368"><span class="lineNum">    1368</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         return InitError(strprintf(_(&quot;Unable to parse -maxuploadtarget: '%s'&quot;), args.GetArg(&quot;-maxuploadtarget&quot;, &quot;&quot;)));</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L1369"><span class="lineNum">    1369</span>                 :             :     }</span>
<span id="L1370"><span class="lineNum">    1370</span>                 :             : </span>
<span id="L1371"><span class="lineNum">    1371</span>                 :             :     // ********************************************************* Step 4a: application initialization</span>
<span id="L1372"><span class="lineNum">    1372</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!CreatePidFile(args)) {</span></span>
<span id="L1373"><span class="lineNum">    1373</span>                 :             :         // Detailed error printed inside CreatePidFile().</span>
<span id="L1374"><span class="lineNum">    1374</span>                 :             :         return false;</span>
<span id="L1375"><span class="lineNum">    1375</span>                 :             :     }</span>
<span id="L1376"><span class="lineNum">    1376</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!init::StartLogging(args)) {</span></span>
<span id="L1377"><span class="lineNum">    1377</span>                 :             :         // Detailed error printed inside StartLogging().</span>
<span id="L1378"><span class="lineNum">    1378</span>                 :             :         return false;</span>
<span id="L1379"><span class="lineNum">    1379</span>                 :             :     }</span>
<span id="L1380"><span class="lineNum">    1380</span>                 :             : </span>
<span id="L1381"><span class="lineNum">    1381</span>                 :<span class="tlaUNC">           0 :     LogInfo(&quot;Using at most %i automatic connections (%i file descriptors available)&quot;, nMaxConnections, available_fds);</span></span>
<span id="L1382"><span class="lineNum">    1382</span>                 :             : </span>
<span id="L1383"><span class="lineNum">    1383</span>                 :             :     // Warn about relative -datadir path.</span>
<span id="L1384"><span class="lineNum">    1384</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (args.IsArgSet(&quot;-datadir&quot;) &amp;&amp; !args.GetPathArg(&quot;-datadir&quot;).is_absolute()) {</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span><span class="tlaUNC" title="Branch 13 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 14 was not executed"> # </span><span class="tlaUNC" title="Branch 15 was not executed"> # </span><span class="tlaUNC" title="Branch 16 was not executed"> # </span><span class="tlaUNC" title="Branch 17 was not executed"> # </span><span class="tlaUNC" title="Branch 18 was not executed"> # </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 19 was not executed"> # </span><span class="tlaUNC" title="Branch 20 was not executed"> # </span><span class="tlaUNC" title="Branch 21 was not executed"> # </span><span class="tlaUNC" title="Branch 22 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 23 was not executed"> # </span>]
<span id="L1385"><span class="lineNum">    1385</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         LogPrintf(&quot;Warning: relative datadir option '%s' specified, which will be interpreted relative to the &quot;</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not executed"> # </span>]
<span id="L1386"><span class="lineNum">    1386</span>                 :             :                   &quot;current working directory '%s'. This is fragile, because if bitcoin is started in the future &quot;</span>
<span id="L1387"><span class="lineNum">    1387</span>                 :             :                   &quot;from a different location, it will be unable to locate the current data files. There could &quot;</span>
<span id="L1388"><span class="lineNum">    1388</span>                 :             :                   &quot;also be data loss if bitcoin is started while in a temporary directory.\n&quot;,</span>
<span id="L1389"><span class="lineNum">    1389</span>                 :             :                   args.GetArg(&quot;-datadir&quot;, &quot;&quot;), fs::PathToString(fs::current_path()));</span>
<span id="L1390"><span class="lineNum">    1390</span>                 :             :     }</span>
<span id="L1391"><span class="lineNum">    1391</span>                 :             : </span>
<span id="L1392"><span class="lineNum">    1392</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     assert(!node.scheduler);</span></span>
<span id="L1393"><span class="lineNum">    1393</span>                 :<span class="tlaUNC">           0 :     node.scheduler = std::make_unique&lt;CScheduler&gt;();</span></span>
<span id="L1394"><span class="lineNum">    1394</span>                 :<span class="tlaUNC">           0 :     auto&amp; scheduler = *node.scheduler;</span></span>
<span id="L1395"><span class="lineNum">    1395</span>                 :             : </span>
<span id="L1396"><span class="lineNum">    1396</span>                 :             :     // Start the lightweight task scheduler thread</span>
<span id="L1397"><span class="lineNum">    1397</span>                 :<span class="tlaUNC">           0 :     scheduler.m_service_thread = std::thread(util::TraceThread, &quot;scheduler&quot;, [&amp;] { scheduler.serviceQueue(); });</span></span>
<span id="L1398"><span class="lineNum">    1398</span>                 :             : </span>
<span id="L1399"><span class="lineNum">    1399</span>                 :             :     // Gather some entropy once per minute.</span>
<span id="L1400"><span class="lineNum">    1400</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     scheduler.scheduleEvery([]{</span></span>
<span id="L1401"><span class="lineNum">    1401</span>                 :<span class="tlaUNC">           0 :         RandAddPeriodic();</span></span>
<span id="L1402"><span class="lineNum">    1402</span>                 :             :     }, std::chrono::minutes{1});</span>
<span id="L1403"><span class="lineNum">    1403</span>                 :             : </span>
<span id="L1404"><span class="lineNum">    1404</span>                 :             :     // Check disk space every 5 minutes to avoid db corruption.</span>
<span id="L1405"><span class="lineNum">    1405</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     scheduler.scheduleEvery([&amp;args, &amp;node]{</span></span>
<span id="L1406"><span class="lineNum">    1406</span>                 :<span class="tlaUNC">           0 :         constexpr uint64_t min_disk_space = 50 &lt;&lt; 20; // 50 MB</span></span>
<span id="L1407"><span class="lineNum">    1407</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (!CheckDiskSpace(args.GetBlocksDirPath(), min_disk_space)) {</span></span>
<span id="L1408"><span class="lineNum">    1408</span>                 :<span class="tlaUNC">           0 :             LogError(&quot;Shutting down due to lack of disk space!\n&quot;);</span></span>
<span id="L1409"><span class="lineNum">    1409</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (!(Assert(node.shutdown_request))()) {</span></span>
<span id="L1410"><span class="lineNum">    1410</span>                 :<span class="tlaUNC">           0 :                 LogError(&quot;Failed to send shutdown signal after disk space check\n&quot;);</span></span>
<span id="L1411"><span class="lineNum">    1411</span>                 :             :             }</span>
<span id="L1412"><span class="lineNum">    1412</span>                 :             :         }</span>
<span id="L1413"><span class="lineNum">    1413</span>                 :<span class="tlaUNC">           0 :     }, std::chrono::minutes{5});</span></span>
<span id="L1414"><span class="lineNum">    1414</span>                 :             : </span>
<span id="L1415"><span class="lineNum">    1415</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (args.GetBoolArg(&quot;-logratelimit&quot;, BCLog::DEFAULT_LOGRATELIMIT)) {</span></span>
<span id="L1416"><span class="lineNum">    1416</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         LogInstance().SetRateLimiting(BCLog::LogRateLimiter::Create(</span></span>
<span id="L1417"><span class="lineNum">    1417</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             [&amp;scheduler](auto func, auto window) { scheduler.scheduleEvery(std::move(func), window); },</span></span>
<span id="L1418"><span class="lineNum">    1418</span>                 :             :             BCLog::RATELIMIT_MAX_BYTES,</span>
<span id="L1419"><span class="lineNum">    1419</span>                 :             :             BCLog::RATELIMIT_WINDOW));</span>
<span id="L1420"><span class="lineNum">    1420</span>                 :             :     } else {</span>
<span id="L1421"><span class="lineNum">    1421</span>                 :<span class="tlaUNC">           0 :         LogInfo(&quot;Log rate limiting disabled&quot;);</span></span>
<span id="L1422"><span class="lineNum">    1422</span>                 :             :     }</span>
<span id="L1423"><span class="lineNum">    1423</span>                 :             : </span>
<span id="L1424"><span class="lineNum">    1424</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     assert(!node.validation_signals);</span></span>
<span id="L1425"><span class="lineNum">    1425</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.validation_signals = std::make_unique&lt;ValidationSignals&gt;(std::make_unique&lt;SerialTaskRunner&gt;(scheduler));</span></span>
<span id="L1426"><span class="lineNum">    1426</span>                 :<span class="tlaUNC">           0 :     auto&amp; validation_signals = *node.validation_signals;</span></span>
<span id="L1427"><span class="lineNum">    1427</span>                 :             : </span>
<span id="L1428"><span class="lineNum">    1428</span>                 :             :     // Create client interfaces for wallets that are supposed to be loaded</span>
<span id="L1429"><span class="lineNum">    1429</span>                 :             :     // according to -wallet and -disablewallet options. This only constructs</span>
<span id="L1430"><span class="lineNum">    1430</span>                 :             :     // the interfaces, it doesn't load wallet data. Wallets actually get loaded</span>
<span id="L1431"><span class="lineNum">    1431</span>                 :             :     // when load() and start() interface methods are called below.</span>
<span id="L1432"><span class="lineNum">    1432</span>                 :<span class="tlaUNC">           0 :     g_wallet_init_interface.Construct(node);</span></span>
<span id="L1433"><span class="lineNum">    1433</span>                 :<span class="tlaUNC">           0 :     uiInterface.InitWallet();</span></span>
<span id="L1434"><span class="lineNum">    1434</span>                 :             : </span>
<span id="L1435"><span class="lineNum">    1435</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (interfaces::Ipc* ipc = node.init-&gt;ipc()) {</span></span>
<span id="L1436"><span class="lineNum">    1436</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         for (std::string address : gArgs.GetArgs(&quot;-ipcbind&quot;)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1437"><span class="lineNum">    1437</span>                 :<span class="tlaUNC">           0 :             try {</span></span>
<span id="L1438"><span class="lineNum">    1438</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 ipc-&gt;listenAddress(address);</span></span>
<span id="L1439"><span class="lineNum">    1439</span>         [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span>]:<span class="tlaUNC">           0 :             } catch (const std::exception&amp; e) {</span></span>
<span id="L1440"><span class="lineNum">    1440</span>   [<span class="tlaUNC" title="Branch 0 was not taken"> - </span><span class="tlaUNC" title="Branch 1 was not taken"> - </span><span class="tlaUNC" title="Branch 2 was not taken"> - </span><span class="tlaUNC" title="Branch 3 was not taken"> - </span> :<span class="tlaUNC">           0 :                 return InitError(Untranslated(strprintf(&quot;Unable to bind to IPC address '%s'. %s&quot;, address, e.what())));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not taken"> - </span><span class="tlaUNC" title="Branch 5 was not taken"> - </span>]
<span id="L1441"><span class="lineNum">    1441</span>                 :<span class="tlaUNC">           0 :             }</span></span>
<span id="L1442"><span class="lineNum">    1442</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;Listening for IPC requests on address %s&quot;, address);</span></span>
<span id="L1443"><span class="lineNum">    1443</span>                 :<span class="tlaUNC">           0 :         }</span></span>
<span id="L1444"><span class="lineNum">    1444</span>                 :             :     }</span>
<span id="L1445"><span class="lineNum">    1445</span>                 :             : </span>
<span id="L1446"><span class="lineNum">    1446</span>                 :             :     /* Register RPC commands regardless of -server setting so they will be</span>
<span id="L1447"><span class="lineNum">    1447</span>                 :             :      * available in the GUI RPC console even if external calls are disabled.</span>
<span id="L1448"><span class="lineNum">    1448</span>                 :             :      */</span>
<span id="L1449"><span class="lineNum">    1449</span>                 :<span class="tlaUNC">           0 :     RegisterAllCoreRPCCommands(tableRPC);</span></span>
<span id="L1450"><span class="lineNum">    1450</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     for (const auto&amp; client : node.chain_clients) {</span></span>
<span id="L1451"><span class="lineNum">    1451</span>                 :<span class="tlaUNC">           0 :         client-&gt;registerRpcs();</span></span>
<span id="L1452"><span class="lineNum">    1452</span>                 :             :     }</span>
<span id="L1453"><span class="lineNum">    1453</span>                 :             : #ifdef ENABLE_ZMQ</span>
<span id="L1454"><span class="lineNum">    1454</span>                 :             :     RegisterZMQRPCCommands(tableRPC);</span>
<span id="L1455"><span class="lineNum">    1455</span>                 :             : #endif</span>
<span id="L1456"><span class="lineNum">    1456</span>                 :             : </span>
<span id="L1457"><span class="lineNum">    1457</span>                 :             :     // Check port numbers</span>
<span id="L1458"><span class="lineNum">    1458</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!CheckHostPortOptions(args)) return false;</span></span>
<span id="L1459"><span class="lineNum">    1459</span>                 :             : </span>
<span id="L1460"><span class="lineNum">    1460</span>                 :             :     // Configure reachable networks before we start the RPC server.</span>
<span id="L1461"><span class="lineNum">    1461</span>                 :             :     // This is necessary for -rpcallowip to distinguish CJDNS from other RFC4193</span>
<span id="L1462"><span class="lineNum">    1462</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     const auto onlynets = args.GetArgs(&quot;-onlynet&quot;);</span></span>
<span id="L1463"><span class="lineNum">    1463</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!onlynets.empty()) {</span></span>
<span id="L1464"><span class="lineNum">    1464</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         g_reachable_nets.RemoveAll();</span></span>
<span id="L1465"><span class="lineNum">    1465</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         for (const std::string&amp; snet : onlynets) {</span></span>
<span id="L1466"><span class="lineNum">    1466</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             enum Network net = ParseNetwork(snet);</span></span>
<span id="L1467"><span class="lineNum">    1467</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (net == NET_UNROUTABLE)</span></span>
<span id="L1468"><span class="lineNum">    1468</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 return InitError(strprintf(_(&quot;Unknown network specified in -onlynet: '%s'&quot;), snet));</span></span>
<span id="L1469"><span class="lineNum">    1469</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             g_reachable_nets.Add(net);</span></span>
<span id="L1470"><span class="lineNum">    1470</span>                 :             :         }</span>
<span id="L1471"><span class="lineNum">    1471</span>                 :             :     }</span>
<span id="L1472"><span class="lineNum">    1472</span>                 :             : </span>
<span id="L1473"><span class="lineNum">    1473</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (!args.IsArgSet(&quot;-cjdnsreachable&quot;)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1474"><span class="lineNum">    1474</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (!onlynets.empty() &amp;&amp; g_reachable_nets.Contains(NET_CJDNS)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1475"><span class="lineNum">    1475</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return InitError(</span></span>
<span id="L1476"><span class="lineNum">    1476</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 _(&quot;Outbound connections restricted to CJDNS (-onlynet=cjdns) but &quot;</span></span>
<span id="L1477"><span class="lineNum">    1477</span>                 :             :                   &quot;-cjdnsreachable is not provided&quot;));</span>
<span id="L1478"><span class="lineNum">    1478</span>                 :             :         }</span>
<span id="L1479"><span class="lineNum">    1479</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         g_reachable_nets.Remove(NET_CJDNS);</span></span>
<span id="L1480"><span class="lineNum">    1480</span>                 :             :     }</span>
<span id="L1481"><span class="lineNum">    1481</span>                 :             :     // Now g_reachable_nets.Contains(NET_CJDNS) is true if:</span>
<span id="L1482"><span class="lineNum">    1482</span>                 :             :     // 1. -cjdnsreachable is given and</span>
<span id="L1483"><span class="lineNum">    1483</span>                 :             :     // 2.1. -onlynet is not given or</span>
<span id="L1484"><span class="lineNum">    1484</span>                 :             :     // 2.2. -onlynet=cjdns is given</span>
<span id="L1485"><span class="lineNum">    1485</span>                 :             : </span>
<span id="L1486"><span class="lineNum">    1486</span>                 :             :     /* Start the RPC server already.  It will be started in &quot;warmup&quot; mode</span>
<span id="L1487"><span class="lineNum">    1487</span>                 :             :      * and not really process calls already (but it will signify connections</span>
<span id="L1488"><span class="lineNum">    1488</span>                 :             :      * that the server is there and will be ready later).  Warmup mode will</span>
<span id="L1489"><span class="lineNum">    1489</span>                 :             :      * be disabled when initialisation is finished.</span>
<span id="L1490"><span class="lineNum">    1490</span>                 :             :      */</span>
<span id="L1491"><span class="lineNum">    1491</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (args.GetBoolArg(&quot;-server&quot;, false)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1492"><span class="lineNum">    1492</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         uiInterface.InitMessage_connect(SetRPCWarmupStatus);</span></span>
<span id="L1493"><span class="lineNum">    1493</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (!AppInitServers(node))</span></span>
<span id="L1494"><span class="lineNum">    1494</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return InitError(_(&quot;Unable to start HTTP server. See debug log for details.&quot;));</span></span>
<span id="L1495"><span class="lineNum">    1495</span>                 :             :     }</span>
<span id="L1496"><span class="lineNum">    1496</span>                 :             : </span>
<span id="L1497"><span class="lineNum">    1497</span>                 :             :     // ********************************************************* Step 5: verify wallet database integrity</span>
<span id="L1498"><span class="lineNum">    1498</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     for (const auto&amp; client : node.chain_clients) {</span></span>
<span id="L1499"><span class="lineNum">    1499</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (!client-&gt;verify()) {</span></span>
<span id="L1500"><span class="lineNum">    1500</span>                 :             :             return false;</span>
<span id="L1501"><span class="lineNum">    1501</span>                 :             :         }</span>
<span id="L1502"><span class="lineNum">    1502</span>                 :             :     }</span>
<span id="L1503"><span class="lineNum">    1503</span>                 :             : </span>
<span id="L1504"><span class="lineNum">    1504</span>                 :             :     // ********************************************************* Step 6: network initialization</span>
<span id="L1505"><span class="lineNum">    1505</span>                 :             :     // Note that we absolutely cannot open any actual connections</span>
<span id="L1506"><span class="lineNum">    1506</span>                 :             :     // until the very end (&quot;start node&quot;) as the UTXO/block state</span>
<span id="L1507"><span class="lineNum">    1507</span>                 :             :     // is not yet setup and may end up being set up twice if we</span>
<span id="L1508"><span class="lineNum">    1508</span>                 :             :     // need to reindex later.</span>
<span id="L1509"><span class="lineNum">    1509</span>                 :             : </span>
<span id="L1510"><span class="lineNum">    1510</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     fListen = args.GetBoolArg(&quot;-listen&quot;, DEFAULT_LISTEN);</span></span>
<span id="L1511"><span class="lineNum">    1511</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     fDiscover = args.GetBoolArg(&quot;-discover&quot;, true);</span></span>
<span id="L1512"><span class="lineNum">    1512</span>                 :             : </span>
<span id="L1513"><span class="lineNum">    1513</span>                 :<span class="tlaUNC">           0 :     PeerManager::Options peerman_opts{};</span></span>
<span id="L1514"><span class="lineNum">    1514</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     ApplyArgsManOptions(args, peerman_opts);</span></span>
<span id="L1515"><span class="lineNum">    1515</span>                 :             : </span>
<span id="L1516"><span class="lineNum">    1516</span>                 :<span class="tlaUNC">           0 :     {</span></span>
<span id="L1517"><span class="lineNum">    1517</span>                 :             : </span>
<span id="L1518"><span class="lineNum">    1518</span>                 :             :         // Read asmap file if configured</span>
<span id="L1519"><span class="lineNum">    1519</span>                 :<span class="tlaUNC">           0 :         std::vector&lt;bool&gt; asmap;</span></span>
<span id="L1520"><span class="lineNum">    1520</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (args.IsArgSet(&quot;-asmap&quot;) &amp;&amp; !args.IsArgNegated(&quot;-asmap&quot;)) {</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span><span class="tlaUNC" title="Branch 13 was not executed"> # </span> 
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 14 was not executed"> # </span><span class="tlaUNC" title="Branch 15 was not executed"> # </span>]
<span id="L1521"><span class="lineNum">    1521</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             fs::path asmap_path = args.GetPathArg(&quot;-asmap&quot;, DEFAULT_ASMAP_FILENAME);</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1522"><span class="lineNum">    1522</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (!asmap_path.is_absolute()) {</span></span>
<span id="L1523"><span class="lineNum">    1523</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 asmap_path = args.GetDataDirNet() / asmap_path;</span></span>
<span id="L1524"><span class="lineNum">    1524</span>                 :             :             }</span>
<span id="L1525"><span class="lineNum">    1525</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (!fs::exists(asmap_path)) {</span></span>
<span id="L1526"><span class="lineNum">    1526</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 InitError(strprintf(_(&quot;Could not find asmap file %s&quot;), fs::quoted(fs::PathToString(asmap_path))));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1527"><span class="lineNum">    1527</span>                 :<span class="tlaUNC">           0 :                 return false;</span></span>
<span id="L1528"><span class="lineNum">    1528</span>                 :             :             }</span>
<span id="L1529"><span class="lineNum">    1529</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             asmap = DecodeAsmap(asmap_path);</span></span>
<span id="L1530"><span class="lineNum">    1530</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (asmap.size() == 0) {</span></span>
<span id="L1531"><span class="lineNum">    1531</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 InitError(strprintf(_(&quot;Could not parse asmap file %s&quot;), fs::quoted(fs::PathToString(asmap_path))));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1532"><span class="lineNum">    1532</span>                 :<span class="tlaUNC">           0 :                 return false;</span></span>
<span id="L1533"><span class="lineNum">    1533</span>                 :             :             }</span>
<span id="L1534"><span class="lineNum">    1534</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             const uint256 asmap_version = (HashWriter{} &lt;&lt; asmap).GetHash();</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1535"><span class="lineNum">    1535</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;Using asmap version %s for IP bucketing&quot;, asmap_version.ToString());</span></span>
<span id="L1536"><span class="lineNum">    1536</span>                 :<span class="tlaUNC">           0 :         } else {</span></span>
<span id="L1537"><span class="lineNum">    1537</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;Using /16 prefix for IP bucketing&quot;);</span></span>
<span id="L1538"><span class="lineNum">    1538</span>                 :             :         }</span>
<span id="L1539"><span class="lineNum">    1539</span>                 :             : </span>
<span id="L1540"><span class="lineNum">    1540</span>                 :             :         // Initialize netgroup manager</span>
<span id="L1541"><span class="lineNum">    1541</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         assert(!node.netgroupman);</span></span>
<span id="L1542"><span class="lineNum">    1542</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         node.netgroupman = std::make_unique&lt;NetGroupManager&gt;(std::move(asmap));</span></span>
<span id="L1543"><span class="lineNum">    1543</span>                 :             : </span>
<span id="L1544"><span class="lineNum">    1544</span>                 :             :         // Initialize addrman</span>
<span id="L1545"><span class="lineNum">    1545</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         assert(!node.addrman);</span></span>
<span id="L1546"><span class="lineNum">    1546</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         uiInterface.InitMessage(_(&quot;Loading P2P addresses&quot;));</span></span>
<span id="L1547"><span class="lineNum">    1547</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         auto addrman{LoadAddrman(*node.netgroupman, args)};</span></span>
<span id="L1548"><span class="lineNum">    1548</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (!addrman) return InitError(util::ErrorString(addrman));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1549"><span class="lineNum">    1549</span>                 :<span class="tlaUNC">           0 :         node.addrman = std::move(*addrman);</span></span>
<span id="L1550"><span class="lineNum">    1550</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L1551"><span class="lineNum">    1551</span>                 :             : </span>
<span id="L1552"><span class="lineNum">    1552</span>                 :<span class="tlaUNC">           0 :     FastRandomContext rng;</span></span>
<span id="L1553"><span class="lineNum">    1553</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     assert(!node.banman);</span></span>
<span id="L1554"><span class="lineNum">    1554</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     node.banman = std::make_unique&lt;BanMan&gt;(args.GetDataDirNet() / &quot;banlist&quot;, &amp;uiInterface, args.GetIntArg(&quot;-bantime&quot;, DEFAULT_MISBEHAVING_BANTIME));</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not executed"> # </span>]
<span id="L1555"><span class="lineNum">    1555</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     assert(!node.connman);</span></span>
<span id="L1556"><span class="lineNum">    1556</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     node.connman = std::make_unique&lt;CConnman&gt;(rng.rand64(),</span></span>
<span id="L1557"><span class="lineNum">    1557</span>                 :<span class="tlaUNC">           0 :                                               rng.rand64(),</span></span>
<span id="L1558"><span class="lineNum">    1558</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                                               *node.addrman, *node.netgroupman, chainparams, args.GetBoolArg(&quot;-networkactive&quot;, true));</span></span>
<span id="L1559"><span class="lineNum">    1559</span>                 :             : </span>
<span id="L1560"><span class="lineNum">    1560</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     assert(!node.fee_estimator);</span></span>
<span id="L1561"><span class="lineNum">    1561</span>                 :             :     // Don't initialize fee estimation with old data if we don't relay transactions,</span>
<span id="L1562"><span class="lineNum">    1562</span>                 :             :     // as they would never get updated.</span>
<span id="L1563"><span class="lineNum">    1563</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!peerman_opts.ignore_incoming_txs) {</span></span>
<span id="L1564"><span class="lineNum">    1564</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         bool read_stale_estimates = args.GetBoolArg(&quot;-acceptstalefeeestimates&quot;, DEFAULT_ACCEPT_STALE_FEE_ESTIMATES);</span></span>
<span id="L1565"><span class="lineNum">    1565</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (read_stale_estimates &amp;&amp; (chainparams.GetChainType() != ChainType::REGTEST)) {</span></span>
<span id="L1566"><span class="lineNum">    1566</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             return InitError(strprintf(_(&quot;acceptstalefeeestimates is not supported on %s chain.&quot;), chainparams.GetChainTypeString()));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1567"><span class="lineNum">    1567</span>                 :             :         }</span>
<span id="L1568"><span class="lineNum">    1568</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         node.fee_estimator = std::make_unique&lt;CBlockPolicyEstimator&gt;(FeeestPath(args), read_stale_estimates);</span></span>
<span id="L1569"><span class="lineNum">    1569</span>                 :             : </span>
<span id="L1570"><span class="lineNum">    1570</span>                 :             :         // Flush estimates to disk periodically</span>
<span id="L1571"><span class="lineNum">    1571</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         CBlockPolicyEstimator* fee_estimator = node.fee_estimator.get();</span></span>
<span id="L1572"><span class="lineNum">    1572</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         scheduler.scheduleEvery([fee_estimator] { fee_estimator-&gt;FlushFeeEstimates(); }, FEE_FLUSH_INTERVAL);</span></span>
<span id="L1573"><span class="lineNum">    1573</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         validation_signals.RegisterValidationInterface(fee_estimator);</span></span>
<span id="L1574"><span class="lineNum">    1574</span>                 :             :     }</span>
<span id="L1575"><span class="lineNum">    1575</span>                 :             : </span>
<span id="L1576"><span class="lineNum">    1576</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     for (const std::string&amp; socket_addr : args.GetArgs(&quot;-bind&quot;)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1577"><span class="lineNum">    1577</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         std::string host_out;</span></span>
<span id="L1578"><span class="lineNum">    1578</span>                 :<span class="tlaUNC">           0 :         uint16_t port_out{0};</span></span>
<span id="L1579"><span class="lineNum">    1579</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         std::string bind_socket_addr = socket_addr.substr(0, socket_addr.rfind('='));</span></span>
<span id="L1580"><span class="lineNum">    1580</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (!SplitHostPort(bind_socket_addr, port_out, host_out)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1581"><span class="lineNum">    1581</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             return InitError(InvalidPortErrMsg(&quot;-bind&quot;, socket_addr));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1582"><span class="lineNum">    1582</span>                 :             :         }</span>
<span id="L1583"><span class="lineNum">    1583</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L1584"><span class="lineNum">    1584</span>                 :             : </span>
<span id="L1585"><span class="lineNum">    1585</span>                 :             :     // sanitize comments per BIP-0014, format user agent and check total size</span>
<span id="L1586"><span class="lineNum">    1586</span>                 :<span class="tlaUNC">           0 :     std::vector&lt;std::string&gt; uacomments;</span></span>
<span id="L1587"><span class="lineNum">    1587</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     for (const std::string&amp; cmt : args.GetArgs(&quot;-uacomment&quot;)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1588"><span class="lineNum">    1588</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (cmt != SanitizeString(cmt, SAFE_CHARS_UA_COMMENT))</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1589"><span class="lineNum">    1589</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return InitError(strprintf(_(&quot;User Agent comment (%s) contains unsafe characters.&quot;), cmt));</span></span>
<span id="L1590"><span class="lineNum">    1590</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         uacomments.push_back(cmt);</span></span>
<span id="L1591"><span class="lineNum">    1591</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L1592"><span class="lineNum">    1592</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     strSubVersion = FormatSubVersion(UA_NAME, CLIENT_VERSION, uacomments);</span></span>
<span id="L1593"><span class="lineNum">    1593</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (strSubVersion.size() &gt; MAX_SUBVERSION_LENGTH) {</span></span>
<span id="L1594"><span class="lineNum">    1594</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         return InitError(strprintf(_(&quot;Total length of network version string (%i) exceeds maximum length (%i). Reduce the number or size of uacomments.&quot;),</span></span>
<span id="L1595"><span class="lineNum">    1595</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             strSubVersion.size(), MAX_SUBVERSION_LENGTH));</span></span>
<span id="L1596"><span class="lineNum">    1596</span>                 :             :     }</span>
<span id="L1597"><span class="lineNum">    1597</span>                 :             : </span>
<span id="L1598"><span class="lineNum">    1598</span>                 :             :     // Requesting DNS seeds entails connecting to IPv4/IPv6, which -onlynet options may prohibit:</span>
<span id="L1599"><span class="lineNum">    1599</span>                 :             :     // If -dnsseed=1 is explicitly specified, abort. If it's left unspecified by the user, we skip</span>
<span id="L1600"><span class="lineNum">    1600</span>                 :             :     // the DNS seeds by adjusting -dnsseed in InitParameterInteraction.</span>
<span id="L1601"><span class="lineNum">    1601</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (args.GetBoolArg(&quot;-dnsseed&quot;) == true &amp;&amp; !g_reachable_nets.Contains(NET_IPV4) &amp;&amp; !g_reachable_nets.Contains(NET_IPV6)) {</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 13 was not executed"> # </span>]
<span id="L1602"><span class="lineNum">    1602</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         return InitError(strprintf(_(&quot;Incompatible options: -dnsseed=1 was explicitly specified, but -onlynet forbids connections to IPv4/IPv6&quot;)));</span></span>
<span id="L1603"><span class="lineNum">    1603</span>                 :<span class="tlaUNC">           0 :     };</span></span>
<span id="L1604"><span class="lineNum">    1604</span>                 :             : </span>
<span id="L1605"><span class="lineNum">    1605</span>                 :             :     // Check for host lookup allowed before parsing any network related parameters</span>
<span id="L1606"><span class="lineNum">    1606</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     fNameLookup = args.GetBoolArg(&quot;-dns&quot;, DEFAULT_NAME_LOOKUP);</span></span>
<span id="L1607"><span class="lineNum">    1607</span>                 :             : </span>
<span id="L1608"><span class="lineNum">    1608</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     bool proxyRandomize = args.GetBoolArg(&quot;-proxyrandomize&quot;, DEFAULT_PROXYRANDOMIZE);</span></span>
<span id="L1609"><span class="lineNum">    1609</span>                 :             :     // -proxy sets a proxy for outgoing network traffic, possibly per network.</span>
<span id="L1610"><span class="lineNum">    1610</span>                 :             :     // -noproxy, -proxy=0 or -proxy=&quot;&quot; can be used to remove the proxy setting, this is the default</span>
<span id="L1611"><span class="lineNum">    1611</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     Proxy ipv4_proxy;</span></span>
<span id="L1612"><span class="lineNum">    1612</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     Proxy ipv6_proxy;</span></span>
<span id="L1613"><span class="lineNum">    1613</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     Proxy onion_proxy;</span></span>
<span id="L1614"><span class="lineNum">    1614</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     Proxy name_proxy;</span></span>
<span id="L1615"><span class="lineNum">    1615</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     Proxy cjdns_proxy;</span></span>
<span id="L1616"><span class="lineNum">    1616</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     for (const std::string&amp; param_value : args.GetArgs(&quot;-proxy&quot;)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1617"><span class="lineNum">    1617</span>                 :<span class="tlaUNC">           0 :         const auto eq_pos{param_value.rfind('=')};</span></span>
<span id="L1618"><span class="lineNum">    1618</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         const std::string proxy_str{param_value.substr(0, eq_pos)}; // e.g. 127.0.0.1:9050=ipv4 -&gt; 127.0.0.1:9050</span></span>
<span id="L1619"><span class="lineNum">    1619</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         std::string net_str;</span></span>
<span id="L1620"><span class="lineNum">    1620</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (eq_pos != std::string::npos) {</span></span>
<span id="L1621"><span class="lineNum">    1621</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (eq_pos + 1 == param_value.length()) {</span></span>
<span id="L1622"><span class="lineNum">    1622</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 return InitError(strprintf(_(&quot;Invalid -proxy address or hostname, ends with '=': '%s'&quot;), param_value));</span></span>
<span id="L1623"><span class="lineNum">    1623</span>                 :             :             }</span>
<span id="L1624"><span class="lineNum">    1624</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             net_str = ToLower(param_value.substr(eq_pos + 1)); // e.g. 127.0.0.1:9050=ipv4 -&gt; ipv4</span></span>
<span id="L1625"><span class="lineNum">    1625</span>                 :             :         }</span>
<span id="L1626"><span class="lineNum">    1626</span>                 :             : </span>
<span id="L1627"><span class="lineNum">    1627</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         Proxy proxy;</span></span>
<span id="L1628"><span class="lineNum">    1628</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (!proxy_str.empty() &amp;&amp; proxy_str != &quot;0&quot;) {</span></span>
<span id="L1629"><span class="lineNum">    1629</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (IsUnixSocketPath(proxy_str)) {</span></span>
<span id="L1630"><span class="lineNum">    1630</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 proxy = Proxy{proxy_str, /*tor_stream_isolation=*/proxyRandomize};</span></span>
<span id="L1631"><span class="lineNum">    1631</span>                 :             :             } else {</span>
<span id="L1632"><span class="lineNum">    1632</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 const std::optional&lt;CService&gt; addr{Lookup(proxy_str, DEFAULT_TOR_SOCKS_PORT, fNameLookup)};</span></span>
<span id="L1633"><span class="lineNum">    1633</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 if (!addr.has_value()) {</span></span>
<span id="L1634"><span class="lineNum">    1634</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                     return InitError(strprintf(_(&quot;Invalid -proxy address or hostname: '%s'&quot;), proxy_str));</span></span>
<span id="L1635"><span class="lineNum">    1635</span>                 :             :                 }</span>
<span id="L1636"><span class="lineNum">    1636</span>                 :<span class="tlaUNC">           0 :                 proxy = Proxy{addr.value(), /*tor_stream_isolation=*/proxyRandomize};</span></span>
<span id="L1637"><span class="lineNum">    1637</span>                 :<span class="tlaUNC">           0 :             }</span></span>
<span id="L1638"><span class="lineNum">    1638</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (!proxy.IsValid()) {</span></span>
<span id="L1639"><span class="lineNum">    1639</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 return InitError(strprintf(_(&quot;Invalid -proxy address or hostname: '%s'&quot;), proxy_str));</span></span>
<span id="L1640"><span class="lineNum">    1640</span>                 :             :             }</span>
<span id="L1641"><span class="lineNum">    1641</span>                 :             :         }</span>
<span id="L1642"><span class="lineNum">    1642</span>                 :             : </span>
<span id="L1643"><span class="lineNum">    1643</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (net_str.empty()) { // For all networks.</span></span>
<span id="L1644"><span class="lineNum">    1644</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             ipv4_proxy = ipv6_proxy = name_proxy = cjdns_proxy = onion_proxy = proxy;</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not executed"> # </span>]
<span id="L1645"><span class="lineNum">    1645</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         } else if (net_str == &quot;ipv4&quot;) {</span></span>
<span id="L1646"><span class="lineNum">    1646</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             ipv4_proxy = name_proxy = proxy;</span></span>
<span id="L1647"><span class="lineNum">    1647</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         } else if (net_str == &quot;ipv6&quot;) {</span></span>
<span id="L1648"><span class="lineNum">    1648</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             ipv6_proxy = name_proxy = proxy;</span></span>
<span id="L1649"><span class="lineNum">    1649</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         } else if (net_str == &quot;tor&quot; || net_str == &quot;onion&quot;) {</span></span>
<span id="L1650"><span class="lineNum">    1650</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             onion_proxy = proxy;</span></span>
<span id="L1651"><span class="lineNum">    1651</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         } else if (net_str == &quot;cjdns&quot;) {</span></span>
<span id="L1652"><span class="lineNum">    1652</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             cjdns_proxy = proxy;</span></span>
<span id="L1653"><span class="lineNum">    1653</span>                 :             :         } else {</span>
<span id="L1654"><span class="lineNum">    1654</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return InitError(strprintf(_(&quot;Unrecognized network in -proxy='%s': '%s'&quot;), param_value, net_str));</span></span>
<span id="L1655"><span class="lineNum">    1655</span>                 :             :         }</span>
<span id="L1656"><span class="lineNum">    1656</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L1657"><span class="lineNum">    1657</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (ipv4_proxy.IsValid()) {</span></span>
<span id="L1658"><span class="lineNum">    1658</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         SetProxy(NET_IPV4, ipv4_proxy);</span></span>
<span id="L1659"><span class="lineNum">    1659</span>                 :             :     }</span>
<span id="L1660"><span class="lineNum">    1660</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (ipv6_proxy.IsValid()) {</span></span>
<span id="L1661"><span class="lineNum">    1661</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         SetProxy(NET_IPV6, ipv6_proxy);</span></span>
<span id="L1662"><span class="lineNum">    1662</span>                 :             :     }</span>
<span id="L1663"><span class="lineNum">    1663</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (name_proxy.IsValid()) {</span></span>
<span id="L1664"><span class="lineNum">    1664</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         SetNameProxy(name_proxy);</span></span>
<span id="L1665"><span class="lineNum">    1665</span>                 :             :     }</span>
<span id="L1666"><span class="lineNum">    1666</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (cjdns_proxy.IsValid()) {</span></span>
<span id="L1667"><span class="lineNum">    1667</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         SetProxy(NET_CJDNS, cjdns_proxy);</span></span>
<span id="L1668"><span class="lineNum">    1668</span>                 :             :     }</span>
<span id="L1669"><span class="lineNum">    1669</span>                 :             : </span>
<span id="L1670"><span class="lineNum">    1670</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     const bool onlynet_used_with_onion{!onlynets.empty() &amp;&amp; g_reachable_nets.Contains(NET_ONION)};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1671"><span class="lineNum">    1671</span>                 :             : </span>
<span id="L1672"><span class="lineNum">    1672</span>                 :             :     // -onion can be used to set only a proxy for .onion, or override normal proxy for .onion addresses</span>
<span id="L1673"><span class="lineNum">    1673</span>                 :             :     // -noonion (or -onion=0) disables connecting to .onion entirely</span>
<span id="L1674"><span class="lineNum">    1674</span>                 :             :     // An empty string is used to not override the onion proxy (in which case it defaults to -proxy set above, or none)</span>
<span id="L1675"><span class="lineNum">    1675</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     std::string onionArg = args.GetArg(&quot;-onion&quot;, &quot;&quot;);</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1676"><span class="lineNum">    1676</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (onionArg != &quot;&quot;) {</span></span>
<span id="L1677"><span class="lineNum">    1677</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (onionArg == &quot;0&quot;) { // Handle -noonion/-onion=0</span></span>
<span id="L1678"><span class="lineNum">    1678</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             onion_proxy = Proxy{};</span></span>
<span id="L1679"><span class="lineNum">    1679</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (onlynet_used_with_onion) {</span></span>
<span id="L1680"><span class="lineNum">    1680</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 return InitError(</span></span>
<span id="L1681"><span class="lineNum">    1681</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                     _(&quot;Outbound connections restricted to Tor (-onlynet=onion) but the proxy for &quot;</span></span>
<span id="L1682"><span class="lineNum">    1682</span>                 :             :                       &quot;reaching the Tor network is explicitly forbidden: -onion=0&quot;));</span>
<span id="L1683"><span class="lineNum">    1683</span>                 :             :             }</span>
<span id="L1684"><span class="lineNum">    1684</span>                 :             :         } else {</span>
<span id="L1685"><span class="lineNum">    1685</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (IsUnixSocketPath(onionArg)) {</span></span>
<span id="L1686"><span class="lineNum">    1686</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 onion_proxy = Proxy(onionArg, /*tor_stream_isolation=*/proxyRandomize);</span></span>
<span id="L1687"><span class="lineNum">    1687</span>                 :             :             } else {</span>
<span id="L1688"><span class="lineNum">    1688</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 const std::optional&lt;CService&gt; addr{Lookup(onionArg, DEFAULT_TOR_SOCKS_PORT, fNameLookup)};</span></span>
<span id="L1689"><span class="lineNum">    1689</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 if (!addr.has_value() || !addr-&gt;IsValid()) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1690"><span class="lineNum">    1690</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                     return InitError(strprintf(_(&quot;Invalid -onion address or hostname: '%s'&quot;), onionArg));</span></span>
<span id="L1691"><span class="lineNum">    1691</span>                 :             :                 }</span>
<span id="L1692"><span class="lineNum">    1692</span>                 :             : </span>
<span id="L1693"><span class="lineNum">    1693</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 onion_proxy = Proxy(addr.value(), /*tor_stream_isolation=*/proxyRandomize);</span></span>
<span id="L1694"><span class="lineNum">    1694</span>                 :<span class="tlaUNC">           0 :             }</span></span>
<span id="L1695"><span class="lineNum">    1695</span>                 :             :         }</span>
<span id="L1696"><span class="lineNum">    1696</span>                 :             :     }</span>
<span id="L1697"><span class="lineNum">    1697</span>                 :             : </span>
<span id="L1698"><span class="lineNum">    1698</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (onion_proxy.IsValid()) {</span></span>
<span id="L1699"><span class="lineNum">    1699</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         SetProxy(NET_ONION, onion_proxy);</span></span>
<span id="L1700"><span class="lineNum">    1700</span>                 :             :     } else {</span>
<span id="L1701"><span class="lineNum">    1701</span>                 :             :         // If -listenonion is set, then we will (try to) connect to the Tor control port</span>
<span id="L1702"><span class="lineNum">    1702</span>                 :             :         // later from the torcontrol thread and may retrieve the onion proxy from there.</span>
<span id="L1703"><span class="lineNum">    1703</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         const bool listenonion_disabled{!args.GetBoolArg(&quot;-listenonion&quot;, DEFAULT_LISTEN_ONION)};</span></span>
<span id="L1704"><span class="lineNum">    1704</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (onlynet_used_with_onion &amp;&amp; listenonion_disabled) {</span></span>
<span id="L1705"><span class="lineNum">    1705</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return InitError(</span></span>
<span id="L1706"><span class="lineNum">    1706</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 _(&quot;Outbound connections restricted to Tor (-onlynet=onion) but the proxy for &quot;</span></span>
<span id="L1707"><span class="lineNum">    1707</span>                 :             :                   &quot;reaching the Tor network is not provided: none of -proxy, -onion or &quot;</span>
<span id="L1708"><span class="lineNum">    1708</span>                 :             :                   &quot;-listenonion is given&quot;));</span>
<span id="L1709"><span class="lineNum">    1709</span>                 :             :         }</span>
<span id="L1710"><span class="lineNum">    1710</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         g_reachable_nets.Remove(NET_ONION);</span></span>
<span id="L1711"><span class="lineNum">    1711</span>                 :             :     }</span>
<span id="L1712"><span class="lineNum">    1712</span>                 :             : </span>
<span id="L1713"><span class="lineNum">    1713</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     for (const std::string&amp; strAddr : args.GetArgs(&quot;-externalip&quot;)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1714"><span class="lineNum">    1714</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         const std::optional&lt;CService&gt; addrLocal{Lookup(strAddr, GetListenPort(), fNameLookup)};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1715"><span class="lineNum">    1715</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (addrLocal.has_value() &amp;&amp; addrLocal-&gt;IsValid())</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1716"><span class="lineNum">    1716</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             AddLocal(addrLocal.value(), LOCAL_MANUAL);</span></span>
<span id="L1717"><span class="lineNum">    1717</span>                 :             :         else</span>
<span id="L1718"><span class="lineNum">    1718</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             return InitError(ResolveErrMsg(&quot;externalip&quot;, strAddr));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1719"><span class="lineNum">    1719</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L1720"><span class="lineNum">    1720</span>                 :             : </span>
<span id="L1721"><span class="lineNum">    1721</span>                 :             : #ifdef ENABLE_ZMQ</span>
<span id="L1722"><span class="lineNum">    1722</span>                 :             :     g_zmq_notification_interface = CZMQNotificationInterface::Create(</span>
<span id="L1723"><span class="lineNum">    1723</span>                 :             :         [&amp;chainman = node.chainman](std::vector&lt;std::byte&gt;&amp; block, const CBlockIndex&amp; index) {</span>
<span id="L1724"><span class="lineNum">    1724</span>                 :             :             assert(chainman);</span>
<span id="L1725"><span class="lineNum">    1725</span>                 :             :             return chainman-&gt;m_blockman.ReadRawBlock(block, WITH_LOCK(cs_main, return index.GetBlockPos()));</span>
<span id="L1726"><span class="lineNum">    1726</span>                 :             :         });</span>
<span id="L1727"><span class="lineNum">    1727</span>                 :             : </span>
<span id="L1728"><span class="lineNum">    1728</span>                 :             :     if (g_zmq_notification_interface) {</span>
<span id="L1729"><span class="lineNum">    1729</span>                 :             :         validation_signals.RegisterValidationInterface(g_zmq_notification_interface.get());</span>
<span id="L1730"><span class="lineNum">    1730</span>                 :             :     }</span>
<span id="L1731"><span class="lineNum">    1731</span>                 :             : #endif</span>
<span id="L1732"><span class="lineNum">    1732</span>                 :             : </span>
<span id="L1733"><span class="lineNum">    1733</span>                 :             :     // ********************************************************* Step 7: load block chain</span>
<span id="L1734"><span class="lineNum">    1734</span>                 :             : </span>
<span id="L1735"><span class="lineNum">    1735</span>                 :             :     // cache size calculations</span>
<span id="L1736"><span class="lineNum">    1736</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     const auto [index_cache_sizes, kernel_cache_sizes] = CalculateCacheSizes(args, g_enabled_filter_types.size());</span></span>
<span id="L1737"><span class="lineNum">    1737</span>                 :             : </span>
<span id="L1738"><span class="lineNum">    1738</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     LogInfo(&quot;Cache configuration:&quot;);</span></span>
<span id="L1739"><span class="lineNum">    1739</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     LogInfo(&quot;* Using %.1f MiB for block index database&quot;, kernel_cache_sizes.block_tree_db * (1.0 / 1024 / 1024));</span></span>
<span id="L1740"><span class="lineNum">    1740</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (args.GetBoolArg(&quot;-txindex&quot;, DEFAULT_TXINDEX)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1741"><span class="lineNum">    1741</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         LogInfo(&quot;* Using %.1f MiB for transaction index database&quot;, index_cache_sizes.tx_index * (1.0 / 1024 / 1024));</span></span>
<span id="L1742"><span class="lineNum">    1742</span>                 :             :     }</span>
<span id="L1743"><span class="lineNum">    1743</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     for (BlockFilterType filter_type : g_enabled_filter_types) {</span></span>
<span id="L1744"><span class="lineNum">    1744</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         LogInfo(&quot;* Using %.1f MiB for %s block filter index database&quot;,</span></span>
<span id="L1745"><span class="lineNum">    1745</span>                 :             :                   index_cache_sizes.filter_index * (1.0 / 1024 / 1024), BlockFilterTypeName(filter_type));</span>
<span id="L1746"><span class="lineNum">    1746</span>                 :             :     }</span>
<span id="L1747"><span class="lineNum">    1747</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     LogInfo(&quot;* Using %.1f MiB for chain state database&quot;, kernel_cache_sizes.coins_db * (1.0 / 1024 / 1024));</span></span>
<span id="L1748"><span class="lineNum">    1748</span>                 :             : </span>
<span id="L1749"><span class="lineNum">    1749</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     assert(!node.mempool);</span></span>
<span id="L1750"><span class="lineNum">    1750</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     assert(!node.chainman);</span></span>
<span id="L1751"><span class="lineNum">    1751</span>                 :             : </span>
<span id="L1752"><span class="lineNum">    1752</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     bool do_reindex{args.GetBoolArg(&quot;-reindex&quot;, false)};</span></span>
<span id="L1753"><span class="lineNum">    1753</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     const bool do_reindex_chainstate{args.GetBoolArg(&quot;-reindex-chainstate&quot;, false)};</span></span>
<span id="L1754"><span class="lineNum">    1754</span>                 :             : </span>
<span id="L1755"><span class="lineNum">    1755</span>                 :             :     // Chainstate initialization and loading may be retried once with reindexing by GUI users</span>
<span id="L1756"><span class="lineNum">    1756</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     auto [status, error] = InitAndLoadChainstate(</span></span>
<span id="L1757"><span class="lineNum">    1757</span>                 :             :         node,</span>
<span id="L1758"><span class="lineNum">    1758</span>                 :             :         do_reindex,</span>
<span id="L1759"><span class="lineNum">    1759</span>                 :             :         do_reindex_chainstate,</span>
<span id="L1760"><span class="lineNum">    1760</span>                 :             :         kernel_cache_sizes,</span>
<span id="L1761"><span class="lineNum">    1761</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         args);</span></span>
<span id="L1762"><span class="lineNum">    1762</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (status == ChainstateLoadStatus::FAILURE &amp;&amp; !do_reindex &amp;&amp; !ShutdownRequested(node)) {</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L1763"><span class="lineNum">    1763</span>                 :             :         // suggest a reindex</span>
<span id="L1764"><span class="lineNum">    1764</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         bool do_retry{HasTestOption(args, &quot;reindex_after_failure_noninteractive_yes&quot;) ||</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not executed"> # </span>]
<span id="L1765"><span class="lineNum">    1765</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             uiInterface.ThreadSafeQuestion(</span></span>
<span id="L1766"><span class="lineNum">    1766</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             error + Untranslated(&quot;.\n\n&quot;) + _(&quot;Do you want to rebuild the databases now?&quot;),</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span><span class="tlaUNC" title="Branch 13 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 14 was not executed"> # </span><span class="tlaUNC" title="Branch 15 was not executed"> # </span><span class="tlaUNC" title="Branch 16 was not executed"> # </span><span class="tlaUNC" title="Branch 17 was not executed"> # </span><span class="tlaUNC" title="Branch 18 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 19 was not executed"> # </span><span class="tlaUNC" title="Branch 20 was not executed"> # </span><span class="tlaUNC" title="Branch 21 was not executed"> # </span><span class="tlaUNC" title="Branch 22 was not executed"> # </span><span class="tlaUNC" title="Branch 23 was not executed"> # </span> 
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 24 was not executed"> # </span><span class="tlaUNC" title="Branch 25 was not executed"> # </span>]
<span id="L1767"><span class="lineNum">    1767</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             error.original + &quot;.\nPlease restart with -reindex or -reindex-chainstate to recover.&quot;,</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1768"><span class="lineNum">    1768</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             &quot;&quot;, CClientUIInterface::MSG_ERROR | CClientUIInterface::BTN_ABORT)};</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1769"><span class="lineNum">    1769</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (!do_retry) {</span></span>
<span id="L1770"><span class="lineNum">    1770</span>                 :             :             return false;</span>
<span id="L1771"><span class="lineNum">    1771</span>                 :             :         }</span>
<span id="L1772"><span class="lineNum">    1772</span>                 :<span class="tlaUNC">           0 :         do_reindex = true;</span></span>
<span id="L1773"><span class="lineNum">    1773</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (!Assert(node.shutdown_signal)-&gt;reset()) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1774"><span class="lineNum">    1774</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogError(&quot;Internal error: failed to reset shutdown signal.\n&quot;);</span></span>
<span id="L1775"><span class="lineNum">    1775</span>                 :             :         }</span>
<span id="L1776"><span class="lineNum">    1776</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         std::tie(status, error) = InitAndLoadChainstate(</span></span>
<span id="L1777"><span class="lineNum">    1777</span>                 :             :             node,</span>
<span id="L1778"><span class="lineNum">    1778</span>                 :             :             do_reindex,</span>
<span id="L1779"><span class="lineNum">    1779</span>                 :             :             do_reindex_chainstate,</span>
<span id="L1780"><span class="lineNum">    1780</span>                 :             :             kernel_cache_sizes,</span>
<span id="L1781"><span class="lineNum">    1781</span>                 :<span class="tlaUNC">           0 :             args);</span></span>
<span id="L1782"><span class="lineNum">    1782</span>                 :             :     }</span>
<span id="L1783"><span class="lineNum">    1783</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (status != ChainstateLoadStatus::SUCCESS &amp;&amp; status != ChainstateLoadStatus::INTERRUPTED) {</span></span>
<span id="L1784"><span class="lineNum">    1784</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         return InitError(error);</span></span>
<span id="L1785"><span class="lineNum">    1785</span>                 :             :     }</span>
<span id="L1786"><span class="lineNum">    1786</span>                 :             : </span>
<span id="L1787"><span class="lineNum">    1787</span>                 :             :     // As LoadBlockIndex can take several minutes, it's possible the user</span>
<span id="L1788"><span class="lineNum">    1788</span>                 :             :     // requested to kill the GUI during the last operation. If so, exit.</span>
<span id="L1789"><span class="lineNum">    1789</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (ShutdownRequested(node)) {</span></span>
<span id="L1790"><span class="lineNum">    1790</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         LogInfo(&quot;Shutdown requested. Exiting.&quot;);</span></span>
<span id="L1791"><span class="lineNum">    1791</span>                 :             :         return false;</span>
<span id="L1792"><span class="lineNum">    1792</span>                 :             :     }</span>
<span id="L1793"><span class="lineNum">    1793</span>                 :             : </span>
<span id="L1794"><span class="lineNum">    1794</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     ChainstateManager&amp; chainman = *Assert(node.chainman);</span></span>
<span id="L1795"><span class="lineNum">    1795</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     auto&amp; kernel_notifications{*Assert(node.notifications)};</span></span>
<span id="L1796"><span class="lineNum">    1796</span>                 :             : </span>
<span id="L1797"><span class="lineNum">    1797</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     assert(!node.peerman);</span></span>
<span id="L1798"><span class="lineNum">    1798</span>                 :<span class="tlaUNC">           0 :     node.peerman = PeerManager::make(*node.connman, *node.addrman,</span></span>
<span id="L1799"><span class="lineNum">    1799</span>                 :             :                                      node.banman.get(), chainman,</span>
<span id="L1800"><span class="lineNum">    1800</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                                      *node.mempool, *node.warnings,</span></span>
<span id="L1801"><span class="lineNum">    1801</span>                 :<span class="tlaUNC">           0 :                                      peerman_opts);</span></span>
<span id="L1802"><span class="lineNum">    1802</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     validation_signals.RegisterValidationInterface(node.peerman.get());</span></span>
<span id="L1803"><span class="lineNum">    1803</span>                 :             : </span>
<span id="L1804"><span class="lineNum">    1804</span>                 :             :     // ********************************************************* Step 8: start indexers</span>
<span id="L1805"><span class="lineNum">    1805</span>                 :             : </span>
<span id="L1806"><span class="lineNum">    1806</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (args.GetBoolArg(&quot;-txindex&quot;, DEFAULT_TXINDEX)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1807"><span class="lineNum">    1807</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         g_txindex = std::make_unique&lt;TxIndex&gt;(interfaces::MakeChain(node), index_cache_sizes.tx_index, false, do_reindex);</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1808"><span class="lineNum">    1808</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         node.indexes.emplace_back(g_txindex.get());</span></span>
<span id="L1809"><span class="lineNum">    1809</span>                 :             :     }</span>
<span id="L1810"><span class="lineNum">    1810</span>                 :             : </span>
<span id="L1811"><span class="lineNum">    1811</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     for (const auto&amp; filter_type : g_enabled_filter_types) {</span></span>
<span id="L1812"><span class="lineNum">    1812</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         InitBlockFilterIndex([&amp;]{ return interfaces::MakeChain(node); }, filter_type, index_cache_sizes.filter_index, false, do_reindex);</span></span>
<span id="L1813"><span class="lineNum">    1813</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         node.indexes.emplace_back(GetBlockFilterIndex(filter_type));</span></span>
<span id="L1814"><span class="lineNum">    1814</span>                 :             :     }</span>
<span id="L1815"><span class="lineNum">    1815</span>                 :             : </span>
<span id="L1816"><span class="lineNum">    1816</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (args.GetBoolArg(&quot;-coinstatsindex&quot;, DEFAULT_COINSTATSINDEX)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1817"><span class="lineNum">    1817</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         g_coin_stats_index = std::make_unique&lt;CoinStatsIndex&gt;(interfaces::MakeChain(node), /*cache_size=*/0, false, do_reindex);</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1818"><span class="lineNum">    1818</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         node.indexes.emplace_back(g_coin_stats_index.get());</span></span>
<span id="L1819"><span class="lineNum">    1819</span>                 :             :     }</span>
<span id="L1820"><span class="lineNum">    1820</span>                 :             : </span>
<span id="L1821"><span class="lineNum">    1821</span>                 :             :     // Init indexes</span>
<span id="L1822"><span class="lineNum">    1822</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     for (auto index : node.indexes) if (!index-&gt;Init()) return false;</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1823"><span class="lineNum">    1823</span>                 :             : </span>
<span id="L1824"><span class="lineNum">    1824</span>                 :             :     // ********************************************************* Step 9: load wallet</span>
<span id="L1825"><span class="lineNum">    1825</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     for (const auto&amp; client : node.chain_clients) {</span></span>
<span id="L1826"><span class="lineNum">    1826</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (!client-&gt;load()) {</span></span>
<span id="L1827"><span class="lineNum">    1827</span>                 :             :             return false;</span>
<span id="L1828"><span class="lineNum">    1828</span>                 :             :         }</span>
<span id="L1829"><span class="lineNum">    1829</span>                 :             :     }</span>
<span id="L1830"><span class="lineNum">    1830</span>                 :             : </span>
<span id="L1831"><span class="lineNum">    1831</span>                 :             :     // ********************************************************* Step 10: data directory maintenance</span>
<span id="L1832"><span class="lineNum">    1832</span>                 :             : </span>
<span id="L1833"><span class="lineNum">    1833</span>                 :             :     // if pruning, perform the initial blockstore prune</span>
<span id="L1834"><span class="lineNum">    1834</span>                 :             :     // after any wallet rescanning has taken place.</span>
<span id="L1835"><span class="lineNum">    1835</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (chainman.m_blockman.IsPruneMode()) {</span></span>
<span id="L1836"><span class="lineNum">    1836</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (chainman.m_blockman.m_blockfiles_indexed) {</span></span>
<span id="L1837"><span class="lineNum">    1837</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LOCK(cs_main);</span></span>
<span id="L1838"><span class="lineNum">    1838</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             for (Chainstate* chainstate : chainman.GetAll()) {</span></span>
<span id="L1839"><span class="lineNum">    1839</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 uiInterface.InitMessage(_(&quot;Pruning blockstore&quot;));</span></span>
<span id="L1840"><span class="lineNum">    1840</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 chainstate-&gt;PruneAndFlush();</span></span>
<span id="L1841"><span class="lineNum">    1841</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             }</span></span>
<span id="L1842"><span class="lineNum">    1842</span>                 :<span class="tlaUNC">           0 :         }</span></span>
<span id="L1843"><span class="lineNum">    1843</span>                 :             :     } else {</span>
<span id="L1844"><span class="lineNum">    1844</span>                 :             :         // Prior to setting NODE_NETWORK, check if we can provide historical blocks.</span>
<span id="L1845"><span class="lineNum">    1845</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (!WITH_LOCK(chainman.GetMutex(), return chainman.BackgroundSyncInProgress())) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1846"><span class="lineNum">    1846</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;Setting NODE_NETWORK on non-prune mode&quot;);</span></span>
<span id="L1847"><span class="lineNum">    1847</span>                 :<span class="tlaUNC">           0 :             g_local_services = ServiceFlags(g_local_services | NODE_NETWORK);</span></span>
<span id="L1848"><span class="lineNum">    1848</span>                 :             :         } else {</span>
<span id="L1849"><span class="lineNum">    1849</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;Running node in NODE_NETWORK_LIMITED mode until snapshot background sync completes&quot;);</span></span>
<span id="L1850"><span class="lineNum">    1850</span>                 :             :         }</span>
<span id="L1851"><span class="lineNum">    1851</span>                 :             :     }</span>
<span id="L1852"><span class="lineNum">    1852</span>                 :             : </span>
<span id="L1853"><span class="lineNum">    1853</span>                 :             :     // ********************************************************* Step 11: import blocks</span>
<span id="L1854"><span class="lineNum">    1854</span>                 :             : </span>
<span id="L1855"><span class="lineNum">    1855</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (!CheckDiskSpace(args.GetDataDirNet())) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1856"><span class="lineNum">    1856</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         InitError(strprintf(_(&quot;Error: Disk space is low for %s&quot;), fs::quoted(fs::PathToString(args.GetDataDirNet()))));</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L1857"><span class="lineNum">    1857</span>                 :<span class="tlaUNC">           0 :         return false;</span></span>
<span id="L1858"><span class="lineNum">    1858</span>                 :             :     }</span>
<span id="L1859"><span class="lineNum">    1859</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (!CheckDiskSpace(args.GetBlocksDirPath())) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1860"><span class="lineNum">    1860</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         InitError(strprintf(_(&quot;Error: Disk space is low for %s&quot;), fs::quoted(fs::PathToString(args.GetBlocksDirPath()))));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1861"><span class="lineNum">    1861</span>                 :<span class="tlaUNC">           0 :         return false;</span></span>
<span id="L1862"><span class="lineNum">    1862</span>                 :             :     }</span>
<span id="L1863"><span class="lineNum">    1863</span>                 :             : </span>
<span id="L1864"><span class="lineNum">    1864</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     int chain_active_height = WITH_LOCK(cs_main, return chainman.ActiveChain().Height());</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L1865"><span class="lineNum">    1865</span>                 :             : </span>
<span id="L1866"><span class="lineNum">    1866</span>                 :             :     // On first startup, warn on low block storage space</span>
<span id="L1867"><span class="lineNum">    1867</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (!do_reindex &amp;&amp; !do_reindex_chainstate &amp;&amp; chain_active_height &lt;= 1) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1868"><span class="lineNum">    1868</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         uint64_t assumed_chain_bytes{chainparams.AssumedBlockchainSize() * 1024 * 1024 * 1024};</span></span>
<span id="L1869"><span class="lineNum">    1869</span>                 :<span class="tlaUNC">           0 :         uint64_t additional_bytes_needed{</span></span>
<span id="L1870"><span class="lineNum">    1870</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             chainman.m_blockman.IsPruneMode() ?</span></span>
<span id="L1871"><span class="lineNum">    1871</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 std::min(chainman.m_blockman.GetPruneTarget(), assumed_chain_bytes) :</span></span>
<span id="L1872"><span class="lineNum">    1872</span>                 :             :                 assumed_chain_bytes};</span>
<span id="L1873"><span class="lineNum">    1873</span>                 :             : </span>
<span id="L1874"><span class="lineNum">    1874</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (!CheckDiskSpace(args.GetBlocksDirPath(), additional_bytes_needed)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1875"><span class="lineNum">    1875</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             InitWarning(strprintf(_(</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1876"><span class="lineNum">    1876</span>                 :             :                     &quot;Disk space for %s may not accommodate the block files. &quot; \</span>
<span id="L1877"><span class="lineNum">    1877</span>                 :             :                     &quot;Approximately %u GB of data will be stored in this directory.&quot;</span>
<span id="L1878"><span class="lineNum">    1878</span>                 :             :                 ),</span>
<span id="L1879"><span class="lineNum">    1879</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 fs::quoted(fs::PathToString(args.GetBlocksDirPath())),</span></span>
<span id="L1880"><span class="lineNum">    1880</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 chainparams.AssumedBlockchainSize()</span></span>
<span id="L1881"><span class="lineNum">    1881</span>                 :             :             ));</span>
<span id="L1882"><span class="lineNum">    1882</span>                 :             :         }</span>
<span id="L1883"><span class="lineNum">    1883</span>                 :             :     }</span>
<span id="L1884"><span class="lineNum">    1884</span>                 :             : </span>
<span id="L1885"><span class="lineNum">    1885</span>                 :             : #ifdef __APPLE__</span>
<span id="L1886"><span class="lineNum">    1886</span>                 :             :     auto check_and_warn_fs{[&amp;](const fs::path&amp; path, std::string_view desc) {</span>
<span id="L1887"><span class="lineNum">    1887</span>                 :             :         const auto path_desc{strprintf(&quot;%s (\&quot;%s\&quot;)&quot;, desc, fs::PathToString(path))};</span>
<span id="L1888"><span class="lineNum">    1888</span>                 :             :         switch (GetFilesystemType(path)) {</span>
<span id="L1889"><span class="lineNum">    1889</span>                 :             :         case FSType::EXFAT:</span>
<span id="L1890"><span class="lineNum">    1890</span>                 :             :             InitWarning(strprintf(_(&quot;The %s path uses exFAT, which is known to have intermittent corruption problems on macOS. &quot;</span>
<span id="L1891"><span class="lineNum">    1891</span>                 :             :                 &quot;Move this directory to a different filesystem to avoid data loss.&quot;), path_desc));</span>
<span id="L1892"><span class="lineNum">    1892</span>                 :             :             break;</span>
<span id="L1893"><span class="lineNum">    1893</span>                 :             :         case FSType::ERROR:</span>
<span id="L1894"><span class="lineNum">    1894</span>                 :             :             LogInfo(&quot;Failed to detect filesystem type for %s&quot;, path_desc);</span>
<span id="L1895"><span class="lineNum">    1895</span>                 :             :             break;</span>
<span id="L1896"><span class="lineNum">    1896</span>                 :             :         case FSType::OTHER:</span>
<span id="L1897"><span class="lineNum">    1897</span>                 :             :             break;</span>
<span id="L1898"><span class="lineNum">    1898</span>                 :             :         }</span>
<span id="L1899"><span class="lineNum">    1899</span>                 :             :     }};</span>
<span id="L1900"><span class="lineNum">    1900</span>                 :             : </span>
<span id="L1901"><span class="lineNum">    1901</span>                 :             :     check_and_warn_fs(args.GetDataDirNet(), &quot;data directory&quot;);</span>
<span id="L1902"><span class="lineNum">    1902</span>                 :             :     check_and_warn_fs(args.GetBlocksDirPath(), &quot;blocks directory&quot;);</span>
<span id="L1903"><span class="lineNum">    1903</span>                 :             : #endif</span>
<span id="L1904"><span class="lineNum">    1904</span>                 :             : </span>
<span id="L1905"><span class="lineNum">    1905</span>                 :             : #if HAVE_SYSTEM</span>
<span id="L1906"><span class="lineNum">    1906</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     const std::string block_notify = args.GetArg(&quot;-blocknotify&quot;, &quot;&quot;);</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1907"><span class="lineNum">    1907</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!block_notify.empty()) {</span></span>
<span id="L1908"><span class="lineNum">    1908</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         uiInterface.NotifyBlockTip_connect([block_notify](SynchronizationState sync_state, const CBlockIndex&amp; block, double /* verification_progress */) {</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not executed"> # </span>]
<span id="L1909"><span class="lineNum">    1909</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (sync_state != SynchronizationState::POST_INIT) return;</span></span>
<span id="L1910"><span class="lineNum">    1910</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             std::string command = block_notify;</span></span>
<span id="L1911"><span class="lineNum">    1911</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             ReplaceAll(command, &quot;%s&quot;, block.GetBlockHash().GetHex());</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1912"><span class="lineNum">    1912</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             std::thread t(runCommand, command);</span></span>
<span id="L1913"><span class="lineNum">    1913</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             t.detach(); // thread runs free</span></span>
<span id="L1914"><span class="lineNum">    1914</span>                 :<span class="tlaUNC">           0 :         });</span></span>
<span id="L1915"><span class="lineNum">    1915</span>                 :             :     }</span>
<span id="L1916"><span class="lineNum">    1916</span>                 :             : #endif</span>
<span id="L1917"><span class="lineNum">    1917</span>                 :             : </span>
<span id="L1918"><span class="lineNum">    1918</span>                 :<span class="tlaUNC">           0 :     std::vector&lt;fs::path&gt; vImportFiles;</span></span>
<span id="L1919"><span class="lineNum">    1919</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     for (const std::string&amp; strFile : args.GetArgs(&quot;-loadblock&quot;)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1920"><span class="lineNum">    1920</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         vImportFiles.push_back(fs::PathFromString(strFile));</span></span>
<span id="L1921"><span class="lineNum">    1921</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L1922"><span class="lineNum">    1922</span>                 :             : </span>
<span id="L1923"><span class="lineNum">    1923</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     node.background_init_thread = std::thread(&amp;util::TraceThread, &quot;initload&quot;, [=, &amp;chainman, &amp;args, &amp;node] {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1924"><span class="lineNum">    1924</span>                 :<span class="tlaUNC">           0 :         ScheduleBatchPriority();</span></span>
<span id="L1925"><span class="lineNum">    1925</span>                 :             :         // Import blocks and ActivateBestChain()</span>
<span id="L1926"><span class="lineNum">    1926</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         ImportBlocks(chainman, vImportFiles);</span></span>
<span id="L1927"><span class="lineNum">    1927</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (args.GetBoolArg(&quot;-stopafterblockimport&quot;, DEFAULT_STOPAFTERBLOCKIMPORT)) {</span></span>
<span id="L1928"><span class="lineNum">    1928</span>                 :<span class="tlaUNC">           0 :             LogInfo(&quot;Stopping after block import&quot;);</span></span>
<span id="L1929"><span class="lineNum">    1929</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (!(Assert(node.shutdown_request))()) {</span></span>
<span id="L1930"><span class="lineNum">    1930</span>                 :<span class="tlaUNC">           0 :                 LogError(&quot;Failed to send shutdown signal after finishing block import\n&quot;);</span></span>
<span id="L1931"><span class="lineNum">    1931</span>                 :             :             }</span>
<span id="L1932"><span class="lineNum">    1932</span>                 :<span class="tlaUNC">           0 :             return;</span></span>
<span id="L1933"><span class="lineNum">    1933</span>                 :             :         }</span>
<span id="L1934"><span class="lineNum">    1934</span>                 :             : </span>
<span id="L1935"><span class="lineNum">    1935</span>                 :             :         // Start indexes initial sync</span>
<span id="L1936"><span class="lineNum">    1936</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (!StartIndexBackgroundSync(node)) {</span></span>
<span id="L1937"><span class="lineNum">    1937</span>                 :<span class="tlaUNC">           0 :             bilingual_str err_str = _(&quot;Failed to start indexes, shutting down&quot;);</span></span>
<span id="L1938"><span class="lineNum">    1938</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             chainman.GetNotifications().fatalError(err_str);</span></span>
<span id="L1939"><span class="lineNum">    1939</span>                 :<span class="tlaUNC">           0 :             return;</span></span>
<span id="L1940"><span class="lineNum">    1940</span>                 :<span class="tlaUNC">           0 :         }</span></span>
<span id="L1941"><span class="lineNum">    1941</span>                 :             :         // Load mempool from disk</span>
<span id="L1942"><span class="lineNum">    1942</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (auto* pool{chainman.ActiveChainstate().GetMempool()}) {</span></span>
<span id="L1943"><span class="lineNum">    1943</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             LoadMempool(*pool, ShouldPersistMempool(args) ? MempoolPath(args) : fs::path{}, chainman.ActiveChainstate(), {});</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L1944"><span class="lineNum">    1944</span>                 :<span class="tlaUNC">           0 :             pool-&gt;SetLoadTried(!chainman.m_interrupt);</span></span>
<span id="L1945"><span class="lineNum">    1945</span>                 :             :         }</span>
<span id="L1946"><span class="lineNum">    1946</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     });</span></span>
<span id="L1947"><span class="lineNum">    1947</span>                 :             : </span>
<span id="L1948"><span class="lineNum">    1948</span>                 :             :     /*</span>
<span id="L1949"><span class="lineNum">    1949</span>                 :             :      * Wait for genesis block to be processed. Typically kernel_notifications.m_tip_block</span>
<span id="L1950"><span class="lineNum">    1950</span>                 :             :      * has already been set by a call to LoadChainTip() in CompleteChainstateInitialization().</span>
<span id="L1951"><span class="lineNum">    1951</span>                 :             :      * But this is skipped if the chainstate doesn't exist yet or is being wiped:</span>
<span id="L1952"><span class="lineNum">    1952</span>                 :             :      *</span>
<span id="L1953"><span class="lineNum">    1953</span>                 :             :      * 1. first startup with an empty datadir</span>
<span id="L1954"><span class="lineNum">    1954</span>                 :             :      * 2. reindex</span>
<span id="L1955"><span class="lineNum">    1955</span>                 :             :      * 3. reindex-chainstate</span>
<span id="L1956"><span class="lineNum">    1956</span>                 :             :      *</span>
<span id="L1957"><span class="lineNum">    1957</span>                 :             :      * In these case it's connected by a call to ActivateBestChain() in the initload thread.</span>
<span id="L1958"><span class="lineNum">    1958</span>                 :             :      */</span>
<span id="L1959"><span class="lineNum">    1959</span>                 :<span class="tlaUNC">           0 :     {</span></span>
<span id="L1960"><span class="lineNum">    1960</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         WAIT_LOCK(kernel_notifications.m_tip_block_mutex, lock);</span></span>
<span id="L1961"><span class="lineNum">    1961</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         kernel_notifications.m_tip_block_cv.wait(lock, [&amp;]() EXCLUSIVE_LOCKS_REQUIRED(kernel_notifications.m_tip_block_mutex) {</span></span>
<span id="L1962"><span class="lineNum">    1962</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return kernel_notifications.TipBlock() || ShutdownRequested(node);</span></span>
<span id="L1963"><span class="lineNum">    1963</span>                 :             :         });</span>
<span id="L1964"><span class="lineNum">    1964</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L1965"><span class="lineNum">    1965</span>                 :             : </span>
<span id="L1966"><span class="lineNum">    1966</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (ShutdownRequested(node)) {</span></span>
<span id="L1967"><span class="lineNum">    1967</span>                 :             :         return false;</span>
<span id="L1968"><span class="lineNum">    1968</span>                 :             :     }</span>
<span id="L1969"><span class="lineNum">    1969</span>                 :             : </span>
<span id="L1970"><span class="lineNum">    1970</span>                 :             :     // ********************************************************* Step 12: start node</span>
<span id="L1971"><span class="lineNum">    1971</span>                 :             : </span>
<span id="L1972"><span class="lineNum">    1972</span>                 :<span class="tlaUNC">           0 :     int64_t best_block_time{};</span></span>
<span id="L1973"><span class="lineNum">    1973</span>                 :<span class="tlaUNC">           0 :     {</span></span>
<span id="L1974"><span class="lineNum">    1974</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         LOCK(chainman.GetMutex());</span></span>
<span id="L1975"><span class="lineNum">    1975</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         const auto&amp; tip{*Assert(chainman.ActiveTip())};</span></span>
<span id="L1976"><span class="lineNum">    1976</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         LogInfo(&quot;block tree size = %u&quot;, chainman.BlockIndex().size());</span></span>
<span id="L1977"><span class="lineNum">    1977</span>                 :<span class="tlaUNC">           0 :         chain_active_height = tip.nHeight;</span></span>
<span id="L1978"><span class="lineNum">    1978</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         best_block_time = tip.GetBlockTime();</span></span>
<span id="L1979"><span class="lineNum">    1979</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (tip_info) {</span></span>
<span id="L1980"><span class="lineNum">    1980</span>                 :<span class="tlaUNC">           0 :             tip_info-&gt;block_height = chain_active_height;</span></span>
<span id="L1981"><span class="lineNum">    1981</span>                 :<span class="tlaUNC">           0 :             tip_info-&gt;block_time = best_block_time;</span></span>
<span id="L1982"><span class="lineNum">    1982</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             tip_info-&gt;verification_progress = chainman.GuessVerificationProgress(&amp;tip);</span></span>
<span id="L1983"><span class="lineNum">    1983</span>                 :             :         }</span>
<span id="L1984"><span class="lineNum">    1984</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (tip_info &amp;&amp; chainman.m_best_header) {</span></span>
<span id="L1985"><span class="lineNum">    1985</span>                 :<span class="tlaUNC">           0 :             tip_info-&gt;header_height = chainman.m_best_header-&gt;nHeight;</span></span>
<span id="L1986"><span class="lineNum">    1986</span>                 :<span class="tlaUNC">           0 :             tip_info-&gt;header_time = chainman.m_best_header-&gt;GetBlockTime();</span></span>
<span id="L1987"><span class="lineNum">    1987</span>                 :             :         }</span>
<span id="L1988"><span class="lineNum">    1988</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L1989"><span class="lineNum">    1989</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     LogInfo(&quot;nBestHeight = %d&quot;, chain_active_height);</span></span>
<span id="L1990"><span class="lineNum">    1990</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (node.peerman) node.peerman-&gt;SetBestBlock(chain_active_height, std::chrono::seconds{best_block_time});</span></span>
<span id="L1991"><span class="lineNum">    1991</span>                 :             : </span>
<span id="L1992"><span class="lineNum">    1992</span>                 :             :     // Map ports with NAT-PMP</span>
<span id="L1993"><span class="lineNum">    1993</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     StartMapPort(args.GetBoolArg(&quot;-natpmp&quot;, DEFAULT_NATPMP));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L1994"><span class="lineNum">    1994</span>                 :             : </span>
<span id="L1995"><span class="lineNum">    1995</span>                 :<span class="tlaUNC">           0 :     CConnman::Options connOptions;</span></span>
<span id="L1996"><span class="lineNum">    1996</span>                 :<span class="tlaUNC">           0 :     connOptions.m_local_services = g_local_services;</span></span>
<span id="L1997"><span class="lineNum">    1997</span>                 :<span class="tlaUNC">           0 :     connOptions.m_max_automatic_connections = nMaxConnections;</span></span>
<span id="L1998"><span class="lineNum">    1998</span>                 :<span class="tlaUNC">           0 :     connOptions.uiInterface = &amp;uiInterface;</span></span>
<span id="L1999"><span class="lineNum">    1999</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     connOptions.m_banman = node.banman.get();</span></span>
<span id="L2000"><span class="lineNum">    2000</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     connOptions.m_msgproc = node.peerman.get();</span></span>
<span id="L2001"><span class="lineNum">    2001</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     connOptions.nSendBufferMaxSize = 1000 * args.GetIntArg(&quot;-maxsendbuffer&quot;, DEFAULT_MAXSENDBUFFER);</span></span>
<span id="L2002"><span class="lineNum">    2002</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     connOptions.nReceiveFloodSize = 1000 * args.GetIntArg(&quot;-maxreceivebuffer&quot;, DEFAULT_MAXRECEIVEBUFFER);</span></span>
<span id="L2003"><span class="lineNum">    2003</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     connOptions.m_added_nodes = args.GetArgs(&quot;-addnode&quot;);</span></span>
<span id="L2004"><span class="lineNum">    2004</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     connOptions.nMaxOutboundLimit = *opt_max_upload;</span></span>
<span id="L2005"><span class="lineNum">    2005</span>                 :<span class="tlaUNC">           0 :     connOptions.m_peer_connect_timeout = peer_connect_timeout;</span></span>
<span id="L2006"><span class="lineNum">    2006</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     connOptions.whitelist_forcerelay = args.GetBoolArg(&quot;-whitelistforcerelay&quot;, DEFAULT_WHITELISTFORCERELAY);</span></span>
<span id="L2007"><span class="lineNum">    2007</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     connOptions.whitelist_relay = args.GetBoolArg(&quot;-whitelistrelay&quot;, DEFAULT_WHITELISTRELAY);</span></span>
<span id="L2008"><span class="lineNum">    2008</span>                 :             : </span>
<span id="L2009"><span class="lineNum">    2009</span>                 :             :     // Port to bind to if `-bind=addr` is provided without a `:port` suffix.</span>
<span id="L2010"><span class="lineNum">    2010</span>                 :<span class="tlaUNC">           0 :     const uint16_t default_bind_port =</span></span>
<span id="L2011"><span class="lineNum">    2011</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         static_cast&lt;uint16_t&gt;(args.GetIntArg(&quot;-port&quot;, Params().GetDefaultPort()));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L2012"><span class="lineNum">    2012</span>                 :             : </span>
<span id="L2013"><span class="lineNum">    2013</span>                 :<span class="tlaUNC">           0 :     const uint16_t default_bind_port_onion = default_bind_port + 1;</span></span>
<span id="L2014"><span class="lineNum">    2014</span>                 :             : </span>
<span id="L2015"><span class="lineNum">    2015</span>                 :<span class="tlaUNC">           0 :     const auto BadPortWarning = [](const char* prefix, uint16_t port) {</span></span>
<span id="L2016"><span class="lineNum">    2016</span>                 :<span class="tlaUNC">           0 :         return strprintf(_(&quot;%s request to listen on port %u. This port is considered \&quot;bad\&quot; and &quot;</span></span>
<span id="L2017"><span class="lineNum">    2017</span>                 :             :                            &quot;thus it is unlikely that any peer will connect to it. See &quot;</span>
<span id="L2018"><span class="lineNum">    2018</span>                 :             :                            &quot;doc/p2p-bad-ports.md for details and a full list.&quot;),</span>
<span id="L2019"><span class="lineNum">    2019</span>                 :             :                          prefix,</span>
<span id="L2020"><span class="lineNum">    2020</span>                 :<span class="tlaUNC">           0 :                          port);</span></span>
<span id="L2021"><span class="lineNum">    2021</span>                 :             :     };</span>
<span id="L2022"><span class="lineNum">    2022</span>                 :             : </span>
<span id="L2023"><span class="lineNum">    2023</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     for (const std::string&amp; bind_arg : args.GetArgs(&quot;-bind&quot;)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L2024"><span class="lineNum">    2024</span>                 :<span class="tlaUNC">           0 :         std::optional&lt;CService&gt; bind_addr;</span></span>
<span id="L2025"><span class="lineNum">    2025</span>                 :<span class="tlaUNC">           0 :         const size_t index = bind_arg.rfind('=');</span></span>
<span id="L2026"><span class="lineNum">    2026</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (index == std::string::npos) {</span></span>
<span id="L2027"><span class="lineNum">    2027</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             bind_addr = Lookup(bind_arg, default_bind_port, /*fAllowLookup=*/false);</span></span>
<span id="L2028"><span class="lineNum">    2028</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (bind_addr.has_value()) {</span></span>
<span id="L2029"><span class="lineNum">    2029</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 connOptions.vBinds.push_back(bind_addr.value());</span></span>
<span id="L2030"><span class="lineNum">    2030</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                 if (IsBadPort(bind_addr.value().GetPort())) {</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L2031"><span class="lineNum">    2031</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :                     InitWarning(BadPortWarning(&quot;-bind&quot;, bind_addr.value().GetPort()));</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L2032"><span class="lineNum">    2032</span>                 :             :                 }</span>
<span id="L2033"><span class="lineNum">    2033</span>                 :<span class="tlaUNC">           0 :                 continue;</span></span>
<span id="L2034"><span class="lineNum">    2034</span>                 :             :             }</span>
<span id="L2035"><span class="lineNum">    2035</span>                 :             :         } else {</span>
<span id="L2036"><span class="lineNum">    2036</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             const std::string network_type = bind_arg.substr(index + 1);</span></span>
<span id="L2037"><span class="lineNum">    2037</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (network_type == &quot;onion&quot;) {</span></span>
<span id="L2038"><span class="lineNum">    2038</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 const std::string truncated_bind_arg = bind_arg.substr(0, index);</span></span>
<span id="L2039"><span class="lineNum">    2039</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 bind_addr = Lookup(truncated_bind_arg, default_bind_port_onion, false);</span></span>
<span id="L2040"><span class="lineNum">    2040</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 if (bind_addr.has_value()) {</span></span>
<span id="L2041"><span class="lineNum">    2041</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                     connOptions.onion_binds.push_back(bind_addr.value());</span></span>
<span id="L2042"><span class="lineNum">    2042</span>                 :<span class="tlaUNC">           0 :                     continue;</span></span>
<span id="L2043"><span class="lineNum">    2043</span>                 :             :                 }</span>
<span id="L2044"><span class="lineNum">    2044</span>                 :<span class="tlaUNC">           0 :             }</span></span>
<span id="L2045"><span class="lineNum">    2045</span>                 :<span class="tlaUNC">           0 :         }</span></span>
<span id="L2046"><span class="lineNum">    2046</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         return InitError(ResolveErrMsg(&quot;bind&quot;, bind_arg));</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L2047"><span class="lineNum">    2047</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L2048"><span class="lineNum">    2048</span>                 :             : </span>
<span id="L2049"><span class="lineNum">    2049</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     for (const std::string&amp; strBind : args.GetArgs(&quot;-whitebind&quot;)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L2050"><span class="lineNum">    2050</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         NetWhitebindPermissions whitebind;</span></span>
<span id="L2051"><span class="lineNum">    2051</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         bilingual_str error;</span></span>
<span id="L2052"><span class="lineNum">    2052</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (!NetWhitebindPermissions::TryParse(strBind, whitebind, error)) return InitError(error);</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L2053"><span class="lineNum">    2053</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         connOptions.vWhiteBinds.push_back(whitebind);</span></span>
<span id="L2054"><span class="lineNum">    2054</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L2055"><span class="lineNum">    2055</span>                 :             : </span>
<span id="L2056"><span class="lineNum">    2056</span>                 :             :     // If the user did not specify -bind= or -whitebind= then we bind</span>
<span id="L2057"><span class="lineNum">    2057</span>                 :             :     // on any address - 0.0.0.0 (IPv4) and :: (IPv6).</span>
<span id="L2058"><span class="lineNum">    2058</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     connOptions.bind_on_any = args.GetArgs(&quot;-bind&quot;).empty() &amp;&amp; args.GetArgs(&quot;-whitebind&quot;).empty();</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span><span class="tlaUNC" title="Branch 13 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 14 was not executed"> # </span><span class="tlaUNC" title="Branch 15 was not executed"> # </span><span class="tlaUNC" title="Branch 16 was not executed"> # </span><span class="tlaUNC" title="Branch 17 was not executed"> # </span><span class="tlaUNC" title="Branch 18 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 19 was not executed"> # </span>]
<span id="L2059"><span class="lineNum">    2059</span>                 :             : </span>
<span id="L2060"><span class="lineNum">    2060</span>                 :             :     // Emit a warning if a bad port is given to -port= but only if -bind and -whitebind are not</span>
<span id="L2061"><span class="lineNum">    2061</span>                 :             :     // given, because if they are, then -port= is ignored.</span>
<span id="L2062"><span class="lineNum">    2062</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (connOptions.bind_on_any &amp;&amp; args.IsArgSet(&quot;-port&quot;)) {</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not executed"> # </span>]
<span id="L2063"><span class="lineNum">    2063</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         const uint16_t port_arg = args.GetIntArg(&quot;-port&quot;, 0);</span></span>
<span id="L2064"><span class="lineNum">    2064</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (IsBadPort(port_arg)) {</span></span>
<span id="L2065"><span class="lineNum">    2065</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             InitWarning(BadPortWarning(&quot;-port&quot;, port_arg));</span></span>
<span id="L2066"><span class="lineNum">    2066</span>                 :             :         }</span>
<span id="L2067"><span class="lineNum">    2067</span>                 :             :     }</span>
<span id="L2068"><span class="lineNum">    2068</span>                 :             : </span>
<span id="L2069"><span class="lineNum">    2069</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     CService onion_service_target;</span></span>
<span id="L2070"><span class="lineNum">    2070</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!connOptions.onion_binds.empty()) {</span></span>
<span id="L2071"><span class="lineNum">    2071</span>                 :<span class="tlaUNC">           0 :         onion_service_target = connOptions.onion_binds.front();</span></span>
<span id="L2072"><span class="lineNum">    2072</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     } else if (!connOptions.vBinds.empty()) {</span></span>
<span id="L2073"><span class="lineNum">    2073</span>                 :<span class="tlaUNC">           0 :         onion_service_target = connOptions.vBinds.front();</span></span>
<span id="L2074"><span class="lineNum">    2074</span>                 :             :     } else {</span>
<span id="L2075"><span class="lineNum">    2075</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         onion_service_target = DefaultOnionServiceTarget(default_bind_port_onion);</span></span>
<span id="L2076"><span class="lineNum">    2076</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         connOptions.onion_binds.push_back(onion_service_target);</span></span>
<span id="L2077"><span class="lineNum">    2077</span>                 :             :     }</span>
<span id="L2078"><span class="lineNum">    2078</span>                 :             : </span>
<span id="L2079"><span class="lineNum">    2079</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (args.GetBoolArg(&quot;-listenonion&quot;, DEFAULT_LISTEN_ONION)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L2080"><span class="lineNum">    2080</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (connOptions.onion_binds.size() &gt; 1) {</span></span>
<span id="L2081"><span class="lineNum">    2081</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             InitWarning(strprintf(_(&quot;More than one onion bind address is provided. Using %s &quot;</span></span>
<span id="L2082"><span class="lineNum">    2082</span>                 :             :                                     &quot;for the automatically created Tor onion service.&quot;),</span>
<span id="L2083"><span class="lineNum">    2083</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                                   onion_service_target.ToStringAddrPort()));</span></span>
<span id="L2084"><span class="lineNum">    2084</span>                 :             :         }</span>
<span id="L2085"><span class="lineNum">    2085</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         StartTorControl(onion_service_target);</span></span>
<span id="L2086"><span class="lineNum">    2086</span>                 :             :     }</span>
<span id="L2087"><span class="lineNum">    2087</span>                 :             : </span>
<span id="L2088"><span class="lineNum">    2088</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (connOptions.bind_on_any) {</span></span>
<span id="L2089"><span class="lineNum">    2089</span>                 :             :         // Only add all IP addresses of the machine if we would be listening on</span>
<span id="L2090"><span class="lineNum">    2090</span>                 :             :         // any address - 0.0.0.0 (IPv4) and :: (IPv6).</span>
<span id="L2091"><span class="lineNum">    2091</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         Discover();</span></span>
<span id="L2092"><span class="lineNum">    2092</span>                 :             :     }</span>
<span id="L2093"><span class="lineNum">    2093</span>                 :             : </span>
<span id="L2094"><span class="lineNum">    2094</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     for (const auto&amp; net : args.GetArgs(&quot;-whitelist&quot;)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L2095"><span class="lineNum">    2095</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         NetWhitelistPermissions subnet;</span></span>
<span id="L2096"><span class="lineNum">    2096</span>                 :<span class="tlaUNC">           0 :         ConnectionDirection connection_direction;</span></span>
<span id="L2097"><span class="lineNum">    2097</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         bilingual_str error;</span></span>
<span id="L2098"><span class="lineNum">    2098</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (!NetWhitelistPermissions::TryParse(net, subnet, connection_direction, error)) return InitError(error);</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L2099"><span class="lineNum">    2099</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (connection_direction &amp; ConnectionDirection::In) {</span></span>
<span id="L2100"><span class="lineNum">    2100</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             connOptions.vWhitelistedRangeIncoming.push_back(subnet);</span></span>
<span id="L2101"><span class="lineNum">    2101</span>                 :             :         }</span>
<span id="L2102"><span class="lineNum">    2102</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (connection_direction &amp; ConnectionDirection::Out) {</span></span>
<span id="L2103"><span class="lineNum">    2103</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             connOptions.vWhitelistedRangeOutgoing.push_back(subnet);</span></span>
<span id="L2104"><span class="lineNum">    2104</span>                 :             :         }</span>
<span id="L2105"><span class="lineNum">    2105</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L2106"><span class="lineNum">    2106</span>                 :             : </span>
<span id="L2107"><span class="lineNum">    2107</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     connOptions.vSeedNodes = args.GetArgs(&quot;-seednode&quot;);</span></span>
<span id="L2108"><span class="lineNum">    2108</span>                 :             : </span>
<span id="L2109"><span class="lineNum">    2109</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     const auto connect = args.GetArgs(&quot;-connect&quot;);</span></span>
<span id="L2110"><span class="lineNum">    2110</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     if (!connect.empty() || args.IsArgNegated(&quot;-connect&quot;)) {</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span>             <span class="tlaUNC" title="Branch 9 was not executed"> # </span>]
<span id="L2111"><span class="lineNum">    2111</span>                 :             :         // Do not initiate other outgoing connections when connecting to trusted</span>
<span id="L2112"><span class="lineNum">    2112</span>                 :             :         // nodes, or when -noconnect is specified.</span>
<span id="L2113"><span class="lineNum">    2113</span>                 :<span class="tlaUNC">           0 :         connOptions.m_use_addrman_outgoing = false;</span></span>
<span id="L2114"><span class="lineNum">    2114</span>                 :             : </span>
<span id="L2115"><span class="lineNum">    2115</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (connect.size() != 1 || connect[0] != &quot;0&quot;) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L2116"><span class="lineNum">    2116</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             connOptions.m_specified_outgoing = connect;</span></span>
<span id="L2117"><span class="lineNum">    2117</span>                 :             :         }</span>
<span id="L2118"><span class="lineNum">    2118</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (!connOptions.m_specified_outgoing.empty() &amp;&amp; !connOptions.vSeedNodes.empty()) {</span></span>
<span id="L2119"><span class="lineNum">    2119</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;-seednode is ignored when -connect is used&quot;);</span></span>
<span id="L2120"><span class="lineNum">    2120</span>                 :             :         }</span>
<span id="L2121"><span class="lineNum">    2121</span>                 :             : </span>
<span id="L2122"><span class="lineNum">    2122</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (args.IsArgSet(&quot;-dnsseed&quot;) &amp;&amp; args.GetBoolArg(&quot;-dnsseed&quot;, DEFAULT_DNSSEED) &amp;&amp; args.IsArgSet(&quot;-proxy&quot;)) {</span></span>
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span><span class="tlaUNC" title="Branch 8 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 9 was not executed"> # </span><span class="tlaUNC" title="Branch 10 was not executed"> # </span><span class="tlaUNC" title="Branch 11 was not executed"> # </span><span class="tlaUNC" title="Branch 12 was not executed"> # </span><span class="tlaUNC" title="Branch 13 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 14 was not executed"> # </span><span class="tlaUNC" title="Branch 15 was not executed"> # </span><span class="tlaUNC" title="Branch 16 was not executed"> # </span><span class="tlaUNC" title="Branch 17 was not executed"> # </span><span class="tlaUNC" title="Branch 18 was not executed"> # </span> 
<span class="lineNum">        </span> <span class="tlaUNC" title="Branch 19 was not executed"> # </span><span class="tlaUNC" title="Branch 20 was not executed"> # </span><span class="tlaUNC" title="Branch 21 was not executed"> # </span><span class="tlaUNC" title="Branch 22 was not executed"> # </span><span class="tlaUNC" title="Branch 23 was not executed"> # </span> 
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 24 was not executed"> # </span><span class="tlaUNC" title="Branch 25 was not executed"> # </span>]
<span id="L2123"><span class="lineNum">    2123</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             LogInfo(&quot;-dnsseed is ignored when -connect is used and -proxy is specified&quot;);</span></span>
<span id="L2124"><span class="lineNum">    2124</span>                 :             :         }</span>
<span id="L2125"><span class="lineNum">    2125</span>                 :             :     }</span>
<span id="L2126"><span class="lineNum">    2126</span>                 :             : </span>
<span id="L2127"><span class="lineNum">    2127</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     const std::string&amp; i2psam_arg = args.GetArg(&quot;-i2psam&quot;, &quot;&quot;);</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L2128"><span class="lineNum">    2128</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!i2psam_arg.empty()) {</span></span>
<span id="L2129"><span class="lineNum">    2129</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         const std::optional&lt;CService&gt; addr{Lookup(i2psam_arg, 7656, fNameLookup)};</span></span>
<span id="L2130"><span class="lineNum">    2130</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (!addr.has_value() || !addr-&gt;IsValid()) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L2131"><span class="lineNum">    2131</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return InitError(strprintf(_(&quot;Invalid -i2psam address or hostname: '%s'&quot;), i2psam_arg));</span></span>
<span id="L2132"><span class="lineNum">    2132</span>                 :             :         }</span>
<span id="L2133"><span class="lineNum">    2133</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :         SetProxy(NET_I2P, Proxy{addr.value()});</span></span>
<span id="L2134"><span class="lineNum">    2134</span>                 :<span class="tlaUNC">           0 :     } else {</span></span>
<span id="L2135"><span class="lineNum">    2135</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (!onlynets.empty() &amp;&amp; g_reachable_nets.Contains(NET_I2P)) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L2136"><span class="lineNum">    2136</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             return InitError(</span></span>
<span id="L2137"><span class="lineNum">    2137</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :                 _(&quot;Outbound connections restricted to i2p (-onlynet=i2p) but &quot;</span></span>
<span id="L2138"><span class="lineNum">    2138</span>                 :             :                   &quot;-i2psam is not provided&quot;));</span>
<span id="L2139"><span class="lineNum">    2139</span>                 :             :         }</span>
<span id="L2140"><span class="lineNum">    2140</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         g_reachable_nets.Remove(NET_I2P);</span></span>
<span id="L2141"><span class="lineNum">    2141</span>                 :             :     }</span>
<span id="L2142"><span class="lineNum">    2142</span>                 :             : </span>
<span id="L2143"><span class="lineNum">    2143</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     connOptions.m_i2p_accept_incoming = args.GetBoolArg(&quot;-i2pacceptincoming&quot;, DEFAULT_I2P_ACCEPT_INCOMING);</span></span>
<span id="L2144"><span class="lineNum">    2144</span>                 :             : </span>
<span id="L2145"><span class="lineNum">    2145</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (!node.connman-&gt;Start(scheduler, connOptions)) {</span></span>
<span id="L2146"><span class="lineNum">    2146</span>                 :             :         return false;</span>
<span id="L2147"><span class="lineNum">    2147</span>                 :             :     }</span>
<span id="L2148"><span class="lineNum">    2148</span>                 :             : </span>
<span id="L2149"><span class="lineNum">    2149</span>                 :             :     // ********************************************************* Step 13: finished</span>
<span id="L2150"><span class="lineNum">    2150</span>                 :             : </span>
<span id="L2151"><span class="lineNum">    2151</span>                 :             :     // At this point, the RPC is &quot;started&quot;, but still in warmup, which means it</span>
<span id="L2152"><span class="lineNum">    2152</span>                 :             :     // cannot yet be called. Before we make it callable, we need to make sure</span>
<span id="L2153"><span class="lineNum">    2153</span>                 :             :     // that the RPC's view of the best block is valid and consistent with</span>
<span id="L2154"><span class="lineNum">    2154</span>                 :             :     // ChainstateManager's active tip.</span>
<span id="L2155"><span class="lineNum">    2155</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     SetRPCWarmupFinished();</span></span>
<span id="L2156"><span class="lineNum">    2156</span>                 :             : </span>
<span id="L2157"><span class="lineNum">    2157</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     uiInterface.InitMessage(_(&quot;Done loading&quot;));</span></span>
<span id="L2158"><span class="lineNum">    2158</span>                 :             : </span>
<span id="L2159"><span class="lineNum">    2159</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     for (const auto&amp; client : node.chain_clients) {</span></span>
<span id="L2160"><span class="lineNum">    2160</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         client-&gt;start(scheduler);</span></span>
<span id="L2161"><span class="lineNum">    2161</span>                 :             :     }</span>
<span id="L2162"><span class="lineNum">    2162</span>                 :             : </span>
<span id="L2163"><span class="lineNum">    2163</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     BanMan* banman = node.banman.get();</span></span>
<span id="L2164"><span class="lineNum">    2164</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     scheduler.scheduleEvery([banman]{</span></span>
<span id="L2165"><span class="lineNum">    2165</span>                 :<span class="tlaUNC">           0 :         banman-&gt;DumpBanlist();</span></span>
<span id="L2166"><span class="lineNum">    2166</span>                 :             :     }, DUMP_BANS_INTERVAL);</span>
<span id="L2167"><span class="lineNum">    2167</span>                 :             : </span>
<span id="L2168"><span class="lineNum">    2168</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (node.peerman) node.peerman-&gt;StartScheduledTasks(scheduler);</span></span>
<span id="L2169"><span class="lineNum">    2169</span>                 :             : </span>
<span id="L2170"><span class="lineNum">    2170</span>                 :             : #if HAVE_SYSTEM</span>
<span id="L2171"><span class="lineNum">    2171</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     StartupNotify(args);</span></span>
<span id="L2172"><span class="lineNum">    2172</span>                 :             : #endif</span>
<span id="L2173"><span class="lineNum">    2173</span>                 :             : </span>
<span id="L2174"><span class="lineNum">    2174</span>                 :             :     return true;</span>
<span id="L2175"><span class="lineNum">    2175</span>                 :<span class="tlaUNC">           0 : }</span></span>
<span id="L2176"><span class="lineNum">    2176</span>                 :             : </span>
<span id="L2177"><span class="lineNum">    2177</span>                 :<span class="tlaUNC">           0 : bool StartIndexBackgroundSync(NodeContext&amp; node)</span></span>
<span id="L2178"><span class="lineNum">    2178</span>                 :             : {</span>
<span id="L2179"><span class="lineNum">    2179</span>                 :             :     // Find the oldest block among all indexes.</span>
<span id="L2180"><span class="lineNum">    2180</span>                 :             :     // This block is used to verify that we have the required blocks' data stored on disk,</span>
<span id="L2181"><span class="lineNum">    2181</span>                 :             :     // starting from that point up to the current tip.</span>
<span id="L2182"><span class="lineNum">    2182</span>                 :             :     // indexes_start_block='nullptr' means &quot;start from height 0&quot;.</span>
<span id="L2183"><span class="lineNum">    2183</span>                 :<span class="tlaUNC">           0 :     std::optional&lt;const CBlockIndex*&gt; indexes_start_block;</span></span>
<span id="L2184"><span class="lineNum">    2184</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     std::string older_index_name;</span></span>
<span id="L2185"><span class="lineNum">    2185</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span>]:<span class="tlaUNC">           0 :     ChainstateManager&amp; chainman = *Assert(node.chainman);</span></span>
<span id="L2186"><span class="lineNum">    2186</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     const Chainstate&amp; chainstate = WITH_LOCK(::cs_main, return chainman.GetChainstateForIndexing());</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L2187"><span class="lineNum">    2187</span>                 :<span class="tlaUNC">           0 :     const CChain&amp; index_chain = chainstate.m_chain;</span></span>
<span id="L2188"><span class="lineNum">    2188</span>                 :             : </span>
<span id="L2189"><span class="lineNum">    2189</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     for (auto index : node.indexes) {</span></span>
<span id="L2190"><span class="lineNum">    2190</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         const IndexSummary&amp; summary = index-&gt;GetSummary();</span></span>
<span id="L2191"><span class="lineNum">    2191</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (summary.synced) continue;</span></span>
<span id="L2192"><span class="lineNum">    2192</span>                 :             : </span>
<span id="L2193"><span class="lineNum">    2193</span>                 :             :         // Get the last common block between the index best block and the active chain</span>
<span id="L2194"><span class="lineNum">    2194</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         LOCK(::cs_main);</span></span>
<span id="L2195"><span class="lineNum">    2195</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         const CBlockIndex* pindex = chainman.m_blockman.LookupBlockIndex(summary.best_block_hash);</span></span>
<span id="L2196"><span class="lineNum">    2196</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         if (!index_chain.Contains(pindex)) {</span></span>
<span id="L2197"><span class="lineNum">    2197</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             pindex = index_chain.FindFork(pindex);</span></span>
<span id="L2198"><span class="lineNum">    2198</span>                 :             :         }</span>
<span id="L2199"><span class="lineNum">    2199</span>                 :             : </span>
<span id="L2200"><span class="lineNum">    2200</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (!indexes_start_block || !pindex || pindex-&gt;nHeight &lt; indexes_start_block.value()-&gt;nHeight) {</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L2201"><span class="lineNum">    2201</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             indexes_start_block = pindex;</span></span>
<span id="L2202"><span class="lineNum">    2202</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             older_index_name = summary.name;</span></span>
<span id="L2203"><span class="lineNum">    2203</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :             if (!pindex) break; // Starting from genesis so no need to look for earlier block.</span></span>
<span id="L2204"><span class="lineNum">    2204</span>                 :             :         }</span>
<span id="L2205"><span class="lineNum">    2205</span>                 :<span class="tlaUNC">           0 :     };</span></span>
<span id="L2206"><span class="lineNum">    2206</span>                 :             : </span>
<span id="L2207"><span class="lineNum">    2207</span>                 :             :     // Verify all blocks needed to sync to current tip are present.</span>
<span id="L2208"><span class="lineNum">    2208</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :     if (indexes_start_block) {</span></span>
<span id="L2209"><span class="lineNum">    2209</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         LOCK(::cs_main);</span></span>
<span id="L2210"><span class="lineNum">    2210</span>         [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span>]:<span class="tlaUNC">           0 :         const CBlockIndex* start_block = *indexes_start_block;</span></span>
<span id="L2211"><span class="lineNum">    2211</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (!start_block) start_block = chainman.ActiveChain().Genesis();</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L2212"><span class="lineNum">    2212</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :         if (!chainman.m_blockman.CheckBlockDataAvailability(*index_chain.Tip(), *Assert(start_block))) {</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L2213"><span class="lineNum">    2213</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :             return InitError(Untranslated(strprintf(&quot;%s best block of the index goes beyond pruned data. Please disable the index or reindex (which will download the whole blockchain again)&quot;, older_index_name)));</span></span>
<span class="lineNum">        </span>    <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span><span class="tlaUNC" title="Branch 6 was not executed"> # </span><span class="tlaUNC" title="Branch 7 was not executed"> # </span>]
<span id="L2214"><span class="lineNum">    2214</span>                 :             :         }</span>
<span id="L2215"><span class="lineNum">    2215</span>                 :<span class="tlaUNC">           0 :     }</span></span>
<span id="L2216"><span class="lineNum">    2216</span>                 :             : </span>
<span id="L2217"><span class="lineNum">    2217</span>                 :             :     // Start threads</span>
<span id="L2218"><span class="lineNum">    2218</span>   [<span class="tlaUNC" title="Branch 0 was not executed"> # </span><span class="tlaUNC" title="Branch 1 was not executed"> # </span><span class="tlaUNC" title="Branch 2 was not executed"> # </span><span class="tlaUNC" title="Branch 3 was not executed"> # </span> :<span class="tlaUNC">           0 :     for (auto index : node.indexes) if (!index-&gt;StartBackgroundSync()) return false;</span></span>
<span class="lineNum">        </span>          <span class="tlaUNC" title="Branch 4 was not executed"> # </span><span class="tlaUNC" title="Branch 5 was not executed"> # </span>]
<span id="L2219"><span class="lineNum">    2219</span>                 :             :     return true;</span>
<span id="L2220"><span class="lineNum">    2220</span>                 :<span class="tlaUNC">           0 : }</span></span>
        </pre>
              </td>
            </tr>
          </table>
          <br>

          <table width="100%" border=0 cellspacing=0 cellpadding=0>
            <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
            <tr><td class="versionInfo">Generated by: <a href="https://github.com//linux-test-project/lcov" target="_parent">LCOV version 2.0-1</a></td></tr>
          </table>
          <br>

</body>
</html>
