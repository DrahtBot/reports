<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - total_coverage.info - src/wallet/rpc/transactions.cpp</title>
  <link rel="stylesheet" type="text/css" href="../../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../../index.html">top level</a> - <a href="index.html">src/wallet/rpc</a> - transactions.cpp<span style="font-size: 80%;"> (source / <a href="transactions.cpp.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">total_coverage.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">482</td>
            <td class="headerCovTableEntry">496</td>
            <td class="headerCovTableEntryHi">97.2 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2000-01-01 12:00:00</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">23</td>
            <td class="headerCovTableEntry">24</td>
            <td class="headerCovTableEntryHi">95.8 %</td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td class="headerItem">Branches:</td>
            <td class="headerCovTableEntry">1188</td>
            <td class="headerCovTableEntry">2174</td>
            <td class="headerCovTableEntryLo">54.6 %</td>
          </tr>
          <tr><td><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">           Branch data     Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>                :            : // Copyright (c) 2011-2021 The Bitcoin Core developers</a>
<a name="2"><span class="lineNum">       2 </span>                :            : // Distributed under the MIT software license, see the accompanying</a>
<a name="3"><span class="lineNum">       3 </span>                :            : // file COPYING or http://www.opensource.org/licenses/mit-license.php.</a>
<a name="4"><span class="lineNum">       4 </span>                :            : </a>
<a name="5"><span class="lineNum">       5 </span>                :            : #include &lt;core_io.h&gt;</a>
<a name="6"><span class="lineNum">       6 </span>                :            : #include &lt;key_io.h&gt;</a>
<a name="7"><span class="lineNum">       7 </span>                :            : #include &lt;policy/rbf.h&gt;</a>
<a name="8"><span class="lineNum">       8 </span>                :            : #include &lt;rpc/util.h&gt;</a>
<a name="9"><span class="lineNum">       9 </span>                :            : #include &lt;util/vector.h&gt;</a>
<a name="10"><span class="lineNum">      10 </span>                :            : #include &lt;wallet/receive.h&gt;</a>
<a name="11"><span class="lineNum">      11 </span>                :            : #include &lt;wallet/rpc/util.h&gt;</a>
<a name="12"><span class="lineNum">      12 </span>                :            : #include &lt;wallet/wallet.h&gt;</a>
<a name="13"><span class="lineNum">      13 </span>                :            : </a>
<a name="14"><span class="lineNum">      14 </span>                :            : using interfaces::FoundBlock;</a>
<a name="15"><span class="lineNum">      15 </span>                :            : </a>
<a name="16"><span class="lineNum">      16 </span>                :            : namespace wallet {</a>
<a name="17"><span class="lineNum">      17 </span>                :<span class="lineCov">       3750 : static void WalletTxToJSON(const CWallet&amp; wallet, const CWalletTx&amp; wtx, UniValue&amp; entry)</span></a>
<a name="18"><span class="lineNum">      18 </span>                :            :     EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet)</a>
<a name="19"><span class="lineNum">      19 </span>                :            : {</a>
<a name="20"><span class="lineNum">      20 </span>                :<span class="lineCov">       3750 :     interfaces::Chain&amp; chain = wallet.chain();</span></a>
<a name="21"><span class="lineNum">      21 </span>                :<span class="lineCov">       3750 :     int confirms = wallet.GetTxDepthInMainChain(wtx);</span></a>
<a name="22"><span class="lineNum">      22 </span>  [<span class="branchCov" title="Branch 0 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       7500 :     entry.pushKV(&quot;confirmations&quot;, confirms);</span></a>
<a name="23"><span class="lineNum">      23 </span>        [<span class="branchCov" title="Branch 0 was taken 1913 times"> + </span><span class="branchCov" title="Branch 1 was taken 1837 times"> + </span>]:<span class="lineCov">       3750 :     if (wtx.IsCoinBase())</span></a>
<a name="24"><span class="lineNum">      24 </span>  [<span class="branchCov" title="Branch 0 was taken 1913 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1913 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       3826 :         entry.pushKV(&quot;generated&quot;, true);</span></a>
<a name="25"><span class="lineNum">      25 </span>        [<span class="branchCov" title="Branch 0 was taken 2653 times"> + </span><span class="branchCov" title="Branch 1 was taken 1097 times"> + </span>]:<span class="lineCov">       3750 :     if (auto* conf = wtx.state&lt;TxStateConfirmed&gt;())</span></a>
<a name="26"><span class="lineNum">      26 </span>                :            :     {</a>
<a name="27"><span class="lineNum">      27 </span>  [<span class="branchCov" title="Branch 0 was taken 2653 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2653 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5306 :         entry.pushKV(&quot;blockhash&quot;, conf-&gt;confirmed_block_hash.GetHex());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2653 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="28"><span class="lineNum">      28 </span>  [<span class="branchCov" title="Branch 0 was taken 2653 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2653 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       5306 :         entry.pushKV(&quot;blockheight&quot;, conf-&gt;confirmed_block_height);</span></a>
<a name="29"><span class="lineNum">      29 </span>  [<span class="branchCov" title="Branch 0 was taken 2653 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2653 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       5306 :         entry.pushKV(&quot;blockindex&quot;, conf-&gt;position_in_block);</span></a>
<a name="30"><span class="lineNum">      30 </span>                :            :         int64_t block_time;</a>
<a name="31"><span class="lineNum">      31 </span>                :<span class="lineCov">       2653 :         CHECK_NONFATAL(chain.findBlock(conf-&gt;confirmed_block_hash, FoundBlock().time(block_time)));</span></a>
<a name="32"><span class="lineNum">      32 </span>  [<span class="branchCov" title="Branch 0 was taken 2653 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2653 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       5306 :         entry.pushKV(&quot;blocktime&quot;, block_time);</span></a>
<a name="33"><span class="lineNum">      33 </span>                :            :     } else {</a>
<a name="34"><span class="lineNum">      34 </span>  [<span class="branchCov" title="Branch 0 was taken 1097 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1097 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2194 :         entry.pushKV(&quot;trusted&quot;, CachedTxIsTrusted(wallet, wtx));</span></a>
<a name="35"><span class="lineNum">      35 </span>                :            :     }</a>
<a name="36"><span class="lineNum">      36 </span>                :<span class="lineCov">       3750 :     uint256 hash = wtx.GetHash();</span></a>
<a name="37"><span class="lineNum">      37 </span>  [<span class="branchCov" title="Branch 0 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7500 :     entry.pushKV(&quot;txid&quot;, hash.GetHex());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="38"><span class="lineNum">      38 </span>  [<span class="branchCov" title="Branch 0 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7500 :     entry.pushKV(&quot;wtxid&quot;, wtx.GetWitnessHash().GetHex());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="39"><span class="lineNum">      39 </span>                :<span class="lineCov">       7500 :     UniValue conflicts(UniValue::VARR);</span></a>
<a name="40"><span class="lineNum">      40 </span>  [<span class="branchCov" title="Branch 0 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 239 times"> + </span><span class="branchCov" title="Branch 3 was taken 3750 times"> + </span>]:<span class="lineCov">       3989 :     for (const uint256&amp; conflict : wallet.GetTxConflicts(wtx))</span></a>
<a name="41"><span class="lineNum">      41 </span>  [<span class="branchCov" title="Branch 0 was taken 239 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 239 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        239 :         conflicts.push_back(conflict.GetHex());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 239 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="42"><span class="lineNum">      42 </span>  [<span class="branchCov" title="Branch 0 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7500 :     entry.pushKV(&quot;walletconflicts&quot;, conflicts);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="43"><span class="lineNum">      43 </span>  [<span class="branchCov" title="Branch 0 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7500 :     entry.pushKV(&quot;time&quot;, wtx.GetTxTime());</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="44"><span class="lineNum">      44 </span>  [<span class="branchCov" title="Branch 0 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7500 :     entry.pushKV(&quot;timereceived&quot;, int64_t{wtx.nTimeReceived});</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="45"><span class="lineNum">      45 </span>                :            : </a>
<a name="46"><span class="lineNum">      46 </span>                :            :     // Add opt-in RBF status</a>
<a name="47"><span class="lineNum">      47 </span>        [<span class="branchCov" title="Branch 0 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       7500 :     std::string rbfStatus = &quot;no&quot;;</span></a>
<a name="48"><span class="lineNum">      48 </span>        [<span class="branchCov" title="Branch 0 was taken 1097 times"> + </span><span class="branchCov" title="Branch 1 was taken 2653 times"> + </span>]:<span class="lineCov">       3750 :     if (confirms &lt;= 0) {</span></a>
<a name="49"><span class="lineNum">      49 </span>        [<span class="branchCov" title="Branch 0 was taken 1097 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1097 :         RBFTransactionState rbfState = chain.isRBFOptIn(*wtx.tx);</span></a>
<a name="50"><span class="lineNum">      50 </span>        [<span class="branchCov" title="Branch 0 was taken 420 times"> + </span><span class="branchCov" title="Branch 1 was taken 677 times"> + </span>]:<span class="lineCov">       1097 :         if (rbfState == RBFTransactionState::UNKNOWN)</span></a>
<a name="51"><span class="lineNum">      51 </span>        [<span class="branchCov" title="Branch 0 was taken 420 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        420 :             rbfStatus = &quot;unknown&quot;;</span></a>
<a name="52"><span class="lineNum">      52 </span>        [<span class="branchCov" title="Branch 0 was taken 459 times"> + </span><span class="branchCov" title="Branch 1 was taken 218 times"> + </span>]:<span class="lineCov">        677 :         else if (rbfState == RBFTransactionState::REPLACEABLE_BIP125)</span></a>
<a name="53"><span class="lineNum">      53 </span>        [<span class="branchCov" title="Branch 0 was taken 459 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        459 :             rbfStatus = &quot;yes&quot;;</span></a>
<a name="54"><span class="lineNum">      54 </span>                :            :     }</a>
<a name="55"><span class="lineNum">      55 </span>  [<span class="branchCov" title="Branch 0 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7500 :     entry.pushKV(&quot;bip125-replaceable&quot;, rbfStatus);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3750 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="56"><span class="lineNum">      56 </span>                :            : </a>
<a name="57"><span class="lineNum">      57 </span>        [<span class="branchCov" title="Branch 0 was taken 25 times"> + </span><span class="branchCov" title="Branch 1 was taken 3750 times"> + </span>]:<span class="lineCov">       3775 :     for (const std::pair&lt;const std::string, std::string&gt;&amp; item : wtx.mapValue)</span></a>
<a name="58"><span class="lineNum">      58 </span>  [<span class="branchCov" title="Branch 0 was taken 25 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 25 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         25 :         entry.pushKV(item.first, item.second);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 25 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="59"><span class="lineNum">      59 </span>                :<span class="lineCov">       3750 : }</span></a>
<a name="60"><span class="lineNum">      60 </span>                :            : </a>
<a name="61"><span class="lineNum">      61 </span>                :            : struct tallyitem</a>
<a name="62"><span class="lineNum">      62 </span>                :            : {</a>
<a name="63"><span class="lineNum">      63 </span>                :            :     CAmount nAmount{0};</a>
<a name="64"><span class="lineNum">      64 </span>                :            :     int nConf{std::numeric_limits&lt;int&gt;::max()};</a>
<a name="65"><span class="lineNum">      65 </span>                :            :     std::vector&lt;uint256&gt; txids;</a>
<a name="66"><span class="lineNum">      66 </span>                :            :     bool fIsWatchonly{false};</a>
<a name="67"><span class="lineNum">      67 </span>                :<span class="lineCov">        457 :     tallyitem() = default;</span></a>
<a name="68"><span class="lineNum">      68 </span>                :            : };</a>
<a name="69"><span class="lineNum">      69 </span>                :            : </a>
<a name="70"><span class="lineNum">      70 </span>                :<span class="lineCov">        448 : static UniValue ListReceived(const CWallet&amp; wallet, const UniValue&amp; params, const bool by_label, const bool include_immature_coinbase) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet)</span></a>
<a name="71"><span class="lineNum">      71 </span>                :            : {</a>
<a name="72"><span class="lineNum">      72 </span>                :            :     // Minimum confirmations</a>
<a name="73"><span class="lineNum">      73 </span>                :<span class="lineCov">        448 :     int nMinDepth = 1;</span></a>
<a name="74"><span class="lineNum">      74 </span>        [<span class="branchCov" title="Branch 0 was taken 414 times"> + </span><span class="branchCov" title="Branch 1 was taken 34 times"> + </span>]:<span class="lineCov">        448 :     if (!params[0].isNull())</span></a>
<a name="75"><span class="lineNum">      75 </span>                :<span class="lineCov">        414 :         nMinDepth = params[0].getInt&lt;int&gt;();</span></a>
<a name="76"><span class="lineNum">      76 </span>                :            : </a>
<a name="77"><span class="lineNum">      77 </span>                :            :     // Whether to include empty labels</a>
<a name="78"><span class="lineNum">      78 </span>                :<span class="lineCov">        448 :     bool fIncludeEmpty = false;</span></a>
<a name="79"><span class="lineNum">      79 </span>        [<span class="branchCov" title="Branch 0 was taken 24 times"> + </span><span class="branchCov" title="Branch 1 was taken 424 times"> + </span>]:<span class="lineCov">        448 :     if (!params[1].isNull())</span></a>
<a name="80"><span class="lineNum">      80 </span>                :<span class="lineCov">         24 :         fIncludeEmpty = params[1].get_bool();</span></a>
<a name="81"><span class="lineNum">      81 </span>                :            : </a>
<a name="82"><span class="lineNum">      82 </span>                :<span class="lineCov">        448 :     isminefilter filter = ISMINE_SPENDABLE;</span></a>
<a name="83"><span class="lineNum">      83 </span>                :            : </a>
<a name="84"><span class="lineNum">      84 </span>        [<span class="branchCov" title="Branch 0 was taken 400 times"> + </span><span class="branchCov" title="Branch 1 was taken 48 times"> + </span>]:<span class="lineCov">        448 :     if (ParseIncludeWatchonly(params[2], wallet)) {</span></a>
<a name="85"><span class="lineNum">      85 </span>                :<span class="lineCov">        400 :         filter |= ISMINE_WATCH_ONLY;</span></a>
<a name="86"><span class="lineNum">      86 </span>                :            :     }</a>
<a name="87"><span class="lineNum">      87 </span>                :            : </a>
<a name="88"><span class="lineNum">      88 </span>                :<span class="lineCov">        448 :     std::optional&lt;CTxDestination&gt; filtered_address{std::nullopt};</span></a>
<a name="89"><span class="lineNum">      89 </span>  [<span class="branchCov" title="Branch 0 was taken 426 times"> + </span><span class="branchCov" title="Branch 1 was taken 22 times"> + </span><span class="branchCov" title="Branch 2 was taken 394 times"> + </span><span class="branchCov" title="Branch 3 was taken 32 times"> + </span> :<span class="lineCov">        448 :     if (!by_label &amp;&amp; !params[3].isNull() &amp;&amp; !params[3].get_str().empty()) {</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 394 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 394 times"> + </span><span class="branchCov" title="Branch 7 was taken 54 times"> + </span>]
<a name="90"><span class="lineNum">      90 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 392 times"> + </span>]:<span class="lineCov">        394 :         if (!IsValidDestinationString(params[3].get_str())) {</span></a>
<a name="91"><span class="lineNum">      91 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :             throw JSONRPCError(RPC_WALLET_ERROR, &quot;address_filter parameter was invalid&quot;);</span></a>
<a name="92"><span class="lineNum">      92 </span>                :            :         }</a>
<a name="93"><span class="lineNum">      93 </span>                :<span class="lineCov">        392 :         filtered_address = DecodeDestination(params[3].get_str());</span></a>
<a name="94"><span class="lineNum">      94 </span>                :            :     }</a>
<a name="95"><span class="lineNum">      95 </span>                :            : </a>
<a name="96"><span class="lineNum">      96 </span>                :            :     // Tally</a>
<a name="97"><span class="lineNum">      97 </span>                :<span class="lineCov">        892 :     std::map&lt;CTxDestination, tallyitem&gt; mapTally;</span></a>
<a name="98"><span class="lineNum">      98 </span>        [<span class="branchCov" title="Branch 0 was taken 23994 times"> + </span><span class="branchCov" title="Branch 1 was taken 446 times"> + </span>]:<span class="lineCov">      24440 :     for (const std::pair&lt;const uint256, CWalletTx&gt;&amp; pairWtx : wallet.mapWallet) {</span></a>
<a name="99"><span class="lineNum">      99 </span>                :<span class="lineCov">      23994 :         const CWalletTx&amp; wtx = pairWtx.second;</span></a>
<a name="100"><span class="lineNum">     100 </span>                :            : </a>
<a name="101"><span class="lineNum">     101 </span>        [<span class="branchCov" title="Branch 0 was taken 23994 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      23994 :         int nDepth = wallet.GetTxDepthInMainChain(wtx);</span></a>
<a name="102"><span class="lineNum">     102 </span>        [<span class="branchCov" title="Branch 0 was taken 34 times"> + </span><span class="branchCov" title="Branch 1 was taken 23960 times"> + </span>]:<span class="lineCov">      23994 :         if (nDepth &lt; nMinDepth)</span></a>
<a name="103"><span class="lineNum">     103 </span>                :<span class="lineCov">         34 :             continue;</span></a>
<a name="104"><span class="lineNum">     104 </span>                :            : </a>
<a name="105"><span class="lineNum">     105 </span>                :            :         // Coinbase with less than 1 confirmation is no longer in the main chain</a>
<a name="106"><span class="lineNum">     106 </span>  [<span class="branchCov" title="Branch 0 was taken 23960 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 10618 times"> + </span><span class="branchCov" title="Branch 3 was taken 404 times"> + </span>]:<span class="lineCov">      34982 :         if ((wtx.IsCoinBase() &amp;&amp; (nDepth &lt; 1))</span></a>
<a name="107"><span class="lineNum">     107 </span>  [<span class="branchCov" title="Branch 0 was taken 11022 times"> + </span><span class="branchCov" title="Branch 1 was taken 12938 times"> + </span><span class="branchCov" title="Branch 2 was taken 23556 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      34982 :             || (wallet.IsTxImmatureCoinBase(wtx) &amp;&amp; !include_immature_coinbase)) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1906 times"> + </span><span class="branchCov" title="Branch 5 was taken 21650 times"> + </span><span class="branchCov" title="Branch 6 was taken 1886 times"> + </span><span class="branchCov" title="Branch 7 was taken 20 times"> + </span><span class="branchCov" title="Branch 8 was taken 2290 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 21670 times"> + </span>]
<a name="108"><span class="lineNum">     108 </span>                :<span class="lineCov">       2290 :             continue;</span></a>
<a name="109"><span class="lineNum">     109 </span>                :            :         }</a>
<a name="110"><span class="lineNum">     110 </span>                :            : </a>
<a name="111"><span class="lineNum">     111 </span>        [<span class="branchCov" title="Branch 0 was taken 43340 times"> + </span><span class="branchCov" title="Branch 1 was taken 21670 times"> + </span>]:<span class="lineCov">      65010 :         for (const CTxOut&amp; txout : wtx.tx-&gt;vout) {</span></a>
<a name="112"><span class="lineNum">     112 </span>                :<span class="lineCov">      43340 :             CTxDestination address;</span></a>
<a name="113"><span class="lineNum">     113 </span>  [<span class="branchCov" title="Branch 0 was taken 43340 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8732 times"> + </span><span class="branchCov" title="Branch 3 was taken 34608 times"> + </span>]:<span class="lineCov">      43340 :             if (!ExtractDestination(txout.scriptPubKey, address))</span></a>
<a name="114"><span class="lineNum">     114 </span>                :<span class="lineCov">       8732 :                 continue;</span></a>
<a name="115"><span class="lineNum">     115 </span>                :            : </a>
<a name="116"><span class="lineNum">     116 </span>  [<span class="branchCov" title="Branch 0 was taken 32744 times"> + </span><span class="branchCov" title="Branch 1 was taken 1864 times"> + </span><span class="branchCov" title="Branch 2 was taken 32744 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      34608 :             if (filtered_address &amp;&amp; !(filtered_address == address)) {</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 32433 times"> + </span><span class="branchCov" title="Branch 5 was taken 311 times"> + </span><span class="branchCov" title="Branch 6 was taken 32433 times"> + </span><span class="branchCov" title="Branch 7 was taken 2175 times"> + </span>]
<a name="117"><span class="lineNum">     117 </span>                :<span class="lineCov">      32433 :                 continue;</span></a>
<a name="118"><span class="lineNum">     118 </span>                :            :             }</a>
<a name="119"><span class="lineNum">     119 </span>                :            : </a>
<a name="120"><span class="lineNum">     120 </span>        [<span class="branchCov" title="Branch 0 was taken 2175 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2175 :             isminefilter mine = wallet.IsMine(address);</span></a>
<a name="121"><span class="lineNum">     121 </span>        [<span class="branchCov" title="Branch 0 was taken 120 times"> + </span><span class="branchCov" title="Branch 1 was taken 2055 times"> + </span>]:<span class="lineCov">       2175 :             if (!(mine &amp; filter))</span></a>
<a name="122"><span class="lineNum">     122 </span>                :<span class="lineCov">        120 :                 continue;</span></a>
<a name="123"><span class="lineNum">     123 </span>                :            : </a>
<a name="124"><span class="lineNum">     124 </span>        [<span class="branchCov" title="Branch 0 was taken 2055 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2055 :             tallyitem&amp; item = mapTally[address];</span></a>
<a name="125"><span class="lineNum">     125 </span>                :<span class="lineCov">       2055 :             item.nAmount += txout.nValue;</span></a>
<a name="126"><span class="lineNum">     126 </span>                :<span class="lineCov">       2055 :             item.nConf = std::min(item.nConf, nDepth);</span></a>
<a name="127"><span class="lineNum">     127 </span>        [<span class="branchCov" title="Branch 0 was taken 2055 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2055 :             item.txids.push_back(wtx.GetHash());</span></a>
<a name="128"><span class="lineNum">     128 </span>        [<span class="branchCov" title="Branch 0 was taken 202 times"> + </span><span class="branchCov" title="Branch 1 was taken 1853 times"> + </span>]:<span class="lineCov">       2055 :             if (mine &amp; ISMINE_WATCH_ONLY)</span></a>
<a name="129"><span class="lineNum">     129 </span>                :<span class="lineCov">        202 :                 item.fIsWatchonly = true;</span></a>
<a name="130"><span class="lineNum">     130 </span>                :            :         }</a>
<a name="131"><span class="lineNum">     131 </span>                :            :     }</a>
<a name="132"><span class="lineNum">     132 </span>                :            : </a>
<a name="133"><span class="lineNum">     133 </span>                :            :     // Reply</a>
<a name="134"><span class="lineNum">     134 </span>                :<span class="lineCov">        446 :     UniValue ret(UniValue::VARR);</span></a>
<a name="135"><span class="lineNum">     135 </span>                :<span class="lineCov">        892 :     std::map&lt;std::string, tallyitem&gt; label_tally;</span></a>
<a name="136"><span class="lineNum">     136 </span>                :            : </a>
<a name="137"><span class="lineNum">     137 </span>                :<span class="lineCov">        678 :     const auto&amp; func = [&amp;](const CTxDestination&amp; address, const std::string&amp; label, const std::string&amp; purpose, bool is_change) {</span></a>
<a name="138"><span class="lineNum">     138 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 678 times"> + </span>]:<span class="lineCov">        678 :         if (is_change) return; // no change addresses</span></a>
<a name="139"><span class="lineNum">     139 </span>                :            : </a>
<a name="140"><span class="lineNum">     140 </span>                :<span class="lineCov">        678 :         auto it = mapTally.find(address);</span></a>
<a name="141"><span class="lineNum">     141 </span>  [<span class="branchCov" title="Branch 0 was taken 325 times"> + </span><span class="branchCov" title="Branch 1 was taken 353 times"> + </span><span class="branchCov" title="Branch 2 was taken 293 times"> + </span><span class="branchCov" title="Branch 3 was taken 32 times"> + </span> :<span class="lineCov">        678 :         if (it == mapTally.end() &amp;&amp; !fIncludeEmpty)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 293 times"> + </span><span class="branchCov" title="Branch 5 was taken 385 times"> + </span>]
<a name="142"><span class="lineNum">     142 </span>                :<span class="lineCov">        293 :             return;</span></a>
<a name="143"><span class="lineNum">     143 </span>                :            : </a>
<a name="144"><span class="lineNum">     144 </span>                :<span class="lineCov">        385 :         CAmount nAmount = 0;</span></a>
<a name="145"><span class="lineNum">     145 </span>                :<span class="lineCov">        385 :         int nConf = std::numeric_limits&lt;int&gt;::max();</span></a>
<a name="146"><span class="lineNum">     146 </span>                :<span class="lineCov">        385 :         bool fIsWatchonly = false;</span></a>
<a name="147"><span class="lineNum">     147 </span>        [<span class="branchCov" title="Branch 0 was taken 353 times"> + </span><span class="branchCov" title="Branch 1 was taken 32 times"> + </span>]:<span class="lineCov">        385 :         if (it != mapTally.end()) {</span></a>
<a name="148"><span class="lineNum">     148 </span>                :<span class="lineCov">        353 :             nAmount = (*it).second.nAmount;</span></a>
<a name="149"><span class="lineNum">     149 </span>                :<span class="lineCov">        353 :             nConf = (*it).second.nConf;</span></a>
<a name="150"><span class="lineNum">     150 </span>                :<span class="lineCov">        353 :             fIsWatchonly = (*it).second.fIsWatchonly;</span></a>
<a name="151"><span class="lineNum">     151 </span>                :            :         }</a>
<a name="152"><span class="lineNum">     152 </span>                :            : </a>
<a name="153"><span class="lineNum">     153 </span>        [<span class="branchCov" title="Branch 0 was taken 60 times"> + </span><span class="branchCov" title="Branch 1 was taken 325 times"> + </span>]:<span class="lineCov">        385 :         if (by_label) {</span></a>
<a name="154"><span class="lineNum">     154 </span>                :<span class="lineCov">         60 :             tallyitem&amp; _item = label_tally[label];</span></a>
<a name="155"><span class="lineNum">     155 </span>                :<span class="lineCov">         60 :             _item.nAmount += nAmount;</span></a>
<a name="156"><span class="lineNum">     156 </span>                :<span class="lineCov">         60 :             _item.nConf = std::min(_item.nConf, nConf);</span></a>
<a name="157"><span class="lineNum">     157 </span>                :<span class="lineCov">         60 :             _item.fIsWatchonly = fIsWatchonly;</span></a>
<a name="158"><span class="lineNum">     158 </span>                :            :         } else {</a>
<a name="159"><span class="lineNum">     159 </span>                :<span class="lineCov">        650 :             UniValue obj(UniValue::VOBJ);</span></a>
<a name="160"><span class="lineNum">     160 </span>  [<span class="branchCov" title="Branch 0 was taken 164 times"> + </span><span class="branchCov" title="Branch 1 was taken 161 times"> + </span><span class="branchCov" title="Branch 2 was taken 164 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        489 :             if (fIsWatchonly) obj.pushKV(&quot;involvesWatchonly&quot;, true);</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 164 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 164 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="161"><span class="lineNum">     161 </span>  [<span class="branchCov" title="Branch 0 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        650 :             obj.pushKV(&quot;address&quot;,       EncodeDestination(address));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="162"><span class="lineNum">     162 </span>  [<span class="branchCov" title="Branch 0 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        650 :             obj.pushKV(&quot;amount&quot;,        ValueFromAmount(nAmount));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="163"><span class="lineNum">     163 </span>  [<span class="branchCov" title="Branch 0 was taken 303 times"> + </span><span class="branchCov" title="Branch 1 was taken 22 times"> + </span><span class="branchCov" title="Branch 2 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        650 :             obj.pushKV(&quot;confirmations&quot;, (nConf == std::numeric_limits&lt;int&gt;::max() ? 0 : nConf));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="164"><span class="lineNum">     164 </span>  [<span class="branchCov" title="Branch 0 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        650 :             obj.pushKV(&quot;label&quot;, label);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="165"><span class="lineNum">     165 </span>                :<span class="lineCov">        650 :             UniValue transactions(UniValue::VARR);</span></a>
<a name="166"><span class="lineNum">     166 </span>        [<span class="branchCov" title="Branch 0 was taken 303 times"> + </span><span class="branchCov" title="Branch 1 was taken 22 times"> + </span>]:<span class="lineCov">        325 :             if (it != mapTally.end()) {</span></a>
<a name="167"><span class="lineNum">     167 </span>        [<span class="branchCov" title="Branch 0 was taken 1263 times"> + </span><span class="branchCov" title="Branch 1 was taken 303 times"> + </span>]:<span class="lineCov">       1566 :                 for (const uint256&amp; _item : (*it).second.txids) {</span></a>
<a name="168"><span class="lineNum">     168 </span>  [<span class="branchCov" title="Branch 0 was taken 1263 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1263 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1263 :                     transactions.push_back(_item.GetHex());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1263 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="169"><span class="lineNum">     169 </span>                :            :                 }</a>
<a name="170"><span class="lineNum">     170 </span>                :            :             }</a>
<a name="171"><span class="lineNum">     171 </span>  [<span class="branchCov" title="Branch 0 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        650 :             obj.pushKV(&quot;txids&quot;, transactions);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="172"><span class="lineNum">     172 </span>  [<span class="branchCov" title="Branch 0 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 325 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        325 :             ret.push_back(obj);</span></a>
<a name="173"><span class="lineNum">     173 </span>                :            :         }</a>
<a name="174"><span class="lineNum">     174 </span>                :<span class="lineCov">        446 :     };</span></a>
<a name="175"><span class="lineNum">     175 </span>                :            : </a>
<a name="176"><span class="lineNum">     176 </span>        [<span class="branchCov" title="Branch 0 was taken 392 times"> + </span><span class="branchCov" title="Branch 1 was taken 54 times"> + </span>]:<span class="lineCov">        446 :     if (filtered_address) {</span></a>
<a name="177"><span class="lineNum">     177 </span>        [<span class="branchCov" title="Branch 0 was taken 392 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        392 :         const auto&amp; entry = wallet.FindAddressBookEntry(*filtered_address, /*allow_change=*/false);</span></a>
<a name="178"><span class="lineNum">     178 </span>  [<span class="branchCov" title="Branch 0 was taken 390 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchCov" title="Branch 2 was taken 390 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        392 :         if (entry) func(*filtered_address, entry-&gt;GetLabel(), entry-&gt;purpose, /*is_change=*/false);</span></a>
<a name="179"><span class="lineNum">     179 </span>                :            :     } else {</a>
<a name="180"><span class="lineNum">     180 </span>                :            :         // No filtered addr, walk-through the addressbook entry</a>
<a name="181"><span class="lineNum">     181 </span>  [<span class="branchCov" title="Branch 0 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         54 :         wallet.ForEachAddrBookEntry(func);</span></a>
<a name="182"><span class="lineNum">     182 </span>                :            :     }</a>
<a name="183"><span class="lineNum">     183 </span>                :            : </a>
<a name="184"><span class="lineNum">     184 </span>        [<span class="branchCov" title="Branch 0 was taken 22 times"> + </span><span class="branchCov" title="Branch 1 was taken 424 times"> + </span>]:<span class="lineCov">        446 :     if (by_label) {</span></a>
<a name="185"><span class="lineNum">     185 </span>        [<span class="branchCov" title="Branch 0 was taken 36 times"> + </span><span class="branchCov" title="Branch 1 was taken 22 times"> + </span>]:<span class="lineCov">         58 :         for (const auto&amp; entry : label_tally) {</span></a>
<a name="186"><span class="lineNum">     186 </span>                :<span class="lineCov">         36 :             CAmount nAmount = entry.second.nAmount;</span></a>
<a name="187"><span class="lineNum">     187 </span>                :<span class="lineCov">         36 :             int nConf = entry.second.nConf;</span></a>
<a name="188"><span class="lineNum">     188 </span>                :<span class="lineCov">         72 :             UniValue obj(UniValue::VOBJ);</span></a>
<a name="189"><span class="lineNum">     189 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 34 times"> + </span>]:<span class="lineCov">         36 :             if (entry.second.fIsWatchonly)</span></a>
<a name="190"><span class="lineNum">     190 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          4 :                 obj.pushKV(&quot;involvesWatchonly&quot;, true);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="191"><span class="lineNum">     191 </span>  [<span class="branchCov" title="Branch 0 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         72 :             obj.pushKV(&quot;amount&quot;,        ValueFromAmount(nAmount));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="192"><span class="lineNum">     192 </span>  [<span class="branchCov" title="Branch 0 was taken 34 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchCov" title="Branch 2 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         72 :             obj.pushKV(&quot;confirmations&quot;, (nConf == std::numeric_limits&lt;int&gt;::max() ? 0 : nConf));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="193"><span class="lineNum">     193 </span>  [<span class="branchCov" title="Branch 0 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         72 :             obj.pushKV(&quot;label&quot;,         entry.first);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="194"><span class="lineNum">     194 </span>  [<span class="branchCov" title="Branch 0 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         36 :             ret.push_back(obj);</span></a>
<a name="195"><span class="lineNum">     195 </span>                :            :         }</a>
<a name="196"><span class="lineNum">     196 </span>                :            :     }</a>
<a name="197"><span class="lineNum">     197 </span>                :            : </a>
<a name="198"><span class="lineNum">     198 </span>                :<span class="lineCov">        892 :     return ret;</span></a>
<a name="199"><span class="lineNum">     199 </span>                :            : }</a>
<a name="200"><span class="lineNum">     200 </span>                :            : </a>
<a name="201"><span class="lineNum">     201 </span>                :<span class="lineCov">       1388 : RPCHelpMan listreceivedbyaddress()</span></a>
<a name="202"><span class="lineNum">     202 </span>                :            : {</a>
<a name="203"><span class="lineNum">     203 </span>                :            :     return RPCHelpMan{&quot;listreceivedbyaddress&quot;,</a>
<a name="204"><span class="lineNum">     204 </span>                :            :                 &quot;\nList balances by receiving address.\n&quot;,</a>
<a name="205"><span class="lineNum">     205 </span>                :            :                 {</a>
<a name="206"><span class="lineNum">     206 </span>        [<span class="branchCov" title="Branch 0 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2776 :                     {&quot;minconf&quot;, RPCArg::Type::NUM, RPCArg::Default{1}, &quot;The minimum number of confirmations before payments are included.&quot;},</span></a>
<a name="207"><span class="lineNum">     207 </span>        [<span class="branchCov" title="Branch 0 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2776 :                     {&quot;include_empty&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Whether to include addresses that haven't received any payments.&quot;},</span></a>
<a name="208"><span class="lineNum">     208 </span>        [<span class="branchCov" title="Branch 0 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2776 :                     {&quot;include_watchonly&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;true for watch-only wallets, otherwise false&quot;}, &quot;Whether to include watch-only addresses (see 'importaddress')&quot;},</span></a>
<a name="209"><span class="lineNum">     209 </span>                :<span class="lineCov">       1388 :                     {&quot;address_filter&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;If present and non-empty, only return information on this address.&quot;},</span></a>
<a name="210"><span class="lineNum">     210 </span>        [<span class="branchCov" title="Branch 0 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2776 :                     {&quot;include_immature_coinbase&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Include immature coinbase transactions.&quot;},</span></a>
<a name="211"><span class="lineNum">     211 </span>                :            :                 },</a>
<a name="212"><span class="lineNum">     212 </span>                :<span class="lineCov">       1388 :                 RPCResult{</span></a>
<a name="213"><span class="lineNum">     213 </span>                :            :                     RPCResult::Type::ARR, &quot;&quot;, &quot;&quot;,</a>
<a name="214"><span class="lineNum">     214 </span>                :            :                     {</a>
<a name="215"><span class="lineNum">     215 </span>                :            :                         {RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="216"><span class="lineNum">     216 </span>                :            :                         {</a>
<a name="217"><span class="lineNum">     217 </span>                :            :                             {RPCResult::Type::BOOL, &quot;involvesWatchonly&quot;, /*optional=*/true, &quot;Only returns true if imported addresses were involved in transaction&quot;},</a>
<a name="218"><span class="lineNum">     218 </span>                :            :                             {RPCResult::Type::STR, &quot;address&quot;, &quot;The receiving address&quot;},</a>
<a name="219"><span class="lineNum">     219 </span>  [<span class="branchCov" title="Branch 0 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2776 :                             {RPCResult::Type::STR_AMOUNT, &quot;amount&quot;, &quot;The total amount in &quot; + CURRENCY_UNIT + &quot; received by the address&quot;},</span></a>
<a name="220"><span class="lineNum">     220 </span>                :            :                             {RPCResult::Type::NUM, &quot;confirmations&quot;, &quot;The number of confirmations of the most recent transaction included&quot;},</a>
<a name="221"><span class="lineNum">     221 </span>                :            :                             {RPCResult::Type::STR, &quot;label&quot;, &quot;The label of the receiving address. The default label is \&quot;\&quot;&quot;},</a>
<a name="222"><span class="lineNum">     222 </span>                :            :                             {RPCResult::Type::ARR, &quot;txids&quot;, &quot;&quot;,</a>
<a name="223"><span class="lineNum">     223 </span>                :            :                             {</a>
<a name="224"><span class="lineNum">     224 </span>                :            :                                 {RPCResult::Type::STR_HEX, &quot;txid&quot;, &quot;The ids of transactions received with the address&quot;},</a>
<a name="225"><span class="lineNum">     225 </span>                :            :                             }},</a>
<a name="226"><span class="lineNum">     226 </span>                :            :                         }},</a>
<a name="227"><span class="lineNum">     227 </span>                :            :                     }</a>
<a name="228"><span class="lineNum">     228 </span>  [<span class="branchCov" title="Branch 0 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      43028 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1388 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1388 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1388 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1388 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 1388 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 1388 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 59 was taken 1388 times"> + </span><span class="branchCov" title="Branch 60 was taken 8328 times"> + </span><span class="branchCov" title="Branch 61 was taken 1388 times"> + </span><span class="branchCov" title="Branch 62 was taken 1388 times"> + </span><span class="branchCov" title="Branch 63 was taken 1388 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 64 was not taken"> - </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchNoCov" title="Branch 66 was not taken"> - </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchNoCov" title="Branch 68 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 69 was not taken"> - </span>]
<a name="229"><span class="lineNum">     229 </span>                :<span class="lineCov">       1388 :                 RPCExamples{</span></a>
<a name="230"><span class="lineNum">     230 </span>  [<span class="branchCov" title="Branch 0 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4164 :                     HelpExampleCli(&quot;listreceivedbyaddress&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="231"><span class="lineNum">     231 </span>  [<span class="branchCov" title="Branch 0 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6940 :             + HelpExampleCli(&quot;listreceivedbyaddress&quot;, &quot;6 true&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="232"><span class="lineNum">     232 </span>  [<span class="branchCov" title="Branch 0 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6940 :             + HelpExampleCli(&quot;listreceivedbyaddress&quot;, &quot;6 true true \&quot;\&quot; true&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="233"><span class="lineNum">     233 </span>  [<span class="branchCov" title="Branch 0 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6940 :             + HelpExampleRpc(&quot;listreceivedbyaddress&quot;, &quot;6, true, true&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="234"><span class="lineNum">     234 </span>  [<span class="branchCov" title="Branch 0 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6940 :             + HelpExampleRpc(&quot;listreceivedbyaddress&quot;, &quot;6, true, true, \&quot;&quot; + EXAMPLE_ADDRESS[0] + &quot;\&quot;, true&quot;)</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1388 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="235"><span class="lineNum">     235 </span>                :<span class="lineCov">       1388 :                 },</span></a>
<a name="236"><span class="lineNum">     236 </span>                :<span class="lineCov">        426 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="237"><span class="lineNum">     237 </span>                :            : {</a>
<a name="238"><span class="lineNum">     238 </span>                :<span class="lineCov">        852 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="239"><span class="lineNum">     239 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 426 times"> + </span>]:<span class="lineCov">        426 :     if (!pwallet) return UniValue::VNULL;</span></a>
<a name="240"><span class="lineNum">     240 </span>                :            : </a>
<a name="241"><span class="lineNum">     241 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="242"><span class="lineNum">     242 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="243"><span class="lineNum">     243 </span>        [<span class="branchCov" title="Branch 0 was taken 426 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        426 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="244"><span class="lineNum">     244 </span>                :            : </a>
<a name="245"><span class="lineNum">     245 </span>  [<span class="branchCov" title="Branch 0 was taken 426 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 422 times"> + </span><span class="branchCov" title="Branch 3 was taken 4 times"> + </span> :<span class="lineCov">        426 :     const bool include_immature_coinbase{request.params[4].isNull() ? false : request.params[4].get_bool()};</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="246"><span class="lineNum">     246 </span>                :            : </a>
<a name="247"><span class="lineNum">     247 </span>        [<span class="branchCov" title="Branch 0 was taken 426 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        852 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="248"><span class="lineNum">     248 </span>                :            : </a>
<a name="249"><span class="lineNum">     249 </span>        [<span class="branchCov" title="Branch 0 was taken 424 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>]:<span class="lineCov">        426 :     return ListReceived(*pwallet, request.params, false, include_immature_coinbase);</span></a>
<a name="250"><span class="lineNum">     250 </span>                :            : },</a>
<a name="251"><span class="lineNum">     251 </span>  [<span class="branchCov" title="Branch 0 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      43028 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1388 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1388 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1388 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1388 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1388 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 6940 times"> + </span><span class="branchCov" title="Branch 43 was taken 1388 times"> + </span> 
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 44 was not taken"> - </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span>]
<a name="252"><span class="lineNum">     252 </span>                :            : }</a>
<a name="253"><span class="lineNum">     253 </span>                :            : </a>
<a name="254"><span class="lineNum">     254 </span>                :<span class="lineCov">        984 : RPCHelpMan listreceivedbylabel()</span></a>
<a name="255"><span class="lineNum">     255 </span>                :            : {</a>
<a name="256"><span class="lineNum">     256 </span>                :            :     return RPCHelpMan{&quot;listreceivedbylabel&quot;,</a>
<a name="257"><span class="lineNum">     257 </span>                :            :                 &quot;\nList received transactions by label.\n&quot;,</a>
<a name="258"><span class="lineNum">     258 </span>                :            :                 {</a>
<a name="259"><span class="lineNum">     259 </span>        [<span class="branchCov" title="Branch 0 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1968 :                     {&quot;minconf&quot;, RPCArg::Type::NUM, RPCArg::Default{1}, &quot;The minimum number of confirmations before payments are included.&quot;},</span></a>
<a name="260"><span class="lineNum">     260 </span>        [<span class="branchCov" title="Branch 0 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1968 :                     {&quot;include_empty&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Whether to include labels that haven't received any payments.&quot;},</span></a>
<a name="261"><span class="lineNum">     261 </span>        [<span class="branchCov" title="Branch 0 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1968 :                     {&quot;include_watchonly&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;true for watch-only wallets, otherwise false&quot;}, &quot;Whether to include watch-only addresses (see 'importaddress')&quot;},</span></a>
<a name="262"><span class="lineNum">     262 </span>        [<span class="branchCov" title="Branch 0 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1968 :                     {&quot;include_immature_coinbase&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Include immature coinbase transactions.&quot;},</span></a>
<a name="263"><span class="lineNum">     263 </span>                :            :                 },</a>
<a name="264"><span class="lineNum">     264 </span>                :<span class="lineCov">        984 :                 RPCResult{</span></a>
<a name="265"><span class="lineNum">     265 </span>                :            :                     RPCResult::Type::ARR, &quot;&quot;, &quot;&quot;,</a>
<a name="266"><span class="lineNum">     266 </span>                :            :                     {</a>
<a name="267"><span class="lineNum">     267 </span>                :            :                         {RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="268"><span class="lineNum">     268 </span>                :            :                         {</a>
<a name="269"><span class="lineNum">     269 </span>                :            :                             {RPCResult::Type::BOOL, &quot;involvesWatchonly&quot;, /*optional=*/true, &quot;Only returns true if imported addresses were involved in transaction&quot;},</a>
<a name="270"><span class="lineNum">     270 </span>                :            :                             {RPCResult::Type::STR_AMOUNT, &quot;amount&quot;, &quot;The total amount received by addresses with this label&quot;},</a>
<a name="271"><span class="lineNum">     271 </span>                :            :                             {RPCResult::Type::NUM, &quot;confirmations&quot;, &quot;The number of confirmations of the most recent transaction included&quot;},</a>
<a name="272"><span class="lineNum">     272 </span>                :            :                             {RPCResult::Type::STR, &quot;label&quot;, &quot;The label of the receiving address. The default label is \&quot;\&quot;&quot;},</a>
<a name="273"><span class="lineNum">     273 </span>                :            :                         }},</a>
<a name="274"><span class="lineNum">     274 </span>                :            :                     }</a>
<a name="275"><span class="lineNum">     275 </span>  [<span class="branchCov" title="Branch 0 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      19680 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 984 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 984 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 984 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 984 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 984 times"> + </span><span class="branchCov" title="Branch 41 was taken 984 times"> + </span><span class="branchCov" title="Branch 42 was taken 3936 times"> + </span><span class="branchCov" title="Branch 43 was taken 984 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 44 was not taken"> - </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchNoCov" title="Branch 46 was not taken"> - </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span>]
<a name="276"><span class="lineNum">     276 </span>                :<span class="lineCov">        984 :                 RPCExamples{</span></a>
<a name="277"><span class="lineNum">     277 </span>  [<span class="branchCov" title="Branch 0 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2952 :                     HelpExampleCli(&quot;listreceivedbylabel&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="278"><span class="lineNum">     278 </span>  [<span class="branchCov" title="Branch 0 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4920 :             + HelpExampleCli(&quot;listreceivedbylabel&quot;, &quot;6 true&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="279"><span class="lineNum">     279 </span>  [<span class="branchCov" title="Branch 0 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4920 :             + HelpExampleRpc(&quot;listreceivedbylabel&quot;, &quot;6, true, true, true&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="280"><span class="lineNum">     280 </span>                :<span class="lineCov">        984 :                 },</span></a>
<a name="281"><span class="lineNum">     281 </span>                :<span class="lineCov">         22 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="282"><span class="lineNum">     282 </span>                :            : {</a>
<a name="283"><span class="lineNum">     283 </span>                :<span class="lineCov">         44 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="284"><span class="lineNum">     284 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 22 times"> + </span>]:<span class="lineCov">         22 :     if (!pwallet) return UniValue::VNULL;</span></a>
<a name="285"><span class="lineNum">     285 </span>                :            : </a>
<a name="286"><span class="lineNum">     286 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="287"><span class="lineNum">     287 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="288"><span class="lineNum">     288 </span>        [<span class="branchCov" title="Branch 0 was taken 22 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         22 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="289"><span class="lineNum">     289 </span>                :            : </a>
<a name="290"><span class="lineNum">     290 </span>  [<span class="branchCov" title="Branch 0 was taken 22 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 18 times"> + </span><span class="branchCov" title="Branch 3 was taken 4 times"> + </span> :<span class="lineCov">         22 :     const bool include_immature_coinbase{request.params[3].isNull() ? false : request.params[3].get_bool()};</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="291"><span class="lineNum">     291 </span>                :            : </a>
<a name="292"><span class="lineNum">     292 </span>        [<span class="branchCov" title="Branch 0 was taken 22 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         44 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="293"><span class="lineNum">     293 </span>                :            : </a>
<a name="294"><span class="lineNum">     294 </span>        [<span class="branchCov" title="Branch 0 was taken 22 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         22 :     return ListReceived(*pwallet, request.params, true, include_immature_coinbase);</span></a>
<a name="295"><span class="lineNum">     295 </span>                :            : },</a>
<a name="296"><span class="lineNum">     296 </span>  [<span class="branchCov" title="Branch 0 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      27552 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 984 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 984 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 984 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 3936 times"> + </span><span class="branchCov" title="Branch 37 was taken 984 times"> + </span><span class="branchNoCov" title="Branch 38 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 39 was not taken"> - </span>]
<a name="297"><span class="lineNum">     297 </span>                :            : }</a>
<a name="298"><span class="lineNum">     298 </span>                :            : </a>
<a name="299"><span class="lineNum">     299 </span>                :<span class="lineCov">       3899 : static void MaybePushAddress(UniValue &amp; entry, const CTxDestination &amp;dest)</span></a>
<a name="300"><span class="lineNum">     300 </span>                :            : {</a>
<a name="301"><span class="lineNum">     301 </span>        [<span class="branchCov" title="Branch 0 was taken 3893 times"> + </span><span class="branchCov" title="Branch 1 was taken 6 times"> + </span>]:<span class="lineCov">       3899 :     if (IsValidDestination(dest)) {</span></a>
<a name="302"><span class="lineNum">     302 </span>  [<span class="branchCov" title="Branch 0 was taken 3893 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 3893 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7786 :         entry.pushKV(&quot;address&quot;, EncodeDestination(dest));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 3893 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="303"><span class="lineNum">     303 </span>                :            :     }</a>
<a name="304"><span class="lineNum">     304 </span>                :<span class="lineCov">       3899 : }</span></a>
<a name="305"><span class="lineNum">     305 </span>                :            : </a>
<a name="306"><span class="lineNum">     306 </span>                :            : /**</a>
<a name="307"><span class="lineNum">     307 </span>                :            :  * List transactions based on the given criteria.</a>
<a name="308"><span class="lineNum">     308 </span>                :            :  *</a>
<a name="309"><span class="lineNum">     309 </span>                :            :  * @param  wallet         The wallet.</a>
<a name="310"><span class="lineNum">     310 </span>                :            :  * @param  wtx            The wallet transaction.</a>
<a name="311"><span class="lineNum">     311 </span>                :            :  * @param  nMinDepth      The minimum confirmation depth.</a>
<a name="312"><span class="lineNum">     312 </span>                :            :  * @param  fLong          Whether to include the JSON version of the transaction.</a>
<a name="313"><span class="lineNum">     313 </span>                :            :  * @param  ret            The vector into which the result is stored.</a>
<a name="314"><span class="lineNum">     314 </span>                :            :  * @param  filter_ismine  The &quot;is mine&quot; filter flags.</a>
<a name="315"><span class="lineNum">     315 </span>                :            :  * @param  filter_label   Optional label string to filter incoming transactions.</a>
<a name="316"><span class="lineNum">     316 </span>                :            :  */</a>
<a name="317"><span class="lineNum">     317 </span>                :            : template &lt;class Vec&gt;</a>
<a name="318"><span class="lineNum">     318 </span>                :<span class="lineCov">      23088 : static void ListTransactions(const CWallet&amp; wallet, const CWalletTx&amp; wtx, int nMinDepth, bool fLong,</span></a>
<a name="319"><span class="lineNum">     319 </span>                :            :                              Vec&amp; ret, const isminefilter&amp; filter_ismine, const std::optional&lt;std::string&gt;&amp; filter_label,</a>
<a name="320"><span class="lineNum">     320 </span>                :            :                              bool include_change = false)</a>
<a name="321"><span class="lineNum">     321 </span>                :            :     EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet)</a>
<a name="322"><span class="lineNum">     322 </span>                :            : {</a>
<a name="323"><span class="lineNum">     323 </span>                :            :     CAmount nFee;</a>
<a name="324"><span class="lineNum">     324 </span>                :<span class="lineCov">      46176 :     std::list&lt;COutputEntry&gt; listReceived;</span></a>
<a name="325"><span class="lineNum">     325 </span>                :<span class="lineCov">      46176 :     std::list&lt;COutputEntry&gt; listSent;</span></a>
<a name="326"><span class="lineNum">     326 </span>                :            : </a>
<a name="327"><span class="lineNum">     327 </span>        [<span class="branchCov" title="Branch 0 was taken 23088 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      23088 :     CachedTxGetAmounts(wallet, wtx, listReceived, listSent, nFee, filter_ismine, include_change);</span></a>
<a name="328"><span class="lineNum">     328 </span>                :            : </a>
<a name="329"><span class="lineNum">     329 </span>        [<span class="branchCov" title="Branch 0 was taken 23088 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      23088 :     bool involvesWatchonly = CachedTxIsFromMe(wallet, wtx, ISMINE_WATCH_ONLY);</span></a>
<a name="330"><span class="lineNum">     330 </span>                :            : </a>
<a name="331"><span class="lineNum">     331 </span>                :            :     // Sent</a>
<a name="332"><span class="lineNum">     332 </span>        [<span class="branchCov" title="Branch 0 was taken 3250 times"> + </span><span class="branchCov" title="Branch 1 was taken 19838 times"> + </span>]:<span class="lineCov">      23088 :     if (!filter_label.has_value())</span></a>
<a name="333"><span class="lineNum">     333 </span>                :            :     {</a>
<a name="334"><span class="lineNum">     334 </span>        [<span class="branchCov" title="Branch 0 was taken 916 times"> + </span><span class="branchCov" title="Branch 1 was taken 3250 times"> + </span>]:<span class="lineCov">       4166 :         for (const COutputEntry&amp; s : listSent)</span></a>
<a name="335"><span class="lineNum">     335 </span>                :            :         {</a>
<a name="336"><span class="lineNum">     336 </span>                :<span class="lineCov">       1832 :             UniValue entry(UniValue::VOBJ);</span></a>
<a name="337"><span class="lineNum">     337 </span>  [<span class="branchCov" title="Branch 0 was taken 914 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchCov" title="Branch 2 was taken 914 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        916 :             if (involvesWatchonly || (wallet.IsMine(s.destination) &amp; ISMINE_WATCH_ONLY)) {</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 8 times"> + </span><span class="branchCov" title="Branch 5 was taken 906 times"> + </span><span class="branchCov" title="Branch 6 was taken 10 times"> + </span><span class="branchCov" title="Branch 7 was taken 906 times"> + </span>]
<a name="338"><span class="lineNum">     338 </span>  [<span class="branchCov" title="Branch 0 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         20 :                 entry.pushKV(&quot;involvesWatchonly&quot;, true);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="339"><span class="lineNum">     339 </span>                :            :             }</a>
<a name="340"><span class="lineNum">     340 </span>        [<span class="branchCov" title="Branch 0 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        916 :             MaybePushAddress(entry, s.destination);</span></a>
<a name="341"><span class="lineNum">     341 </span>  [<span class="branchCov" title="Branch 0 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1832 :             entry.pushKV(&quot;category&quot;, &quot;send&quot;);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="342"><span class="lineNum">     342 </span>  [<span class="branchCov" title="Branch 0 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1832 :             entry.pushKV(&quot;amount&quot;, ValueFromAmount(-s.amount));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="343"><span class="lineNum">     343 </span>        [<span class="branchCov" title="Branch 0 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        916 :             const auto* address_book_entry = wallet.FindAddressBookEntry(s.destination);</span></a>
<a name="344"><span class="lineNum">     344 </span>        [<span class="branchCov" title="Branch 0 was taken 264 times"> + </span><span class="branchCov" title="Branch 1 was taken 652 times"> + </span>]:<span class="lineCov">        916 :             if (address_book_entry) {</span></a>
<a name="345"><span class="lineNum">     345 </span>  [<span class="branchCov" title="Branch 0 was taken 264 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 264 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        528 :                 entry.pushKV(&quot;label&quot;, address_book_entry-&gt;GetLabel());</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 264 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="346"><span class="lineNum">     346 </span>                :            :             }</a>
<a name="347"><span class="lineNum">     347 </span>  [<span class="branchCov" title="Branch 0 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1832 :             entry.pushKV(&quot;vout&quot;, s.vout);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="348"><span class="lineNum">     348 </span>  [<span class="branchCov" title="Branch 0 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1832 :             entry.pushKV(&quot;fee&quot;, ValueFromAmount(-nFee));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="349"><span class="lineNum">     349 </span>        [<span class="branchCov" title="Branch 0 was taken 405 times"> + </span><span class="branchCov" title="Branch 1 was taken 511 times"> + </span>]:<span class="lineCov">        916 :             if (fLong)</span></a>
<a name="350"><span class="lineNum">     350 </span>        [<span class="branchCov" title="Branch 0 was taken 405 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        405 :                 WalletTxToJSON(wallet, wtx, entry);</span></a>
<a name="351"><span class="lineNum">     351 </span>  [<span class="branchCov" title="Branch 0 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1832 :             entry.pushKV(&quot;abandoned&quot;, wtx.isAbandoned());</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="352"><span class="lineNum">     352 </span>  [<span class="branchCov" title="Branch 0 was taken 916 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 558 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        916 :             ret.push_back(entry);</span></a>
<a name="353"><span class="lineNum">     353 </span>                :            :         }</a>
<a name="354"><span class="lineNum">     354 </span>                :            :     }</a>
<a name="355"><span class="lineNum">     355 </span>                :            : </a>
<a name="356"><span class="lineNum">     356 </span>                :            :     // Received</a>
<a name="357"><span class="lineNum">     357 </span>  [<span class="branchCov" title="Branch 0 was taken 22487 times"> + </span><span class="branchCov" title="Branch 1 was taken 601 times"> + </span><span class="branchCov" title="Branch 2 was taken 22487 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      23088 :     if (listReceived.size() &gt; 0 &amp;&amp; wallet.GetTxDepthInMainChain(wtx) &gt;= nMinDepth) {</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 22456 times"> + </span><span class="branchCov" title="Branch 5 was taken 31 times"> + </span><span class="branchCov" title="Branch 6 was taken 22456 times"> + </span><span class="branchCov" title="Branch 7 was taken 632 times"> + </span>]
<a name="358"><span class="lineNum">     358 </span>        [<span class="branchCov" title="Branch 0 was taken 22506 times"> + </span><span class="branchCov" title="Branch 1 was taken 22456 times"> + </span>]:<span class="lineCov">      44962 :         for (const COutputEntry&amp; r : listReceived)</span></a>
<a name="359"><span class="lineNum">     359 </span>                :            :         {</a>
<a name="360"><span class="lineNum">     360 </span>                :<span class="lineCov">      22506 :             std::string label;</span></a>
<a name="361"><span class="lineNum">     361 </span>        [<span class="branchCov" title="Branch 0 was taken 22506 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      22506 :             const auto* address_book_entry = wallet.FindAddressBookEntry(r.destination);</span></a>
<a name="362"><span class="lineNum">     362 </span>        [<span class="branchCov" title="Branch 0 was taken 22334 times"> + </span><span class="branchCov" title="Branch 1 was taken 172 times"> + </span>]:<span class="lineCov">      22506 :             if (address_book_entry) {</span></a>
<a name="363"><span class="lineNum">     363 </span>        [<span class="branchCov" title="Branch 0 was taken 22334 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      22334 :                 label = address_book_entry-&gt;GetLabel();</span></a>
<a name="364"><span class="lineNum">     364 </span>                :            :             }</a>
<a name="365"><span class="lineNum">     365 </span>  [<span class="branchCov" title="Branch 0 was taken 19829 times"> + </span><span class="branchCov" title="Branch 1 was taken 2677 times"> + </span><span class="branchCov" title="Branch 2 was taken 19829 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      22506 :             if (filter_label.has_value() &amp;&amp; label != filter_label.value()) {</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 19523 times"> + </span><span class="branchCov" title="Branch 5 was taken 306 times"> + </span><span class="branchCov" title="Branch 6 was taken 19523 times"> + </span><span class="branchCov" title="Branch 7 was taken 2983 times"> + </span>]
<a name="366"><span class="lineNum">     366 </span>                :<span class="lineCov">      19523 :                 continue;</span></a>
<a name="367"><span class="lineNum">     367 </span>                :            :             }</a>
<a name="368"><span class="lineNum">     368 </span>                :<span class="lineCov">       5966 :             UniValue entry(UniValue::VOBJ);</span></a>
<a name="369"><span class="lineNum">     369 </span>  [<span class="branchCov" title="Branch 0 was taken 2983 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2983 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2983 :             if (involvesWatchonly || (wallet.IsMine(r.destination) &amp; ISMINE_WATCH_ONLY)) {</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 232 times"> + </span><span class="branchCov" title="Branch 5 was taken 2751 times"> + </span><span class="branchCov" title="Branch 6 was taken 232 times"> + </span><span class="branchCov" title="Branch 7 was taken 2751 times"> + </span>]
<a name="370"><span class="lineNum">     370 </span>  [<span class="branchCov" title="Branch 0 was taken 232 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 232 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        464 :                 entry.pushKV(&quot;involvesWatchonly&quot;, true);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 232 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="371"><span class="lineNum">     371 </span>                :            :             }</a>
<a name="372"><span class="lineNum">     372 </span>        [<span class="branchCov" title="Branch 0 was taken 2983 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2983 :             MaybePushAddress(entry, r.destination);</span></a>
<a name="373"><span class="lineNum">     373 </span>  [<span class="branchCov" title="Branch 0 was taken 2983 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2983 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2983 :             PushParentDescriptors(wallet, wtx.tx-&gt;vout.at(r.vout).scriptPubKey, entry);</span></a>
<a name="374"><span class="lineNum">     374 </span>  [<span class="branchCov" title="Branch 0 was taken 2983 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1913 times"> + </span><span class="branchCov" title="Branch 3 was taken 1070 times"> + </span>]:<span class="lineCov">       2983 :             if (wtx.IsCoinBase())</span></a>
<a name="375"><span class="lineNum">     375 </span>                :            :             {</a>
<a name="376"><span class="lineNum">     376 </span>  [<span class="branchCov" title="Branch 0 was taken 1913 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 406 times"> + </span><span class="branchCov" title="Branch 3 was taken 1507 times"> + </span>]:<span class="lineCov">       1913 :                 if (wallet.GetTxDepthInMainChain(wtx) &lt; 1)</span></a>
<a name="377"><span class="lineNum">     377 </span>  [<span class="branchCov" title="Branch 0 was taken 406 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 406 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        812 :                     entry.pushKV(&quot;category&quot;, &quot;orphan&quot;);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 406 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="378"><span class="lineNum">     378 </span>  [<span class="branchCov" title="Branch 0 was taken 1507 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1218 times"> + </span><span class="branchCov" title="Branch 3 was taken 289 times"> + </span>]:<span class="lineCov">       1507 :                 else if (wallet.IsTxImmatureCoinBase(wtx))</span></a>
<a name="379"><span class="lineNum">     379 </span>  [<span class="branchCov" title="Branch 0 was taken 1218 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1218 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2436 :                     entry.pushKV(&quot;category&quot;, &quot;immature&quot;);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1218 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="380"><span class="lineNum">     380 </span>                :            :                 else</a>
<a name="381"><span class="lineNum">     381 </span>  [<span class="branchCov" title="Branch 0 was taken 289 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 289 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        578 :                     entry.pushKV(&quot;category&quot;, &quot;generate&quot;);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 289 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="382"><span class="lineNum">     382 </span>                :            :             }</a>
<a name="383"><span class="lineNum">     383 </span>                :            :             else</a>
<a name="384"><span class="lineNum">     384 </span>                :            :             {</a>
<a name="385"><span class="lineNum">     385 </span>  [<span class="branchCov" title="Branch 0 was taken 1070 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1070 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2140 :                 entry.pushKV(&quot;category&quot;, &quot;receive&quot;);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1070 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="386"><span class="lineNum">     386 </span>                :            :             }</a>
<a name="387"><span class="lineNum">     387 </span>  [<span class="branchCov" title="Branch 0 was taken 2983 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2983 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5966 :             entry.pushKV(&quot;amount&quot;, ValueFromAmount(r.amount));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2983 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="388"><span class="lineNum">     388 </span>        [<span class="branchCov" title="Branch 0 was taken 2811 times"> + </span><span class="branchCov" title="Branch 1 was taken 172 times"> + </span>]:<span class="lineCov">       2983 :             if (address_book_entry) {</span></a>
<a name="389"><span class="lineNum">     389 </span>  [<span class="branchCov" title="Branch 0 was taken 2811 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2811 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5622 :                 entry.pushKV(&quot;label&quot;, label);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2811 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="390"><span class="lineNum">     390 </span>                :            :             }</a>
<a name="391"><span class="lineNum">     391 </span>  [<span class="branchCov" title="Branch 0 was taken 2983 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2983 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5966 :             entry.pushKV(&quot;vout&quot;, r.vout);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2983 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="392"><span class="lineNum">     392 </span>        [<span class="branchCov" title="Branch 0 was taken 2798 times"> + </span><span class="branchCov" title="Branch 1 was taken 185 times"> + </span>]:<span class="lineCov">       2983 :             if (fLong)</span></a>
<a name="393"><span class="lineNum">     393 </span>        [<span class="branchCov" title="Branch 0 was taken 2798 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2798 :                 WalletTxToJSON(wallet, wtx, entry);</span></a>
<a name="394"><span class="lineNum">     394 </span>  [<span class="branchCov" title="Branch 0 was taken 2983 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1162 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       2983 :             ret.push_back(entry);</span></a>
<a name="395"><span class="lineNum">     395 </span>                :            :         }</a>
<a name="396"><span class="lineNum">     396 </span>                :            :     }</a>
<a name="397"><span class="lineNum">     397 </span>                :<span class="lineCov">      23088 : }</span></a>
<a name="398"><span class="lineNum">     398 </span>                :            : </a>
<a name="399"><span class="lineNum">     399 </span>                :            : </a>
<a name="400"><span class="lineNum">     400 </span>                :<span class="lineCov">       4031 : static const std::vector&lt;RPCResult&gt; TransactionDescriptionString()</span></a>
<a name="401"><span class="lineNum">     401 </span>                :            : {</a>
<a name="402"><span class="lineNum">     402 </span>                :            :     return{{RPCResult::Type::NUM, &quot;confirmations&quot;, &quot;The number of confirmations for the transaction. Negative confirmations means the\n&quot;</a>
<a name="403"><span class="lineNum">     403 </span>                :            :                &quot;transaction conflicted that many blocks ago.&quot;},</a>
<a name="404"><span class="lineNum">     404 </span>                :            :            {RPCResult::Type::BOOL, &quot;generated&quot;, /*optional=*/true, &quot;Only present if the transaction's only input is a coinbase one.&quot;},</a>
<a name="405"><span class="lineNum">     405 </span>                :            :            {RPCResult::Type::BOOL, &quot;trusted&quot;, /*optional=*/true, &quot;Whether we consider the transaction to be trusted and safe to spend from.\n&quot;</a>
<a name="406"><span class="lineNum">     406 </span>                :            :                 &quot;Only present when the transaction has 0 confirmations (or negative confirmations, if conflicted).&quot;},</a>
<a name="407"><span class="lineNum">     407 </span>                :            :            {RPCResult::Type::STR_HEX, &quot;blockhash&quot;, /*optional=*/true, &quot;The block hash containing the transaction.&quot;},</a>
<a name="408"><span class="lineNum">     408 </span>                :            :            {RPCResult::Type::NUM, &quot;blockheight&quot;, /*optional=*/true, &quot;The block height containing the transaction.&quot;},</a>
<a name="409"><span class="lineNum">     409 </span>                :            :            {RPCResult::Type::NUM, &quot;blockindex&quot;, /*optional=*/true, &quot;The index of the transaction in the block that includes it.&quot;},</a>
<a name="410"><span class="lineNum">     410 </span>  [<span class="branchCov" title="Branch 0 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       8062 :            {RPCResult::Type::NUM_TIME, &quot;blocktime&quot;, /*optional=*/true, &quot;The block time expressed in &quot; + UNIX_EPOCH_TIME + &quot;.&quot;},</span></a>
<a name="411"><span class="lineNum">     411 </span>                :            :            {RPCResult::Type::STR_HEX, &quot;txid&quot;, &quot;The transaction id.&quot;},</a>
<a name="412"><span class="lineNum">     412 </span>                :            :            {RPCResult::Type::STR_HEX, &quot;wtxid&quot;, &quot;The hash of serialized transaction, including witness data.&quot;},</a>
<a name="413"><span class="lineNum">     413 </span>                :            :            {RPCResult::Type::ARR, &quot;walletconflicts&quot;, &quot;Conflicting transaction ids.&quot;,</a>
<a name="414"><span class="lineNum">     414 </span>                :            :            {</a>
<a name="415"><span class="lineNum">     415 </span>                :            :                {RPCResult::Type::STR_HEX, &quot;txid&quot;, &quot;The transaction id.&quot;},</a>
<a name="416"><span class="lineNum">     416 </span>                :            :            }},</a>
<a name="417"><span class="lineNum">     417 </span>                :            :            {RPCResult::Type::STR_HEX, &quot;replaced_by_txid&quot;, /*optional=*/true, &quot;The txid if this tx was replaced.&quot;},</a>
<a name="418"><span class="lineNum">     418 </span>                :            :            {RPCResult::Type::STR_HEX, &quot;replaces_txid&quot;, /*optional=*/true, &quot;The txid if the tx replaces one.&quot;},</a>
<a name="419"><span class="lineNum">     419 </span>                :            :            {RPCResult::Type::STR, &quot;comment&quot;, /*optional=*/true, &quot;&quot;},</a>
<a name="420"><span class="lineNum">     420 </span>                :            :            {RPCResult::Type::STR, &quot;to&quot;, /*optional=*/true, &quot;If a comment to is associated with the transaction.&quot;},</a>
<a name="421"><span class="lineNum">     421 </span>  [<span class="branchCov" title="Branch 0 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       8062 :            {RPCResult::Type::NUM_TIME, &quot;time&quot;, &quot;The transaction time expressed in &quot; + UNIX_EPOCH_TIME + &quot;.&quot;},</span></a>
<a name="422"><span class="lineNum">     422 </span>  [<span class="branchCov" title="Branch 0 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       8062 :            {RPCResult::Type::NUM_TIME, &quot;timereceived&quot;, &quot;The time received expressed in &quot; + UNIX_EPOCH_TIME + &quot;.&quot;},</span></a>
<a name="423"><span class="lineNum">     423 </span>                :            :            {RPCResult::Type::STR, &quot;comment&quot;, /*optional=*/true, &quot;If a comment is associated with the transaction, only present if not empty.&quot;},</a>
<a name="424"><span class="lineNum">     424 </span>                :            :            {RPCResult::Type::STR, &quot;bip125-replaceable&quot;, &quot;(\&quot;yes|no|unknown\&quot;) Whether this transaction signals BIP125 replaceability or has an unconfirmed ancestor signaling BIP125 replaceability.\n&quot;</a>
<a name="425"><span class="lineNum">     425 </span>                :            :                &quot;May be unknown for unconfirmed transactions not in the mempool because their unconfirmed ancestors are unknown.&quot;},</a>
<a name="426"><span class="lineNum">     426 </span>                :            :            {RPCResult::Type::ARR, &quot;parent_descs&quot;, /*optional=*/true, &quot;Only if 'category' is 'received'. List of parent descriptors for the scriptPubKey of this coin.&quot;, {</a>
<a name="427"><span class="lineNum">     427 </span>                :            :                {RPCResult::Type::STR, &quot;desc&quot;, &quot;The descriptor string.&quot;},</a>
<a name="428"><span class="lineNum">     428 </span>                :            :            }},</a>
<a name="429"><span class="lineNum">     429 </span>  [<span class="branchCov" title="Branch 0 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">     282170 :            };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 4031 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 4031 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 4031 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 4031 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 4031 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 4031 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 4031 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 4031 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 85 was not taken"> - </span><span class="branchCov" title="Branch 86 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 87 was not taken"> - </span><span class="branchCov" title="Branch 88 was taken 4031 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span><span class="branchCov" title="Branch 90 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 91 was not taken"> - </span><span class="branchCov" title="Branch 92 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 93 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 94 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span><span class="branchCov" title="Branch 96 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 97 was not taken"> - </span><span class="branchCov" title="Branch 98 was taken 4031 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 99 was not taken"> - </span><span class="branchCov" title="Branch 100 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 101 was not taken"> - </span><span class="branchCov" title="Branch 102 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 103 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 104 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 105 was not taken"> - </span><span class="branchCov" title="Branch 106 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 107 was not taken"> - </span><span class="branchCov" title="Branch 108 was taken 4031 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 109 was not taken"> - </span><span class="branchCov" title="Branch 110 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 111 was not taken"> - </span><span class="branchCov" title="Branch 112 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 113 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 114 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 115 was not taken"> - </span><span class="branchCov" title="Branch 116 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 117 was not taken"> - </span><span class="branchCov" title="Branch 118 was taken 4031 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 119 was not taken"> - </span><span class="branchCov" title="Branch 120 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 121 was not taken"> - </span><span class="branchCov" title="Branch 122 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 123 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 124 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 125 was not taken"> - </span><span class="branchCov" title="Branch 126 was taken 76589 times"> + </span><span class="branchCov" title="Branch 127 was taken 4031 times"> + </span><span class="branchCov" title="Branch 128 was taken 4031 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 129 was taken 4031 times"> + </span><span class="branchCov" title="Branch 130 was taken 4031 times"> + </span><span class="branchCov" title="Branch 131 was taken 4031 times"> + </span><span class="branchNoCov" title="Branch 132 was not taken"> - </span><span class="branchNoCov" title="Branch 133 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 134 was not taken"> - </span><span class="branchNoCov" title="Branch 135 was not taken"> - </span><span class="branchNoCov" title="Branch 136 was not taken"> - </span><span class="branchNoCov" title="Branch 137 was not taken"> - </span>]
<a name="430"><span class="lineNum">     430 </span>                :            : }</a>
<a name="431"><span class="lineNum">     431 </span>                :            : </a>
<a name="432"><span class="lineNum">     432 </span>                :<span class="lineCov">       1488 : RPCHelpMan listtransactions()</span></a>
<a name="433"><span class="lineNum">     433 </span>                :            : {</a>
<a name="434"><span class="lineNum">     434 </span>                :            :     return RPCHelpMan{&quot;listtransactions&quot;,</a>
<a name="435"><span class="lineNum">     435 </span>                :            :                 &quot;\nIf a label name is provided, this will return only incoming transactions paying to addresses with the specified label.\n&quot;</a>
<a name="436"><span class="lineNum">     436 </span>                :            :                 &quot;\nReturns up to 'count' most recent transactions skipping the first 'from' transactions.\n&quot;,</a>
<a name="437"><span class="lineNum">     437 </span>                :            :                 {</a>
<a name="438"><span class="lineNum">     438 </span>                :<span class="lineCov">       1488 :                     {&quot;label|dummy&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;If set, should be a valid label name to return only incoming transactions\n&quot;</span></a>
<a name="439"><span class="lineNum">     439 </span>                :            :                           &quot;with the specified label, or \&quot;*\&quot; to disable filtering and return all transactions.&quot;},</a>
<a name="440"><span class="lineNum">     440 </span>        [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2976 :                     {&quot;count&quot;, RPCArg::Type::NUM, RPCArg::Default{10}, &quot;The number of transactions to return&quot;},</span></a>
<a name="441"><span class="lineNum">     441 </span>        [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2976 :                     {&quot;skip&quot;, RPCArg::Type::NUM, RPCArg::Default{0}, &quot;The number of transactions to skip&quot;},</span></a>
<a name="442"><span class="lineNum">     442 </span>        [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2976 :                     {&quot;include_watchonly&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;true for watch-only wallets, otherwise false&quot;}, &quot;Include transactions to watch-only addresses (see 'importaddress')&quot;},</span></a>
<a name="443"><span class="lineNum">     443 </span>                :            :                 },</a>
<a name="444"><span class="lineNum">     444 </span>                :<span class="lineCov">       1488 :                 RPCResult{</span></a>
<a name="445"><span class="lineNum">     445 </span>                :            :                     RPCResult::Type::ARR, &quot;&quot;, &quot;&quot;,</a>
<a name="446"><span class="lineNum">     446 </span>                :            :                     {</a>
<a name="447"><span class="lineNum">     447 </span>                :<span class="lineCov">       1488 :                         {RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;, Cat(Cat&lt;std::vector&lt;RPCResult&gt;&gt;(</span></a>
<a name="448"><span class="lineNum">     448 </span>                :            :                         {</a>
<a name="449"><span class="lineNum">     449 </span>                :            :                             {RPCResult::Type::BOOL, &quot;involvesWatchonly&quot;, /*optional=*/true, &quot;Only returns true if imported addresses were involved in transaction.&quot;},</a>
<a name="450"><span class="lineNum">     450 </span>                :            :                             {RPCResult::Type::STR, &quot;address&quot;,  /*optional=*/true, &quot;The bitcoin address of the transaction (not returned if the output does not have an address, e.g. OP_RETURN null data).&quot;},</a>
<a name="451"><span class="lineNum">     451 </span>                :            :                             {RPCResult::Type::STR, &quot;category&quot;, &quot;The transaction category.\n&quot;</a>
<a name="452"><span class="lineNum">     452 </span>                :            :                                 &quot;\&quot;send\&quot;                  Transactions sent.\n&quot;</a>
<a name="453"><span class="lineNum">     453 </span>                :            :                                 &quot;\&quot;receive\&quot;               Non-coinbase transactions received.\n&quot;</a>
<a name="454"><span class="lineNum">     454 </span>                :            :                                 &quot;\&quot;generate\&quot;              Coinbase transactions received with more than 100 confirmations.\n&quot;</a>
<a name="455"><span class="lineNum">     455 </span>                :            :                                 &quot;\&quot;immature\&quot;              Coinbase transactions received with 100 or fewer confirmations.\n&quot;</a>
<a name="456"><span class="lineNum">     456 </span>                :            :                                 &quot;\&quot;orphan\&quot;                Orphaned coinbase transactions received.&quot;},</a>
<a name="457"><span class="lineNum">     457 </span>        [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2976 :                             {RPCResult::Type::STR_AMOUNT, &quot;amount&quot;, &quot;The amount in &quot; + CURRENCY_UNIT + &quot;. This is negative for the 'send' category, and is positive\n&quot;</span></a>
<a name="458"><span class="lineNum">     458 </span>        [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1488 :                                 &quot;for all other categories&quot;},</span></a>
<a name="459"><span class="lineNum">     459 </span>                :            :                             {RPCResult::Type::STR, &quot;label&quot;, /*optional=*/true, &quot;A comment for the address/transaction, if any&quot;},</a>
<a name="460"><span class="lineNum">     460 </span>                :            :                             {RPCResult::Type::NUM, &quot;vout&quot;, &quot;the vout value&quot;},</a>
<a name="461"><span class="lineNum">     461 </span>        [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2976 :                             {RPCResult::Type::STR_AMOUNT, &quot;fee&quot;, /*optional=*/true, &quot;The amount of the fee in &quot; + CURRENCY_UNIT + &quot;. This is negative and only available for the\n&quot;</span></a>
<a name="462"><span class="lineNum">     462 </span>        [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1488 :                                  &quot;'send' category of transactions.&quot;},</span></a>
<a name="463"><span class="lineNum">     463 </span>                :            :                         },</a>
<a name="464"><span class="lineNum">     464 </span>  [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      38688 :                         TransactionDescriptionString()),</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1488 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1488 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1488 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1488 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 44 was taken 10416 times"> + </span><span class="branchCov" title="Branch 45 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 46 was not taken"> - </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span>]
<a name="465"><span class="lineNum">     465 </span>                :            :                         {</a>
<a name="466"><span class="lineNum">     466 </span>                :            :                             {RPCResult::Type::BOOL, &quot;abandoned&quot;, /*optional=*/true, &quot;'true' if the transaction has been abandoned (inputs are respendable). Only available for the \n&quot;</a>
<a name="467"><span class="lineNum">     467 </span>                :            :                                  &quot;'send' category of transactions.&quot;},</a>
<a name="468"><span class="lineNum">     468 </span>  [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       8928 :                         })},</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1488 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1488 times"> + </span><span class="branchCov" title="Branch 11 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 12 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 13 was not taken"> - </span>]
<a name="469"><span class="lineNum">     469 </span>                :            :                     }</a>
<a name="470"><span class="lineNum">     470 </span>  [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      13392 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1488 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 14 was taken 1488 times"> + </span><span class="branchCov" title="Branch 15 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<a name="471"><span class="lineNum">     471 </span>                :<span class="lineCov">       1488 :                 RPCExamples{</span></a>
<a name="472"><span class="lineNum">     472 </span>                :            :             &quot;\nList the most recent 10 transactions in the systems\n&quot;</a>
<a name="473"><span class="lineNum">     473 </span>  [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4464 :             + HelpExampleCli(&quot;listtransactions&quot;, &quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="474"><span class="lineNum">     474 </span>        [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1488 :             &quot;\nList transactions 100 to 120\n&quot;</span></a>
<a name="475"><span class="lineNum">     475 </span>  [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7440 :             + HelpExampleCli(&quot;listtransactions&quot;, &quot;\&quot;*\&quot; 20 100&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="476"><span class="lineNum">     476 </span>        [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1488 :             &quot;\nAs a JSON-RPC call\n&quot;</span></a>
<a name="477"><span class="lineNum">     477 </span>  [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7440 :             + HelpExampleRpc(&quot;listtransactions&quot;, &quot;\&quot;*\&quot;, 20, 100&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="478"><span class="lineNum">     478 </span>                :<span class="lineCov">       1488 :                 },</span></a>
<a name="479"><span class="lineNum">     479 </span>                :<span class="lineCov">        526 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="480"><span class="lineNum">     480 </span>                :            : {</a>
<a name="481"><span class="lineNum">     481 </span>                :<span class="lineCov">       1052 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="482"><span class="lineNum">     482 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 526 times"> + </span>]:<span class="lineCov">        526 :     if (!pwallet) return UniValue::VNULL;</span></a>
<a name="483"><span class="lineNum">     483 </span>                :            : </a>
<a name="484"><span class="lineNum">     484 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="485"><span class="lineNum">     485 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="486"><span class="lineNum">     486 </span>        [<span class="branchCov" title="Branch 0 was taken 526 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        526 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="487"><span class="lineNum">     487 </span>                :            : </a>
<a name="488"><span class="lineNum">     488 </span>                :<span class="lineCov">        526 :     std::optional&lt;std::string&gt; filter_label;</span></a>
<a name="489"><span class="lineNum">     489 </span>  [<span class="branchCov" title="Branch 0 was taken 526 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 402 times"> + </span><span class="branchCov" title="Branch 3 was taken 124 times"> + </span> :<span class="lineCov">        526 :     if (!request.params[0].isNull() &amp;&amp; request.params[0].get_str() != &quot;*&quot;) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 402 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 402 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 386 times"> + </span> 
<span class="lineNum">         </span>      <span class="branchCov" title="Branch 9 was taken 16 times"> + </span><span class="branchCov" title="Branch 10 was taken 386 times"> + </span><span class="branchCov" title="Branch 11 was taken 140 times"> + </span>]
<a name="490"><span class="lineNum">     490 </span>  [<span class="branchCov" title="Branch 0 was taken 386 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 386 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        386 :         filter_label = request.params[0].get_str();</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 386 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="491"><span class="lineNum">     491 </span>  [<span class="branchCov" title="Branch 0 was taken 386 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 384 times"> + </span>]:<span class="lineCov">        386 :         if (filter_label.value().empty()) {</span></a>
<a name="492"><span class="lineNum">     492 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Label argument must be a valid label name or \&quot;*\&quot;.&quot;);</span></a>
<a name="493"><span class="lineNum">     493 </span>                :            :         }</a>
<a name="494"><span class="lineNum">     494 </span>                :            :     }</a>
<a name="495"><span class="lineNum">     495 </span>                :<span class="lineCov">        524 :     int nCount = 10;</span></a>
<a name="496"><span class="lineNum">     496 </span>  [<span class="branchCov" title="Branch 0 was taken 524 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 400 times"> + </span><span class="branchCov" title="Branch 3 was taken 124 times"> + </span>]:<span class="lineCov">        524 :     if (!request.params[1].isNull())</span></a>
<a name="497"><span class="lineNum">     497 </span>  [<span class="branchCov" title="Branch 0 was taken 400 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 400 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">        400 :         nCount = request.params[1].getInt&lt;int&gt;();</span></a>
<a name="498"><span class="lineNum">     498 </span>                :<span class="lineCov">        524 :     int nFrom = 0;</span></a>
<a name="499"><span class="lineNum">     499 </span>  [<span class="branchCov" title="Branch 0 was taken 524 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 14 times"> + </span><span class="branchCov" title="Branch 3 was taken 510 times"> + </span>]:<span class="lineCov">        524 :     if (!request.params[2].isNull())</span></a>
<a name="500"><span class="lineNum">     500 </span>  [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         14 :         nFrom = request.params[2].getInt&lt;int&gt;();</span></a>
<a name="501"><span class="lineNum">     501 </span>                :<span class="lineCov">        524 :     isminefilter filter = ISMINE_SPENDABLE;</span></a>
<a name="502"><span class="lineNum">     502 </span>                :            : </a>
<a name="503"><span class="lineNum">     503 </span>  [<span class="branchCov" title="Branch 0 was taken 524 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 524 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        524 :     if (ParseIncludeWatchonly(request.params[3], *pwallet)) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 413 times"> + </span><span class="branchCov" title="Branch 5 was taken 111 times"> + </span>]
<a name="504"><span class="lineNum">     504 </span>                :<span class="lineCov">        413 :         filter |= ISMINE_WATCH_ONLY;</span></a>
<a name="505"><span class="lineNum">     505 </span>                :            :     }</a>
<a name="506"><span class="lineNum">     506 </span>                :            : </a>
<a name="507"><span class="lineNum">     507 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 522 times"> + </span>]:<span class="lineCov">        524 :     if (nCount &lt; 0)</span></a>
<a name="508"><span class="lineNum">     508 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :         throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Negative count&quot;);</span></a>
<a name="509"><span class="lineNum">     509 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 520 times"> + </span>]:<span class="lineCov">        522 :     if (nFrom &lt; 0)</span></a>
<a name="510"><span class="lineNum">     510 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :         throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Negative from&quot;);</span></a>
<a name="511"><span class="lineNum">     511 </span>                :            : </a>
<a name="512"><span class="lineNum">     512 </span>                :<span class="lineCov">       1040 :     std::vector&lt;UniValue&gt; ret;</span></a>
<a name="513"><span class="lineNum">     513 </span>                :            :     {</a>
<a name="514"><span class="lineNum">     514 </span>        [<span class="branchCov" title="Branch 0 was taken 520 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1040 :         LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="515"><span class="lineNum">     515 </span>                :            : </a>
<a name="516"><span class="lineNum">     516 </span>                :<span class="lineCov">        520 :         const CWallet::TxItems &amp; txOrdered = pwallet-&gt;wtxOrdered;</span></a>
<a name="517"><span class="lineNum">     517 </span>                :            : </a>
<a name="518"><span class="lineNum">     518 </span>                :            :         // iterate backwards until we have nCount items to return:</a>
<a name="519"><span class="lineNum">     519 </span>  [<span class="branchCov" title="Branch 0 was taken 21929 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 21484 times"> + </span><span class="branchCov" title="Branch 3 was taken 445 times"> + </span>]:<span class="lineCov">      21929 :         for (CWallet::TxItems::const_reverse_iterator it = txOrdered.rbegin(); it != txOrdered.rend(); ++it)</span></a>
<a name="520"><span class="lineNum">     520 </span>                :            :         {</a>
<a name="521"><span class="lineNum">     521 </span>                :<span class="lineCov">      21484 :             CWalletTx *const pwtx = (*it).second;</span></a>
<a name="522"><span class="lineNum">     522 </span>        [<span class="branchCov" title="Branch 0 was taken 21484 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">      21484 :             ListTransactions(*pwallet, *pwtx, 0, true, ret, filter, filter_label);</span></a>
<a name="523"><span class="lineNum">     523 </span>        [<span class="branchCov" title="Branch 0 was taken 75 times"> + </span><span class="branchCov" title="Branch 1 was taken 21409 times"> + </span>]:<span class="lineCov">      21484 :             if ((int)ret.size() &gt;= (nCount+nFrom)) break;</span></a>
<a name="524"><span class="lineNum">     524 </span>                :            :         }</a>
<a name="525"><span class="lineNum">     525 </span>                :            :     }</a>
<a name="526"><span class="lineNum">     526 </span>                :            : </a>
<a name="527"><span class="lineNum">     527 </span>                :            :     // ret is newest to oldest</a>
<a name="528"><span class="lineNum">     528 </span>                :            : </a>
<a name="529"><span class="lineNum">     529 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 520 times"> + </span>]:<span class="lineCov">        520 :     if (nFrom &gt; (int)ret.size())</span></a>
<a name="530"><span class="lineNum">     530 </span>                :<span class="lineNoCov">          0 :         nFrom = ret.size();</span></a>
<a name="531"><span class="lineNum">     531 </span>        [<span class="branchCov" title="Branch 0 was taken 445 times"> + </span><span class="branchCov" title="Branch 1 was taken 75 times"> + </span>]:<span class="lineCov">        520 :     if ((nFrom + nCount) &gt; (int)ret.size())</span></a>
<a name="532"><span class="lineNum">     532 </span>                :<span class="lineCov">        445 :         nCount = ret.size() - nFrom;</span></a>
<a name="533"><span class="lineNum">     533 </span>                :            : </a>
<a name="534"><span class="lineNum">     534 </span>        [<span class="branchCov" title="Branch 0 was taken 520 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        520 :     auto txs_rev_it{std::make_move_iterator(ret.rend())};</span></a>
<a name="535"><span class="lineNum">     535 </span>                :<span class="lineCov">       1040 :     UniValue result{UniValue::VARR};</span></a>
<a name="536"><span class="lineNum">     536 </span>  [<span class="branchCov" title="Branch 0 was taken 520 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 520 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        520 :     result.push_backV(txs_rev_it - nFrom - nCount, txs_rev_it - nFrom); // Return oldest to newest</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 520 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 520 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="537"><span class="lineNum">     537 </span>                :<span class="lineCov">        520 :     return result;</span></a>
<a name="538"><span class="lineNum">     538 </span>                :            : },</a>
<a name="539"><span class="lineNum">     539 </span>  [<span class="branchCov" title="Branch 0 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      38688 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1488 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1488 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1488 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 5952 times"> + </span><span class="branchCov" title="Branch 37 was taken 1488 times"> + </span><span class="branchNoCov" title="Branch 38 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 39 was not taken"> - </span>]
<a name="540"><span class="lineNum">     540 </span>                :            : }</a>
<a name="541"><span class="lineNum">     541 </span>                :            : </a>
<a name="542"><span class="lineNum">     542 </span>                :<span class="lineCov">       1026 : RPCHelpMan listsinceblock()</span></a>
<a name="543"><span class="lineNum">     543 </span>                :            : {</a>
<a name="544"><span class="lineNum">     544 </span>                :            :     return RPCHelpMan{&quot;listsinceblock&quot;,</a>
<a name="545"><span class="lineNum">     545 </span>                :            :                 &quot;\nGet all transactions in blocks since block [blockhash], or all transactions if omitted.\n&quot;</a>
<a name="546"><span class="lineNum">     546 </span>                :            :                 &quot;If \&quot;blockhash\&quot; is no longer a part of the main chain, transactions from the fork point onward are included.\n&quot;</a>
<a name="547"><span class="lineNum">     547 </span>                :            :                 &quot;Additionally, if include_removed is set, transactions affecting the wallet which were removed are returned in the \&quot;removed\&quot; array.\n&quot;,</a>
<a name="548"><span class="lineNum">     548 </span>                :            :                 {</a>
<a name="549"><span class="lineNum">     549 </span>                :<span class="lineCov">       1026 :                     {&quot;blockhash&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;If set, the block hash to list transactions since, otherwise list all transactions.&quot;},</span></a>
<a name="550"><span class="lineNum">     550 </span>        [<span class="branchCov" title="Branch 0 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2052 :                     {&quot;target_confirmations&quot;, RPCArg::Type::NUM, RPCArg::Default{1}, &quot;Return the nth block hash from the main chain. e.g. 1 would mean the best block hash. Note: this is not used as a filter, but only affects [lastblock] in the return value&quot;},</span></a>
<a name="551"><span class="lineNum">     551 </span>        [<span class="branchCov" title="Branch 0 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2052 :                     {&quot;include_watchonly&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;true for watch-only wallets, otherwise false&quot;}, &quot;Include transactions to watch-only addresses (see 'importaddress')&quot;},</span></a>
<a name="552"><span class="lineNum">     552 </span>        [<span class="branchCov" title="Branch 0 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2052 :                     {&quot;include_removed&quot;, RPCArg::Type::BOOL, RPCArg::Default{true}, &quot;Show transactions that were removed due to a reorg in the \&quot;removed\&quot; array\n&quot;</span></a>
<a name="553"><span class="lineNum">     553 </span>                :            :                                                                        &quot;(not guaranteed to work on pruned nodes)&quot;},</a>
<a name="554"><span class="lineNum">     554 </span>        [<span class="branchCov" title="Branch 0 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2052 :                     {&quot;include_change&quot;, RPCArg::Type::BOOL, RPCArg::Default{false}, &quot;Also add entries for change outputs.\n&quot;},</span></a>
<a name="555"><span class="lineNum">     555 </span>                :<span class="lineCov">       1026 :                     {&quot;label&quot;, RPCArg::Type::STR, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;Return only incoming transactions paying to addresses with the specified label.\n&quot;},</span></a>
<a name="556"><span class="lineNum">     556 </span>                :            :                 },</a>
<a name="557"><span class="lineNum">     557 </span>                :<span class="lineCov">       1026 :                 RPCResult{</span></a>
<a name="558"><span class="lineNum">     558 </span>                :            :                     RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="559"><span class="lineNum">     559 </span>                :            :                     {</a>
<a name="560"><span class="lineNum">     560 </span>                :            :                         {RPCResult::Type::ARR, &quot;transactions&quot;, &quot;&quot;,</a>
<a name="561"><span class="lineNum">     561 </span>                :            :                         {</a>
<a name="562"><span class="lineNum">     562 </span>                :<span class="lineCov">       1026 :                             {RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;, Cat(Cat&lt;std::vector&lt;RPCResult&gt;&gt;(</span></a>
<a name="563"><span class="lineNum">     563 </span>                :            :                             {</a>
<a name="564"><span class="lineNum">     564 </span>                :            :                                 {RPCResult::Type::BOOL, &quot;involvesWatchonly&quot;, /*optional=*/true, &quot;Only returns true if imported addresses were involved in transaction.&quot;},</a>
<a name="565"><span class="lineNum">     565 </span>                :            :                                 {RPCResult::Type::STR, &quot;address&quot;,  /*optional=*/true, &quot;The bitcoin address of the transaction (not returned if the output does not have an address, e.g. OP_RETURN null data).&quot;},</a>
<a name="566"><span class="lineNum">     566 </span>                :            :                                 {RPCResult::Type::STR, &quot;category&quot;, &quot;The transaction category.\n&quot;</a>
<a name="567"><span class="lineNum">     567 </span>                :            :                                     &quot;\&quot;send\&quot;                  Transactions sent.\n&quot;</a>
<a name="568"><span class="lineNum">     568 </span>                :            :                                     &quot;\&quot;receive\&quot;               Non-coinbase transactions received.\n&quot;</a>
<a name="569"><span class="lineNum">     569 </span>                :            :                                     &quot;\&quot;generate\&quot;              Coinbase transactions received with more than 100 confirmations.\n&quot;</a>
<a name="570"><span class="lineNum">     570 </span>                :            :                                     &quot;\&quot;immature\&quot;              Coinbase transactions received with 100 or fewer confirmations.\n&quot;</a>
<a name="571"><span class="lineNum">     571 </span>                :            :                                     &quot;\&quot;orphan\&quot;                Orphaned coinbase transactions received.&quot;},</a>
<a name="572"><span class="lineNum">     572 </span>        [<span class="branchCov" title="Branch 0 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2052 :                                 {RPCResult::Type::STR_AMOUNT, &quot;amount&quot;, &quot;The amount in &quot; + CURRENCY_UNIT + &quot;. This is negative for the 'send' category, and is positive\n&quot;</span></a>
<a name="573"><span class="lineNum">     573 </span>        [<span class="branchCov" title="Branch 0 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1026 :                                     &quot;for all other categories&quot;},</span></a>
<a name="574"><span class="lineNum">     574 </span>                :            :                                 {RPCResult::Type::NUM, &quot;vout&quot;, &quot;the vout value&quot;},</a>
<a name="575"><span class="lineNum">     575 </span>        [<span class="branchCov" title="Branch 0 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       2052 :                                 {RPCResult::Type::STR_AMOUNT, &quot;fee&quot;, /*optional=*/true, &quot;The amount of the fee in &quot; + CURRENCY_UNIT + &quot;. This is negative and only available for the\n&quot;</span></a>
<a name="576"><span class="lineNum">     576 </span>        [<span class="branchCov" title="Branch 0 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1026 :                                      &quot;'send' category of transactions.&quot;},</span></a>
<a name="577"><span class="lineNum">     577 </span>                :            :                             },</a>
<a name="578"><span class="lineNum">     578 </span>  [<span class="branchCov" title="Branch 0 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      23598 :                             TransactionDescriptionString()),</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1026 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1026 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1026 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 6156 times"> + </span> 
<span class="lineNum">         </span>      <span class="branchCov" title="Branch 39 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 40 was not taken"> - </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span>]
<a name="579"><span class="lineNum">     579 </span>                :            :                             {</a>
<a name="580"><span class="lineNum">     580 </span>                :            :                                 {RPCResult::Type::BOOL, &quot;abandoned&quot;, /*optional=*/true, &quot;'true' if the transaction has been abandoned (inputs are respendable). Only available for the \n&quot;</a>
<a name="581"><span class="lineNum">     581 </span>                :            :                                      &quot;'send' category of transactions.&quot;},</a>
<a name="582"><span class="lineNum">     582 </span>                :            :                                 {RPCResult::Type::STR, &quot;label&quot;, /*optional=*/true, &quot;A comment for the address/transaction, if any&quot;},</a>
<a name="583"><span class="lineNum">     583 </span>  [<span class="branchCov" title="Branch 0 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       9234 :                             })},</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1026 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 2052 times"> + </span><span class="branchCov" title="Branch 17 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 18 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 19 was not taken"> - </span>]
<a name="584"><span class="lineNum">     584 </span>                :            :                         }},</a>
<a name="585"><span class="lineNum">     585 </span>                :            :                         {RPCResult::Type::ARR, &quot;removed&quot;, /*optional=*/true, &quot;&lt;structure is the same as \&quot;transactions\&quot; above, only present if include_removed=true&gt;\n&quot;</a>
<a name="586"><span class="lineNum">     586 </span>                :            :                             &quot;Note: transactions that were re-added in the active chain will appear as-is in this array, and may thus have a positive confirmation count.&quot;</a>
<a name="587"><span class="lineNum">     587 </span>                :            :                         , {{RPCResult::Type::ELISION, &quot;&quot;, &quot;&quot;},}},</a>
<a name="588"><span class="lineNum">     588 </span>                :            :                         {RPCResult::Type::STR_HEX, &quot;lastblock&quot;, &quot;The hash of the block (target_confirmations-1) from the best block on the main chain, or the genesis hash if the referenced block does not exist yet. This is typically used to feed back into listsinceblock the next time you call it. So you would generally use a target_confirmations of say 6, so you will be continually re-notified of transactions until they've reached 6 confirmations plus any new ones&quot;},</a>
<a name="589"><span class="lineNum">     589 </span>                :            :                     }</a>
<a name="590"><span class="lineNum">     590 </span>  [<span class="branchCov" title="Branch 0 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      23598 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1026 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1026 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1026 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1026 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 3078 times"> + </span><span class="branchCov" title="Branch 43 was taken 1026 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 1026 times"> + </span><span class="branchCov" title="Branch 45 was taken 1026 times"> + </span><span class="branchCov" title="Branch 46 was taken 1026 times"> + </span><span class="branchCov" title="Branch 47 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 48 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchNoCov" title="Branch 50 was not taken"> - </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchNoCov" title="Branch 52 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 53 was not taken"> - </span>]
<a name="591"><span class="lineNum">     591 </span>                :<span class="lineCov">       1026 :                 RPCExamples{</span></a>
<a name="592"><span class="lineNum">     592 </span>  [<span class="branchCov" title="Branch 0 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       3078 :                     HelpExampleCli(&quot;listsinceblock&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="593"><span class="lineNum">     593 </span>  [<span class="branchCov" title="Branch 0 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5130 :             + HelpExampleCli(&quot;listsinceblock&quot;, &quot;\&quot;000000000000000bacf66f7497b7dc45ef753ee9a7d38571037cdb1a57f663ad\&quot; 6&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="594"><span class="lineNum">     594 </span>  [<span class="branchCov" title="Branch 0 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       5130 :             + HelpExampleRpc(&quot;listsinceblock&quot;, &quot;\&quot;000000000000000bacf66f7497b7dc45ef753ee9a7d38571037cdb1a57f663ad\&quot;, 6&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="595"><span class="lineNum">     595 </span>                :<span class="lineCov">       1026 :                 },</span></a>
<a name="596"><span class="lineNum">     596 </span>                :<span class="lineCov">         64 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="597"><span class="lineNum">     597 </span>                :            : {</a>
<a name="598"><span class="lineNum">     598 </span>                :<span class="lineCov">        128 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="599"><span class="lineNum">     599 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 64 times"> + </span>]:<span class="lineCov">         64 :     if (!pwallet) return UniValue::VNULL;</span></a>
<a name="600"><span class="lineNum">     600 </span>                :            : </a>
<a name="601"><span class="lineNum">     601 </span>                :<span class="lineCov">         64 :     const CWallet&amp; wallet = *pwallet;</span></a>
<a name="602"><span class="lineNum">     602 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="603"><span class="lineNum">     603 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="604"><span class="lineNum">     604 </span>        [<span class="branchCov" title="Branch 0 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         64 :     wallet.BlockUntilSyncedToCurrentChain();</span></a>
<a name="605"><span class="lineNum">     605 </span>                :            : </a>
<a name="606"><span class="lineNum">     606 </span>        [<span class="branchCov" title="Branch 0 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        128 :     LOCK(wallet.cs_wallet);</span></a>
<a name="607"><span class="lineNum">     607 </span>                :            : </a>
<a name="608"><span class="lineNum">     608 </span>                :<span class="lineCov">         64 :     std::optional&lt;int&gt; height;    // Height of the specified block or the common ancestor, if the block provided was in a deactivated chain.</span></a>
<a name="609"><span class="lineNum">     609 </span>                :<span class="lineCov">         64 :     std::optional&lt;int&gt; altheight; // Height of the specified block, even if it's in a deactivated chain.</span></a>
<a name="610"><span class="lineNum">     610 </span>                :<span class="lineCov">         64 :     int target_confirms = 1;</span></a>
<a name="611"><span class="lineNum">     611 </span>                :<span class="lineCov">         64 :     isminefilter filter = ISMINE_SPENDABLE;</span></a>
<a name="612"><span class="lineNum">     612 </span>                :            : </a>
<a name="613"><span class="lineNum">     613 </span>                :<span class="lineCov">         64 :     uint256 blockId;</span></a>
<a name="614"><span class="lineNum">     614 </span>  [<span class="branchCov" title="Branch 0 was taken 64 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 38 times"> + </span><span class="branchCov" title="Branch 3 was taken 26 times"> + </span> :<span class="lineCov">         64 :     if (!request.params[0].isNull() &amp;&amp; !request.params[0].get_str().empty()) {</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 38 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 38 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 36 times"> + </span> 
<span class="lineNum">         </span>      <span class="branchCov" title="Branch 9 was taken 2 times"> + </span><span class="branchCov" title="Branch 10 was taken 36 times"> + </span><span class="branchCov" title="Branch 11 was taken 28 times"> + </span>]
<a name="615"><span class="lineNum">     615 </span>  [<span class="branchCov" title="Branch 0 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 36 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         36 :         blockId = ParseHashV(request.params[0], &quot;blockhash&quot;);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 32 times"> + </span><span class="branchCov" title="Branch 5 was taken 4 times"> + </span>]
<a name="616"><span class="lineNum">     616 </span>        [<span class="branchCov" title="Branch 0 was taken 32 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         32 :         height = int{};</span></a>
<a name="617"><span class="lineNum">     617 </span>        [<span class="branchCov" title="Branch 0 was taken 32 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         32 :         altheight = int{};</span></a>
<a name="618"><span class="lineNum">     618 </span>  [<span class="branchCov" title="Branch 0 was taken 32 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 32 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         32 :         if (!wallet.chain().findCommonAncestor(blockId, wallet.GetLastBlockHash(), /*ancestor_out=*/FoundBlock().height(*height), /*block1_out=*/FoundBlock().height(*altheight))) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchCov" title="Branch 5 was taken 28 times"> + </span>]
<a name="619"><span class="lineNum">     619 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          8 :             throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Block not found&quot;);</span></a>
<a name="620"><span class="lineNum">     620 </span>                :            :         }</a>
<a name="621"><span class="lineNum">     621 </span>                :            :     }</a>
<a name="622"><span class="lineNum">     622 </span>                :            : </a>
<a name="623"><span class="lineNum">     623 </span>  [<span class="branchCov" title="Branch 0 was taken 56 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchCov" title="Branch 3 was taken 50 times"> + </span>]:<span class="lineCov">         56 :     if (!request.params[1].isNull()) {</span></a>
<a name="624"><span class="lineNum">     624 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          6 :         target_confirms = request.params[1].getInt&lt;int&gt;();</span></a>
<a name="625"><span class="lineNum">     625 </span>                :            : </a>
<a name="626"><span class="lineNum">     626 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 4 times"> + </span>]:<span class="lineCov">          6 :         if (target_confirms &lt; 1) {</span></a>
<a name="627"><span class="lineNum">     627 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :             throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Invalid parameter&quot;);</span></a>
<a name="628"><span class="lineNum">     628 </span>                :            :         }</a>
<a name="629"><span class="lineNum">     629 </span>                :            :     }</a>
<a name="630"><span class="lineNum">     630 </span>                :            : </a>
<a name="631"><span class="lineNum">     631 </span>  [<span class="branchCov" title="Branch 0 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         54 :     if (ParseIncludeWatchonly(request.params[2], wallet)) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchCov" title="Branch 5 was taken 50 times"> + </span>]
<a name="632"><span class="lineNum">     632 </span>                :<span class="lineCov">          4 :         filter |= ISMINE_WATCH_ONLY;</span></a>
<a name="633"><span class="lineNum">     633 </span>                :            :     }</a>
<a name="634"><span class="lineNum">     634 </span>                :            : </a>
<a name="635"><span class="lineNum">     635 </span>  [<span class="branchCov" title="Branch 0 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 52 times"> + </span> :<span class="lineCov">         54 :     bool include_removed = (request.params[3].isNull() || request.params[3].get_bool());</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchNoCov" title="Branch 8 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchCov" title="Branch 9 was taken 2 times"> + </span>]
<a name="636"><span class="lineNum">     636 </span>  [<span class="branchCov" title="Branch 0 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 52 times"> + </span> :<span class="lineCov">         54 :     bool include_change = (!request.params[4].isNull() &amp;&amp; request.params[4].get_bool());</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 2 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="637"><span class="lineNum">     637 </span>                :            : </a>
<a name="638"><span class="lineNum">     638 </span>                :<span class="lineCov">         54 :     std::optional&lt;std::string&gt; filter_label;</span></a>
<a name="639"><span class="lineNum">     639 </span>  [<span class="branchCov" title="Branch 0 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 50 times"> + </span>]:<span class="lineCov">         54 :     if (!request.params[5].isNull()) {</span></a>
<a name="640"><span class="lineNum">     640 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          4 :         filter_label = request.params[5].get_str();</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="641"><span class="lineNum">     641 </span>                :            :     }</a>
<a name="642"><span class="lineNum">     642 </span>                :            : </a>
<a name="643"><span class="lineNum">     643 </span>  [<span class="branchCov" title="Branch 0 was taken 26 times"> + </span><span class="branchCov" title="Branch 1 was taken 28 times"> + </span><span class="branchCov" title="Branch 2 was taken 26 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         54 :     int depth = height ? wallet.GetLastBlockHeight() + 1 - *height : -1;</span></a>
<a name="644"><span class="lineNum">     644 </span>                :            : </a>
<a name="645"><span class="lineNum">     645 </span>                :<span class="lineCov">        108 :     UniValue transactions(UniValue::VARR);</span></a>
<a name="646"><span class="lineNum">     646 </span>                :            : </a>
<a name="647"><span class="lineNum">     647 </span>        [<span class="branchCov" title="Branch 0 was taken 2494 times"> + </span><span class="branchCov" title="Branch 1 was taken 54 times"> + </span>]:<span class="lineCov">       2548 :     for (const std::pair&lt;const uint256, CWalletTx&gt;&amp; pairWtx : wallet.mapWallet) {</span></a>
<a name="648"><span class="lineNum">     648 </span>                :<span class="lineCov">       2494 :         const CWalletTx&amp; tx = pairWtx.second;</span></a>
<a name="649"><span class="lineNum">     649 </span>                :            : </a>
<a name="650"><span class="lineNum">     650 </span>  [<span class="branchCov" title="Branch 0 was taken 1463 times"> + </span><span class="branchCov" title="Branch 1 was taken 1031 times"> + </span><span class="branchCov" title="Branch 2 was taken 1463 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2494 :         if (depth == -1 || abs(wallet.GetTxDepthInMainChain(tx)) &lt; depth) {</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 22 times"> + </span><span class="branchCov" title="Branch 5 was taken 1441 times"> + </span><span class="branchCov" title="Branch 6 was taken 1053 times"> + </span><span class="branchCov" title="Branch 7 was taken 1441 times"> + </span>]
<a name="651"><span class="lineNum">     651 </span>        [<span class="branchCov" title="Branch 0 was taken 1053 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1053 :             ListTransactions(wallet, tx, 0, true, transactions, filter, filter_label, include_change);</span></a>
<a name="652"><span class="lineNum">     652 </span>                :            :         }</a>
<a name="653"><span class="lineNum">     653 </span>                :            :     }</a>
<a name="654"><span class="lineNum">     654 </span>                :            : </a>
<a name="655"><span class="lineNum">     655 </span>                :            :     // when a reorg'd block is requested, we also list any relevant transactions</a>
<a name="656"><span class="lineNum">     656 </span>                :            :     // in the blocks of the chain that was detached</a>
<a name="657"><span class="lineNum">     657 </span>                :<span class="lineCov">        108 :     UniValue removed(UniValue::VARR);</span></a>
<a name="658"><span class="lineNum">     658 </span>  [<span class="branchCov" title="Branch 0 was taken 76 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchCov" title="Branch 2 was taken 48 times"> + </span><span class="branchCov" title="Branch 3 was taken 28 times"> + </span> :<span class="lineCov">         78 :     while (include_removed &amp;&amp; altheight &amp;&amp; *altheight &gt; *height) {</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 24 times"> + </span><span class="branchCov" title="Branch 5 was taken 24 times"> + </span><span class="branchCov" title="Branch 6 was taken 24 times"> + </span><span class="branchCov" title="Branch 7 was taken 54 times"> + </span>]
<a name="659"><span class="lineNum">     659 </span>        [<span class="branchCov" title="Branch 0 was taken 24 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         24 :         CBlock block;</span></a>
<a name="660"><span class="lineNum">     660 </span>  [<span class="branchCov" title="Branch 0 was taken 24 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 24 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         24 :         if (!wallet.chain().findBlock(blockId, FoundBlock().data(block)) || block.IsNull()) {</span></a>
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 24 times"> + </span><span class="branchNoCov" title="Branch 6 was not taken"> - </span><span class="branchCov" title="Branch 7 was taken 24 times"> + </span>]
<a name="661"><span class="lineNum">     661 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_INTERNAL_ERROR, &quot;Can't read block from disk&quot;);</span></a>
<a name="662"><span class="lineNum">     662 </span>                :            :         }</a>
<a name="663"><span class="lineNum">     663 </span>        [<span class="branchCov" title="Branch 0 was taken 28 times"> + </span><span class="branchCov" title="Branch 1 was taken 24 times"> + </span>]:<span class="lineCov">         52 :         for (const CTransactionRef&amp; tx : block.vtx) {</span></a>
<a name="664"><span class="lineNum">     664 </span>        [<span class="branchCov" title="Branch 0 was taken 28 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         28 :             auto it = wallet.mapWallet.find(tx-&gt;GetHash());</span></a>
<a name="665"><span class="lineNum">     665 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchCov" title="Branch 1 was taken 24 times"> + </span>]:<span class="lineCov">         28 :             if (it != wallet.mapWallet.end()) {</span></a>
<a name="666"><span class="lineNum">     666 </span>                :            :                 // We want all transactions regardless of confirmation count to appear here,</a>
<a name="667"><span class="lineNum">     667 </span>                :            :                 // even negative confirmation ones, hence the big negative.</a>
<a name="668"><span class="lineNum">     668 </span>        [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">          4 :                 ListTransactions(wallet, it-&gt;second, -100000000, true, removed, filter, filter_label, include_change);</span></a>
<a name="669"><span class="lineNum">     669 </span>                :            :             }</a>
<a name="670"><span class="lineNum">     670 </span>                :            :         }</a>
<a name="671"><span class="lineNum">     671 </span>                :<span class="lineCov">         24 :         blockId = block.hashPrevBlock;</span></a>
<a name="672"><span class="lineNum">     672 </span>                :<span class="lineCov">         24 :         --*altheight;</span></a>
<a name="673"><span class="lineNum">     673 </span>                :            :     }</a>
<a name="674"><span class="lineNum">     674 </span>                :            : </a>
<a name="675"><span class="lineNum">     675 </span>                :<span class="lineCov">         54 :     uint256 lastblock;</span></a>
<a name="676"><span class="lineNum">     676 </span>        [<span class="branchCov" title="Branch 0 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         54 :     target_confirms = std::min(target_confirms, wallet.GetLastBlockHeight() + 1);</span></a>
<a name="677"><span class="lineNum">     677 </span>  [<span class="branchCov" title="Branch 0 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         54 :     CHECK_NONFATAL(wallet.chain().findAncestorByHeight(wallet.GetLastBlockHash(), wallet.GetLastBlockHeight() + 1 - target_confirms, FoundBlock().hash(lastblock)));</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="678"><span class="lineNum">     678 </span>                :            : </a>
<a name="679"><span class="lineNum">     679 </span>                :<span class="lineCov">        108 :     UniValue ret(UniValue::VOBJ);</span></a>
<a name="680"><span class="lineNum">     680 </span>  [<span class="branchCov" title="Branch 0 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        108 :     ret.pushKV(&quot;transactions&quot;, transactions);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="681"><span class="lineNum">     681 </span>  [<span class="branchCov" title="Branch 0 was taken 52 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchCov" title="Branch 2 was taken 52 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        106 :     if (include_removed) ret.pushKV(&quot;removed&quot;, removed);</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 52 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 52 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="682"><span class="lineNum">     682 </span>  [<span class="branchCov" title="Branch 0 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        108 :     ret.pushKV(&quot;lastblock&quot;, lastblock.GetHex());</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 54 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="683"><span class="lineNum">     683 </span>                :            : </a>
<a name="684"><span class="lineNum">     684 </span>                :<span class="lineCov">         54 :     return ret;</span></a>
<a name="685"><span class="lineNum">     685 </span>                :            : },</a>
<a name="686"><span class="lineNum">     686 </span>  [<span class="branchCov" title="Branch 0 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      34884 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1026 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1026 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1026 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1026 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 6156 times"> + </span> 
<span class="lineNum">         </span>      <span class="branchCov" title="Branch 49 was taken 1026 times"> + </span><span class="branchNoCov" title="Branch 50 was not taken"> - </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span>]
<a name="687"><span class="lineNum">     687 </span>                :            : }</a>
<a name="688"><span class="lineNum">     688 </span>                :            : </a>
<a name="689"><span class="lineNum">     689 </span>                :<span class="lineCov">       1517 : RPCHelpMan gettransaction()</span></a>
<a name="690"><span class="lineNum">     690 </span>                :            : {</a>
<a name="691"><span class="lineNum">     691 </span>                :            :     return RPCHelpMan{&quot;gettransaction&quot;,</a>
<a name="692"><span class="lineNum">     692 </span>                :            :                 &quot;\nGet detailed information about in-wallet transaction &lt;txid&gt;\n&quot;,</a>
<a name="693"><span class="lineNum">     693 </span>                :            :                 {</a>
<a name="694"><span class="lineNum">     694 </span>                :<span class="lineCov">       1517 :                     {&quot;txid&quot;, RPCArg::Type::STR, RPCArg::Optional::NO, &quot;The transaction id&quot;},</span></a>
<a name="695"><span class="lineNum">     695 </span>        [<span class="branchCov" title="Branch 0 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3034 :                     {&quot;include_watchonly&quot;, RPCArg::Type::BOOL, RPCArg::DefaultHint{&quot;true for watch-only wallets, otherwise false&quot;},</span></a>
<a name="696"><span class="lineNum">     696 </span>                :            :                             &quot;Whether to include watch-only addresses in balance calculation and details[]&quot;},</a>
<a name="697"><span class="lineNum">     697 </span>        [<span class="branchCov" title="Branch 0 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3034 :                     {&quot;verbose&quot;, RPCArg::Type::BOOL, RPCArg::Default{false},</span></a>
<a name="698"><span class="lineNum">     698 </span>                :            :                             &quot;Whether to include a `decoded` field containing the decoded transaction (equivalent to RPC decoderawtransaction)&quot;},</a>
<a name="699"><span class="lineNum">     699 </span>                :            :                 },</a>
<a name="700"><span class="lineNum">     700 </span>                :<span class="lineCov">       1517 :                 RPCResult{</span></a>
<a name="701"><span class="lineNum">     701 </span>                :<span class="lineCov">       1517 :                     RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;, Cat(Cat&lt;std::vector&lt;RPCResult&gt;&gt;(</span></a>
<a name="702"><span class="lineNum">     702 </span>                :            :                     {</a>
<a name="703"><span class="lineNum">     703 </span>        [<span class="branchCov" title="Branch 0 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3034 :                         {RPCResult::Type::STR_AMOUNT, &quot;amount&quot;, &quot;The amount in &quot; + CURRENCY_UNIT},</span></a>
<a name="704"><span class="lineNum">     704 </span>        [<span class="branchCov" title="Branch 0 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3034 :                         {RPCResult::Type::STR_AMOUNT, &quot;fee&quot;, /*optional=*/true, &quot;The amount of the fee in &quot; + CURRENCY_UNIT + &quot;. This is negative and only available for the\n&quot;</span></a>
<a name="705"><span class="lineNum">     705 </span>        [<span class="branchCov" title="Branch 0 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1517 :                                      &quot;'send' category of transactions.&quot;},</span></a>
<a name="706"><span class="lineNum">     706 </span>                :            :                     },</a>
<a name="707"><span class="lineNum">     707 </span>  [<span class="branchCov" title="Branch 0 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      16687 :                     TransactionDescriptionString()),</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1517 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 14 was taken 3034 times"> + </span><span class="branchCov" title="Branch 15 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 16 was not taken"> - </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span>]
<a name="708"><span class="lineNum">     708 </span>                :            :                     {</a>
<a name="709"><span class="lineNum">     709 </span>                :            :                         {RPCResult::Type::ARR, &quot;details&quot;, &quot;&quot;,</a>
<a name="710"><span class="lineNum">     710 </span>                :            :                         {</a>
<a name="711"><span class="lineNum">     711 </span>                :            :                             {RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="712"><span class="lineNum">     712 </span>                :            :                             {</a>
<a name="713"><span class="lineNum">     713 </span>                :            :                                 {RPCResult::Type::BOOL, &quot;involvesWatchonly&quot;, /*optional=*/true, &quot;Only returns true if imported addresses were involved in transaction.&quot;},</a>
<a name="714"><span class="lineNum">     714 </span>                :            :                                 {RPCResult::Type::STR, &quot;address&quot;, /*optional=*/true, &quot;The bitcoin address involved in the transaction.&quot;},</a>
<a name="715"><span class="lineNum">     715 </span>                :            :                                 {RPCResult::Type::STR, &quot;category&quot;, &quot;The transaction category.\n&quot;</a>
<a name="716"><span class="lineNum">     716 </span>                :            :                                     &quot;\&quot;send\&quot;                  Transactions sent.\n&quot;</a>
<a name="717"><span class="lineNum">     717 </span>                :            :                                     &quot;\&quot;receive\&quot;               Non-coinbase transactions received.\n&quot;</a>
<a name="718"><span class="lineNum">     718 </span>                :            :                                     &quot;\&quot;generate\&quot;              Coinbase transactions received with more than 100 confirmations.\n&quot;</a>
<a name="719"><span class="lineNum">     719 </span>                :            :                                     &quot;\&quot;immature\&quot;              Coinbase transactions received with 100 or fewer confirmations.\n&quot;</a>
<a name="720"><span class="lineNum">     720 </span>                :            :                                     &quot;\&quot;orphan\&quot;                Orphaned coinbase transactions received.&quot;},</a>
<a name="721"><span class="lineNum">     721 </span>        [<span class="branchCov" title="Branch 0 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3034 :                                 {RPCResult::Type::STR_AMOUNT, &quot;amount&quot;, &quot;The amount in &quot; + CURRENCY_UNIT},</span></a>
<a name="722"><span class="lineNum">     722 </span>                :            :                                 {RPCResult::Type::STR, &quot;label&quot;, /*optional=*/true, &quot;A comment for the address/transaction, if any&quot;},</a>
<a name="723"><span class="lineNum">     723 </span>                :            :                                 {RPCResult::Type::NUM, &quot;vout&quot;, &quot;the vout value&quot;},</a>
<a name="724"><span class="lineNum">     724 </span>        [<span class="branchCov" title="Branch 0 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       3034 :                                 {RPCResult::Type::STR_AMOUNT, &quot;fee&quot;, /*optional=*/true, &quot;The amount of the fee in &quot; + CURRENCY_UNIT + &quot;. This is negative and only available for the \n&quot;</span></a>
<a name="725"><span class="lineNum">     725 </span>        [<span class="branchCov" title="Branch 0 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1517 :                                     &quot;'send' category of transactions.&quot;},</span></a>
<a name="726"><span class="lineNum">     726 </span>                :            :                                 {RPCResult::Type::BOOL, &quot;abandoned&quot;, /*optional=*/true, &quot;'true' if the transaction has been abandoned (inputs are respendable). Only available for the \n&quot;</a>
<a name="727"><span class="lineNum">     727 </span>                :            :                                      &quot;'send' category of transactions.&quot;},</a>
<a name="728"><span class="lineNum">     728 </span>                :            :                                 {RPCResult::Type::ARR, &quot;parent_descs&quot;, /*optional=*/true, &quot;Only if 'category' is 'received'. List of parent descriptors for the scriptPubKey of this coin.&quot;, {</a>
<a name="729"><span class="lineNum">     729 </span>                :            :                                     {RPCResult::Type::STR, &quot;desc&quot;, &quot;The descriptor string.&quot;},</a>
<a name="730"><span class="lineNum">     730 </span>                :            :                                 }},</a>
<a name="731"><span class="lineNum">     731 </span>                :            :                             }},</a>
<a name="732"><span class="lineNum">     732 </span>                :            :                         }},</a>
<a name="733"><span class="lineNum">     733 </span>                :            :                         {RPCResult::Type::STR_HEX, &quot;hex&quot;, &quot;Raw data for transaction&quot;},</a>
<a name="734"><span class="lineNum">     734 </span>                :            :                         {RPCResult::Type::OBJ, &quot;decoded&quot;, /*optional=*/true, &quot;The decoded transaction (only present when `verbose` is passed)&quot;,</a>
<a name="735"><span class="lineNum">     735 </span>                :            :                         {</a>
<a name="736"><span class="lineNum">     736 </span>                :            :                             {RPCResult::Type::ELISION, &quot;&quot;, &quot;Equivalent to the RPC decoderawtransaction method, or the RPC getrawtransaction method when `verbose` is passed.&quot;},</a>
<a name="737"><span class="lineNum">     737 </span>                :            :                         }},</a>
<a name="738"><span class="lineNum">     738 </span>  [<span class="branchCov" title="Branch 0 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      81918 :                     })</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1517 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1517 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1517 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 31 was not taken"> - </span><span class="branchCov" title="Branch 32 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 33 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 34 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 35 was not taken"> - </span><span class="branchCov" title="Branch 36 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 37 was not taken"> - </span><span class="branchCov" title="Branch 38 was taken 1517 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 39 was not taken"> - </span><span class="branchCov" title="Branch 40 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 41 was not taken"> - </span><span class="branchCov" title="Branch 42 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 43 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 44 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 45 was not taken"> - </span><span class="branchCov" title="Branch 46 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 47 was not taken"> - </span><span class="branchCov" title="Branch 48 was taken 1517 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 49 was not taken"> - </span><span class="branchCov" title="Branch 50 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 51 was not taken"> - </span><span class="branchCov" title="Branch 52 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 53 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 54 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 55 was not taken"> - </span><span class="branchCov" title="Branch 56 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 57 was not taken"> - </span><span class="branchCov" title="Branch 58 was taken 1517 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 59 was not taken"> - </span><span class="branchCov" title="Branch 60 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 61 was not taken"> - </span><span class="branchCov" title="Branch 62 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 63 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 64 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 65 was not taken"> - </span><span class="branchCov" title="Branch 66 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 67 was not taken"> - </span><span class="branchCov" title="Branch 68 was taken 1517 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 69 was not taken"> - </span><span class="branchCov" title="Branch 70 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 71 was not taken"> - </span><span class="branchCov" title="Branch 72 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 73 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 74 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 75 was not taken"> - </span><span class="branchCov" title="Branch 76 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 77 was not taken"> - </span><span class="branchCov" title="Branch 78 was taken 1517 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 79 was not taken"> - </span><span class="branchCov" title="Branch 80 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 81 was not taken"> - </span><span class="branchCov" title="Branch 82 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 83 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 84 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 85 was not taken"> - </span><span class="branchCov" title="Branch 86 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 87 was not taken"> - </span><span class="branchCov" title="Branch 88 was taken 1517 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 89 was not taken"> - </span><span class="branchCov" title="Branch 90 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 91 was not taken"> - </span><span class="branchCov" title="Branch 92 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 93 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 94 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 95 was not taken"> - </span><span class="branchCov" title="Branch 96 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 97 was not taken"> - </span><span class="branchCov" title="Branch 98 was taken 4551 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 99 was taken 1517 times"> + </span><span class="branchCov" title="Branch 100 was taken 1517 times"> + </span><span class="branchCov" title="Branch 101 was taken 1517 times"> + </span><span class="branchCov" title="Branch 102 was taken 1517 times"> + </span><span class="branchCov" title="Branch 103 was taken 1517 times"> + </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 104 was taken 13653 times"> + </span><span class="branchCov" title="Branch 105 was taken 1517 times"> + </span><span class="branchCov" title="Branch 106 was taken 1517 times"> + </span><span class="branchCov" title="Branch 107 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 108 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 109 was not taken"> - </span><span class="branchNoCov" title="Branch 110 was not taken"> - </span><span class="branchNoCov" title="Branch 111 was not taken"> - </span><span class="branchNoCov" title="Branch 112 was not taken"> - </span><span class="branchNoCov" title="Branch 113 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 114 was not taken"> - </span><span class="branchNoCov" title="Branch 115 was not taken"> - </span><span class="branchNoCov" title="Branch 116 was not taken"> - </span><span class="branchNoCov" title="Branch 117 was not taken"> - </span>]
<a name="739"><span class="lineNum">     739 </span>  [<span class="branchCov" title="Branch 0 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6068 :                 },</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="740"><span class="lineNum">     740 </span>                :<span class="lineCov">       1517 :                 RPCExamples{</span></a>
<a name="741"><span class="lineNum">     741 </span>  [<span class="branchCov" title="Branch 0 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4551 :                     HelpExampleCli(&quot;gettransaction&quot;, &quot;\&quot;1075db55d416d3ca199f55b6084e2115b9345e16c5cf302fc80e9d5fbf5d48d\&quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="742"><span class="lineNum">     742 </span>  [<span class="branchCov" title="Branch 0 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7585 :             + HelpExampleCli(&quot;gettransaction&quot;, &quot;\&quot;1075db55d416d3ca199f55b6084e2115b9345e16c5cf302fc80e9d5fbf5d48d\&quot; true&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="743"><span class="lineNum">     743 </span>  [<span class="branchCov" title="Branch 0 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7585 :             + HelpExampleCli(&quot;gettransaction&quot;, &quot;\&quot;1075db55d416d3ca199f55b6084e2115b9345e16c5cf302fc80e9d5fbf5d48d\&quot; false true&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="744"><span class="lineNum">     744 </span>  [<span class="branchCov" title="Branch 0 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       7585 :             + HelpExampleRpc(&quot;gettransaction&quot;, &quot;\&quot;1075db55d416d3ca199f55b6084e2115b9345e16c5cf302fc80e9d5fbf5d48d\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="745"><span class="lineNum">     745 </span>                :<span class="lineCov">       1517 :                 },</span></a>
<a name="746"><span class="lineNum">     746 </span>                :<span class="lineCov">        555 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="747"><span class="lineNum">     747 </span>                :            : {</a>
<a name="748"><span class="lineNum">     748 </span>                :<span class="lineCov">       1110 :     const std::shared_ptr&lt;const CWallet&gt; pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="749"><span class="lineNum">     749 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 555 times"> + </span>]:<span class="lineCov">        555 :     if (!pwallet) return UniValue::VNULL;</span></a>
<a name="750"><span class="lineNum">     750 </span>                :            : </a>
<a name="751"><span class="lineNum">     751 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="752"><span class="lineNum">     752 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="753"><span class="lineNum">     753 </span>        [<span class="branchCov" title="Branch 0 was taken 555 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        555 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="754"><span class="lineNum">     754 </span>                :            : </a>
<a name="755"><span class="lineNum">     755 </span>        [<span class="branchCov" title="Branch 0 was taken 555 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1110 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="756"><span class="lineNum">     756 </span>                :            : </a>
<a name="757"><span class="lineNum">     757 </span>  [<span class="branchCov" title="Branch 0 was taken 555 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 555 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        555 :     uint256 hash(ParseHashV(request.params[0], &quot;txid&quot;));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 555 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="758"><span class="lineNum">     758 </span>                :            : </a>
<a name="759"><span class="lineNum">     759 </span>                :<span class="lineCov">        555 :     isminefilter filter = ISMINE_SPENDABLE;</span></a>
<a name="760"><span class="lineNum">     760 </span>                :            : </a>
<a name="761"><span class="lineNum">     761 </span>  [<span class="branchCov" title="Branch 0 was taken 555 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 555 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        555 :     if (ParseIncludeWatchonly(request.params[1], *pwallet)) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 100 times"> + </span><span class="branchCov" title="Branch 5 was taken 455 times"> + </span>]
<a name="762"><span class="lineNum">     762 </span>                :<span class="lineCov">        100 :         filter |= ISMINE_WATCH_ONLY;</span></a>
<a name="763"><span class="lineNum">     763 </span>                :            :     }</a>
<a name="764"><span class="lineNum">     764 </span>                :            : </a>
<a name="765"><span class="lineNum">     765 </span>  [<span class="branchCov" title="Branch 0 was taken 555 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 454 times"> + </span><span class="branchCov" title="Branch 3 was taken 101 times"> + </span> :<span class="lineCov">        555 :     bool verbose = request.params[2].isNull() ? false : request.params[2].get_bool();</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 101 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 101 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="766"><span class="lineNum">     766 </span>                :            : </a>
<a name="767"><span class="lineNum">     767 </span>                :<span class="lineCov">       1110 :     UniValue entry(UniValue::VOBJ);</span></a>
<a name="768"><span class="lineNum">     768 </span>        [<span class="branchCov" title="Branch 0 was taken 555 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        555 :     auto it = pwallet-&gt;mapWallet.find(hash);</span></a>
<a name="769"><span class="lineNum">     769 </span>        [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchCov" title="Branch 1 was taken 547 times"> + </span>]:<span class="lineCov">        555 :     if (it == pwallet-&gt;mapWallet.end()) {</span></a>
<a name="770"><span class="lineNum">     770 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 8 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         16 :         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Invalid or non-wallet transaction id&quot;);</span></a>
<a name="771"><span class="lineNum">     771 </span>                :            :     }</a>
<a name="772"><span class="lineNum">     772 </span>                :<span class="lineCov">        547 :     const CWalletTx&amp; wtx = it-&gt;second;</span></a>
<a name="773"><span class="lineNum">     773 </span>                :            : </a>
<a name="774"><span class="lineNum">     774 </span>        [<span class="branchCov" title="Branch 0 was taken 547 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        547 :     CAmount nCredit = CachedTxGetCredit(*pwallet, wtx, filter);</span></a>
<a name="775"><span class="lineNum">     775 </span>        [<span class="branchCov" title="Branch 0 was taken 547 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        547 :     CAmount nDebit = CachedTxGetDebit(*pwallet, wtx, filter);</span></a>
<a name="776"><span class="lineNum">     776 </span>                :<span class="lineCov">        547 :     CAmount nNet = nCredit - nDebit;</span></a>
<a name="777"><span class="lineNum">     777 </span>  [<span class="branchCov" title="Branch 0 was taken 547 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 492 times"> + </span><span class="branchCov" title="Branch 3 was taken 55 times"> + </span> :<span class="lineCov">        547 :     CAmount nFee = (CachedTxIsFromMe(*pwallet, wtx, filter) ? wtx.tx-&gt;GetValueOut() - nDebit : 0);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 492 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="778"><span class="lineNum">     778 </span>                :            : </a>
<a name="779"><span class="lineNum">     779 </span>  [<span class="branchCov" title="Branch 0 was taken 547 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 547 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1094 :     entry.pushKV(&quot;amount&quot;, ValueFromAmount(nNet - nFee));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 547 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="780"><span class="lineNum">     780 </span>  [<span class="branchCov" title="Branch 0 was taken 547 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 492 times"> + </span><span class="branchCov" title="Branch 3 was taken 55 times"> + </span>]:<span class="lineCov">        547 :     if (CachedTxIsFromMe(*pwallet, wtx, filter))</span></a>
<a name="781"><span class="lineNum">     781 </span>  [<span class="branchCov" title="Branch 0 was taken 492 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 492 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        984 :         entry.pushKV(&quot;fee&quot;, ValueFromAmount(nFee));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 492 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="782"><span class="lineNum">     782 </span>                :            : </a>
<a name="783"><span class="lineNum">     783 </span>        [<span class="branchCov" title="Branch 0 was taken 547 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        547 :     WalletTxToJSON(*pwallet, wtx, entry);</span></a>
<a name="784"><span class="lineNum">     784 </span>                :            : </a>
<a name="785"><span class="lineNum">     785 </span>                :<span class="lineCov">       1094 :     UniValue details(UniValue::VARR);</span></a>
<a name="786"><span class="lineNum">     786 </span>        [<span class="branchCov" title="Branch 0 was taken 547 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        547 :     ListTransactions(*pwallet, wtx, 0, false, details, filter, /*filter_label=*/std::nullopt);</span></a>
<a name="787"><span class="lineNum">     787 </span>  [<span class="branchCov" title="Branch 0 was taken 547 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 547 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1094 :     entry.pushKV(&quot;details&quot;, details);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 547 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="788"><span class="lineNum">     788 </span>                :            : </a>
<a name="789"><span class="lineNum">     789 </span>  [<span class="branchCov" title="Branch 0 was taken 547 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 547 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">       1094 :     std::string strHex = EncodeHexTx(*wtx.tx, pwallet-&gt;chain().rpcSerializationFlags());</span></a>
<a name="790"><span class="lineNum">     790 </span>  [<span class="branchCov" title="Branch 0 was taken 547 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 547 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       1094 :     entry.pushKV(&quot;hex&quot;, strHex);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 547 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="791"><span class="lineNum">     791 </span>                :            : </a>
<a name="792"><span class="lineNum">     792 </span>        [<span class="branchCov" title="Branch 0 was taken 99 times"> + </span><span class="branchCov" title="Branch 1 was taken 448 times"> + </span>]:<span class="lineCov">        547 :     if (verbose) {</span></a>
<a name="793"><span class="lineNum">     793 </span>                :<span class="lineCov">        198 :         UniValue decoded(UniValue::VOBJ);</span></a>
<a name="794"><span class="lineNum">     794 </span>  [<span class="branchCov" title="Branch 0 was taken 99 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 99 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         99 :         TxToUniv(*wtx.tx, /*block_hash=*/uint256(), /*entry=*/decoded, /*include_hex=*/false);</span></a>
<a name="795"><span class="lineNum">     795 </span>  [<span class="branchCov" title="Branch 0 was taken 99 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 99 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">        198 :         entry.pushKV(&quot;decoded&quot;, decoded);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 99 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="796"><span class="lineNum">     796 </span>                :            :     }</a>
<a name="797"><span class="lineNum">     797 </span>                :            : </a>
<a name="798"><span class="lineNum">     798 </span>                :<span class="lineCov">        547 :     return entry;</span></a>
<a name="799"><span class="lineNum">     799 </span>                :            : },</a>
<a name="800"><span class="lineNum">     800 </span>  [<span class="branchCov" title="Branch 0 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      31857 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 1517 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 1517 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 24 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 25 was not taken"> - </span><span class="branchCov" title="Branch 26 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span><span class="branchCov" title="Branch 28 was taken 1517 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 29 was not taken"> - </span><span class="branchCov" title="Branch 30 was taken 4551 times"> + </span><span class="branchCov" title="Branch 31 was taken 1517 times"> + </span><span class="branchNoCov" title="Branch 32 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 33 was not taken"> - </span>]
<a name="801"><span class="lineNum">     801 </span>                :            : }</a>
<a name="802"><span class="lineNum">     802 </span>                :            : </a>
<a name="803"><span class="lineNum">     803 </span>                :<span class="lineCov">        975 : RPCHelpMan abandontransaction()</span></a>
<a name="804"><span class="lineNum">     804 </span>                :            : {</a>
<a name="805"><span class="lineNum">     805 </span>                :            :     return RPCHelpMan{&quot;abandontransaction&quot;,</a>
<a name="806"><span class="lineNum">     806 </span>                :            :                 &quot;\nMark in-wallet transaction &lt;txid&gt; as abandoned\n&quot;</a>
<a name="807"><span class="lineNum">     807 </span>                :            :                 &quot;This will mark this transaction and all its in-wallet descendants as abandoned which will allow\n&quot;</a>
<a name="808"><span class="lineNum">     808 </span>                :            :                 &quot;for their inputs to be respent.  It can be used to replace \&quot;stuck\&quot; or evicted transactions.\n&quot;</a>
<a name="809"><span class="lineNum">     809 </span>                :            :                 &quot;It only works on transactions which are not included in a block and are not currently in the mempool.\n&quot;</a>
<a name="810"><span class="lineNum">     810 </span>                :            :                 &quot;It has no effect on transactions which are already abandoned.\n&quot;,</a>
<a name="811"><span class="lineNum">     811 </span>                :            :                 {</a>
<a name="812"><span class="lineNum">     812 </span>                :<span class="lineCov">        975 :                     {&quot;txid&quot;, RPCArg::Type::STR_HEX, RPCArg::Optional::NO, &quot;The transaction id&quot;},</span></a>
<a name="813"><span class="lineNum">     813 </span>                :            :                 },</a>
<a name="814"><span class="lineNum">     814 </span>  [<span class="branchCov" title="Branch 0 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2925 :                 RPCResult{RPCResult::Type::NONE, &quot;&quot;, &quot;&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="815"><span class="lineNum">     815 </span>                :<span class="lineCov">        975 :                 RPCExamples{</span></a>
<a name="816"><span class="lineNum">     816 </span>  [<span class="branchCov" title="Branch 0 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2925 :                     HelpExampleCli(&quot;abandontransaction&quot;, &quot;\&quot;1075db55d416d3ca199f55b6084e2115b9345e16c5cf302fc80e9d5fbf5d48d\&quot;&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="817"><span class="lineNum">     817 </span>  [<span class="branchCov" title="Branch 0 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4875 :             + HelpExampleRpc(&quot;abandontransaction&quot;, &quot;\&quot;1075db55d416d3ca199f55b6084e2115b9345e16c5cf302fc80e9d5fbf5d48d\&quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="818"><span class="lineNum">     818 </span>                :<span class="lineCov">        975 :                 },</span></a>
<a name="819"><span class="lineNum">     819 </span>                :<span class="lineCov">         13 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="820"><span class="lineNum">     820 </span>                :            : {</a>
<a name="821"><span class="lineNum">     821 </span>                :<span class="lineCov">         26 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="822"><span class="lineNum">     822 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 13 times"> + </span>]:<span class="lineCov">         13 :     if (!pwallet) return UniValue::VNULL;</span></a>
<a name="823"><span class="lineNum">     823 </span>                :            : </a>
<a name="824"><span class="lineNum">     824 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="825"><span class="lineNum">     825 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="826"><span class="lineNum">     826 </span>        [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         13 :     pwallet-&gt;BlockUntilSyncedToCurrentChain();</span></a>
<a name="827"><span class="lineNum">     827 </span>                :            : </a>
<a name="828"><span class="lineNum">     828 </span>        [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         26 :     LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="829"><span class="lineNum">     829 </span>                :            : </a>
<a name="830"><span class="lineNum">     830 </span>  [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         13 :     uint256 hash(ParseHashV(request.params[0], &quot;txid&quot;));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="831"><span class="lineNum">     831 </span>                :            : </a>
<a name="832"><span class="lineNum">     832 </span>  [<span class="branchCov" title="Branch 0 was taken 13 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchCov" title="Branch 3 was taken 11 times"> + </span>]:<span class="lineCov">         13 :     if (!pwallet-&gt;mapWallet.count(hash)) {</span></a>
<a name="833"><span class="lineNum">     833 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Invalid or non-wallet transaction id&quot;);</span></a>
<a name="834"><span class="lineNum">     834 </span>                :            :     }</a>
<a name="835"><span class="lineNum">     835 </span>  [<span class="branchCov" title="Branch 0 was taken 11 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchCov" title="Branch 3 was taken 7 times"> + </span>]:<span class="lineCov">         11 :     if (!pwallet-&gt;AbandonTransaction(hash)) {</span></a>
<a name="836"><span class="lineNum">     836 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 4 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          8 :         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, &quot;Transaction not eligible for abandonment&quot;);</span></a>
<a name="837"><span class="lineNum">     837 </span>                :            :     }</a>
<a name="838"><span class="lineNum">     838 </span>                :            : </a>
<a name="839"><span class="lineNum">     839 </span>                :<span class="lineCov">          7 :     return UniValue::VNULL;</span></a>
<a name="840"><span class="lineNum">     840 </span>                :            : },</a>
<a name="841"><span class="lineNum">     841 </span>  [<span class="branchCov" title="Branch 0 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      10725 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 975 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 975 times"> + </span> 
<span class="lineNum">         </span>      <span class="branchCov" title="Branch 19 was taken 975 times"> + </span><span class="branchNoCov" title="Branch 20 was not taken"> - </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span>]
<a name="842"><span class="lineNum">     842 </span>                :            : }</a>
<a name="843"><span class="lineNum">     843 </span>                :            : </a>
<a name="844"><span class="lineNum">     844 </span>                :<span class="lineCov">        982 : RPCHelpMan rescanblockchain()</span></a>
<a name="845"><span class="lineNum">     845 </span>                :            : {</a>
<a name="846"><span class="lineNum">     846 </span>                :            :     return RPCHelpMan{&quot;rescanblockchain&quot;,</a>
<a name="847"><span class="lineNum">     847 </span>                :            :                 &quot;\nRescan the local blockchain for wallet related transactions.\n&quot;</a>
<a name="848"><span class="lineNum">     848 </span>                :            :                 &quot;Note: Use \&quot;getwalletinfo\&quot; to query the scanning progress.\n&quot;</a>
<a name="849"><span class="lineNum">     849 </span>                :            :                 &quot;The rescan is significantly faster when used on a descriptor wallet\n&quot;</a>
<a name="850"><span class="lineNum">     850 </span>                :            :                 &quot;and block filters are available (using startup option \&quot;-blockfilterindex=1\&quot;).\n&quot;,</a>
<a name="851"><span class="lineNum">     851 </span>                :            :                 {</a>
<a name="852"><span class="lineNum">     852 </span>        [<span class="branchCov" title="Branch 0 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">       1964 :                     {&quot;start_height&quot;, RPCArg::Type::NUM, RPCArg::Default{0}, &quot;block height where the rescan should start&quot;},</span></a>
<a name="853"><span class="lineNum">     853 </span>                :<span class="lineCov">        982 :                     {&quot;stop_height&quot;, RPCArg::Type::NUM, RPCArg::Optional::OMITTED_NAMED_ARG, &quot;the last block height that should be scanned. If none is provided it will rescan up to the tip at return time of this call.&quot;},</span></a>
<a name="854"><span class="lineNum">     854 </span>                :            :                 },</a>
<a name="855"><span class="lineNum">     855 </span>                :<span class="lineCov">        982 :                 RPCResult{</span></a>
<a name="856"><span class="lineNum">     856 </span>                :            :                     RPCResult::Type::OBJ, &quot;&quot;, &quot;&quot;,</a>
<a name="857"><span class="lineNum">     857 </span>                :            :                     {</a>
<a name="858"><span class="lineNum">     858 </span>                :            :                         {RPCResult::Type::NUM, &quot;start_height&quot;, &quot;The block height where the rescan started (the requested height or 0)&quot;},</a>
<a name="859"><span class="lineNum">     859 </span>                :            :                         {RPCResult::Type::NUM, &quot;stop_height&quot;, &quot;The height of the last rescanned block. May be null in rare cases if there was a reorg and the call didn't scan any blocks because they were already scanned in the background.&quot;},</a>
<a name="860"><span class="lineNum">     860 </span>                :            :                     }</a>
<a name="861"><span class="lineNum">     861 </span>  [<span class="branchCov" title="Branch 0 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       9820 :                 },</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 982 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 982 times"> + </span> 
<span class="lineNum">         </span>   <span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 1964 times"> + </span><span class="branchCov" title="Branch 21 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 22 was not taken"> - </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 23 was not taken"> - </span>]
<a name="862"><span class="lineNum">     862 </span>                :<span class="lineCov">        982 :                 RPCExamples{</span></a>
<a name="863"><span class="lineNum">     863 </span>  [<span class="branchCov" title="Branch 0 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2946 :                     HelpExampleCli(&quot;rescanblockchain&quot;, &quot;100000 120000&quot;)</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="864"><span class="lineNum">     864 </span>  [<span class="branchCov" title="Branch 0 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4910 :             + HelpExampleRpc(&quot;rescanblockchain&quot;, &quot;100000, 120000&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="865"><span class="lineNum">     865 </span>                :<span class="lineCov">        982 :                 },</span></a>
<a name="866"><span class="lineNum">     866 </span>                :<span class="lineCov">         20 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="867"><span class="lineNum">     867 </span>                :            : {</a>
<a name="868"><span class="lineNum">     868 </span>                :<span class="lineCov">         40 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="869"><span class="lineNum">     869 </span>        [<span class="branchNoCov" title="Branch 0 was not taken"> - </span><span class="branchCov" title="Branch 1 was taken 20 times"> + </span>]:<span class="lineCov">         20 :     if (!pwallet) return UniValue::VNULL;</span></a>
<a name="870"><span class="lineNum">     870 </span>                :<span class="lineCov">         20 :     CWallet&amp; wallet{*pwallet};</span></a>
<a name="871"><span class="lineNum">     871 </span>                :            : </a>
<a name="872"><span class="lineNum">     872 </span>                :            :     // Make sure the results are valid at least up to the most recent block</a>
<a name="873"><span class="lineNum">     873 </span>                :            :     // the user could have gotten from another RPC command prior to now</a>
<a name="874"><span class="lineNum">     874 </span>        [<span class="branchCov" title="Branch 0 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         20 :     wallet.BlockUntilSyncedToCurrentChain();</span></a>
<a name="875"><span class="lineNum">     875 </span>                :            : </a>
<a name="876"><span class="lineNum">     876 </span>                :<span class="lineCov">         40 :     WalletRescanReserver reserver(*pwallet);</span></a>
<a name="877"><span class="lineNum">     877 </span>  [<span class="branchCov" title="Branch 0 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 20 times"> + </span>]:<span class="lineCov">         20 :     if (!reserver.reserve()) {</span></a>
<a name="878"><span class="lineNum">     878 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_WALLET_ERROR, &quot;Wallet is currently rescanning. Abort existing rescan or wait.&quot;);</span></a>
<a name="879"><span class="lineNum">     879 </span>                :            :     }</a>
<a name="880"><span class="lineNum">     880 </span>                :            : </a>
<a name="881"><span class="lineNum">     881 </span>                :<span class="lineCov">         20 :     int start_height = 0;</span></a>
<a name="882"><span class="lineNum">     882 </span>                :<span class="lineCov">         20 :     std::optional&lt;int&gt; stop_height;</span></a>
<a name="883"><span class="lineNum">     883 </span>                :<span class="lineCov">         20 :     uint256 start_block;</span></a>
<a name="884"><span class="lineNum">     884 </span>                :            :     {</a>
<a name="885"><span class="lineNum">     885 </span>        [<span class="branchCov" title="Branch 0 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         40 :         LOCK(pwallet-&gt;cs_wallet);</span></a>
<a name="886"><span class="lineNum">     886 </span>        [<span class="branchCov" title="Branch 0 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         20 :         int tip_height = pwallet-&gt;GetLastBlockHeight();</span></a>
<a name="887"><span class="lineNum">     887 </span>                :            : </a>
<a name="888"><span class="lineNum">     888 </span>  [<span class="branchCov" title="Branch 0 was taken 20 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 10 times"> + </span><span class="branchCov" title="Branch 3 was taken 10 times"> + </span>]:<span class="lineCov">         20 :         if (!request.params[0].isNull()) {</span></a>
<a name="889"><span class="lineNum">     889 </span>  [<span class="branchCov" title="Branch 0 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 10 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         10 :             start_height = request.params[0].getInt&lt;int&gt;();</span></a>
<a name="890"><span class="lineNum">     890 </span>  [<span class="branchCov" title="Branch 0 was taken 8 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 8 times"> + </span>]:<span class="lineCov">         10 :             if (start_height &lt; 0 || start_height &gt; tip_height) {</span></a>
<a name="891"><span class="lineNum">     891 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Invalid start_height&quot;);</span></a>
<a name="892"><span class="lineNum">     892 </span>                :            :             }</a>
<a name="893"><span class="lineNum">     893 </span>                :            :         }</a>
<a name="894"><span class="lineNum">     894 </span>                :            : </a>
<a name="895"><span class="lineNum">     895 </span>  [<span class="branchCov" title="Branch 0 was taken 18 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchCov" title="Branch 3 was taken 12 times"> + </span>]:<span class="lineCov">         18 :         if (!request.params[1].isNull()) {</span></a>
<a name="896"><span class="lineNum">     896 </span>  [<span class="branchCov" title="Branch 0 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">          6 :             stop_height = request.params[1].getInt&lt;int&gt;();</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 6 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="897"><span class="lineNum">     897 </span>  [<span class="branchCov" title="Branch 0 was taken 4 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchCov" title="Branch 3 was taken 4 times"> + </span> :<span class="lineCov">          6 :             if (*stop_height &lt; 0 || *stop_height &gt; tip_height) {</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 2 times"> + </span><span class="branchCov" title="Branch 5 was taken 4 times"> + </span>]
<a name="898"><span class="lineNum">     898 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;Invalid stop_height&quot;);</span></a>
<a name="899"><span class="lineNum">     899 </span>        [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchCov" title="Branch 1 was taken 2 times"> + </span>]:<span class="lineCov">          4 :             } else if (*stop_height &lt; start_height) {</span></a>
<a name="900"><span class="lineNum">     900 </span>  [<span class="branchCov" title="Branch 0 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 2 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">          4 :                 throw JSONRPCError(RPC_INVALID_PARAMETER, &quot;stop_height must be greater than start_height&quot;);</span></a>
<a name="901"><span class="lineNum">     901 </span>                :            :             }</a>
<a name="902"><span class="lineNum">     902 </span>                :            :         }</a>
<a name="903"><span class="lineNum">     903 </span>                :            : </a>
<a name="904"><span class="lineNum">     904 </span>                :            :         // We can't rescan beyond non-pruned blocks, stop and throw an error</a>
<a name="905"><span class="lineNum">     905 </span>  [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         14 :         if (!pwallet-&gt;chain().hasBlocks(pwallet-&gt;GetLastBlockHash(), start_height, stop_height)) {</span></a>
<span class="lineNum">         </span>         <span class="branchNoCov" title="Branch 4 was not taken"> - </span><span class="branchCov" title="Branch 5 was taken 14 times"> + </span>]
<a name="906"><span class="lineNum">     906 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :             throw JSONRPCError(RPC_MISC_ERROR, &quot;Can't rescan beyond pruned data. Use RPC call getblockchaininfo to determine your pruned height.&quot;);</span></a>
<a name="907"><span class="lineNum">     907 </span>                :            :         }</a>
<a name="908"><span class="lineNum">     908 </span>                :            : </a>
<a name="909"><span class="lineNum">     909 </span>  [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         14 :         CHECK_NONFATAL(pwallet-&gt;chain().findAncestorByHeight(pwallet-&gt;GetLastBlockHash(), start_height, FoundBlock().hash(start_block)));</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="910"><span class="lineNum">     910 </span>                :            :     }</a>
<a name="911"><span class="lineNum">     911 </span>                :            : </a>
<a name="912"><span class="lineNum">     912 </span>                :            :     CWallet::ScanResult result =</a>
<a name="913"><span class="lineNum">     913 </span>        [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">         14 :         pwallet-&gt;ScanForWalletTransactions(start_block, start_height, stop_height, reserver, /*fUpdate=*/true, /*save_progress=*/false);</span></a>
<a name="914"><span class="lineNum">     914 </span>  [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchNoCov" title="Branch 2 was not taken"> - </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span>]:<span class="lineCov">         14 :     switch (result.status) {</span></a>
<a name="915"><span class="lineNum">     915 </span>                :<span class="lineCov">         14 :     case CWallet::ScanResult::SUCCESS:</span></a>
<a name="916"><span class="lineNum">     916 </span>                :<span class="lineCov">         14 :         break;</span></a>
<a name="917"><span class="lineNum">     917 </span>                :<span class="lineNoCov">          0 :     case CWallet::ScanResult::FAILURE:</span></a>
<a name="918"><span class="lineNum">     918 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_MISC_ERROR, &quot;Rescan failed. Potentially corrupted data files.&quot;);</span></a>
<a name="919"><span class="lineNum">     919 </span>                :<span class="lineNoCov">          0 :     case CWallet::ScanResult::USER_ABORT:</span></a>
<a name="920"><span class="lineNum">     920 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span>]:<span class="lineNoCov">          0 :         throw JSONRPCError(RPC_MISC_ERROR, &quot;Rescan aborted.&quot;);</span></a>
<a name="921"><span class="lineNum">     921 </span>                :            :         // no default case, so the compiler can warn about missing cases</a>
<a name="922"><span class="lineNum">     922 </span>                :            :     }</a>
<a name="923"><span class="lineNum">     923 </span>                :<span class="lineCov">         28 :     UniValue response(UniValue::VOBJ);</span></a>
<a name="924"><span class="lineNum">     924 </span>  [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         28 :     response.pushKV(&quot;start_height&quot;, start_height);</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="925"><span class="lineNum">     925 </span>  [<span class="branchCov" title="Branch 0 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">         28 :     response.pushKV(&quot;stop_height&quot;, result.last_scanned_height ? *result.last_scanned_height : UniValue());</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 14 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="926"><span class="lineNum">     926 </span>                :<span class="lineCov">         14 :     return response;</span></a>
<a name="927"><span class="lineNum">     927 </span>                :            : },</a>
<a name="928"><span class="lineNum">     928 </span>  [<span class="branchCov" title="Branch 0 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">      15712 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 982 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 9 was not taken"> - </span><span class="branchCov" title="Branch 10 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 11 was not taken"> - </span><span class="branchCov" title="Branch 12 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 13 was not taken"> - </span> 
<span class="lineNum">         </span><span class="branchCov" title="Branch 14 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 15 was not taken"> - </span><span class="branchCov" title="Branch 16 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 17 was not taken"> - </span><span class="branchCov" title="Branch 18 was taken 982 times"> + </span> 
<span class="lineNum">         </span><span class="branchNoCov" title="Branch 19 was not taken"> - </span><span class="branchCov" title="Branch 20 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 21 was not taken"> - </span><span class="branchCov" title="Branch 22 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 23 was not taken"> - </span> 
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 24 was taken 1964 times"> + </span><span class="branchCov" title="Branch 25 was taken 982 times"> + </span><span class="branchNoCov" title="Branch 26 was not taken"> - </span><span class="branchNoCov" title="Branch 27 was not taken"> - </span>]
<a name="929"><span class="lineNum">     929 </span>                :            : }</a>
<a name="930"><span class="lineNum">     930 </span>                :            : </a>
<a name="931"><span class="lineNum">     931 </span>                :<span class="lineCov">        962 : RPCHelpMan abortrescan()</span></a>
<a name="932"><span class="lineNum">     932 </span>                :            : {</a>
<a name="933"><span class="lineNum">     933 </span>                :            :     return RPCHelpMan{&quot;abortrescan&quot;,</a>
<a name="934"><span class="lineNum">     934 </span>                :            :                 &quot;\nStops current wallet rescan triggered by an RPC call, e.g. by an importprivkey call.\n&quot;</a>
<a name="935"><span class="lineNum">     935 </span>                :            :                 &quot;Note: Use \&quot;getwalletinfo\&quot; to query the scanning progress.\n&quot;,</a>
<a name="936"><span class="lineNum">     936 </span>                :            :                 {},</a>
<a name="937"><span class="lineNum">     937 </span>  [<span class="branchCov" title="Branch 0 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2886 :                 RPCResult{RPCResult::Type::BOOL, &quot;&quot;, &quot;Whether the abort was successful&quot;},</span></a>
<span class="lineNum">         </span>         <span class="branchCov" title="Branch 4 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span>]
<a name="938"><span class="lineNum">     938 </span>                :<span class="lineCov">        962 :                 RPCExamples{</span></a>
<a name="939"><span class="lineNum">     939 </span>                :            :             &quot;\nImport a private key\n&quot;</a>
<a name="940"><span class="lineNum">     940 </span>  [<span class="branchCov" title="Branch 0 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       2886 :             + HelpExampleCli(&quot;importprivkey&quot;, &quot;\&quot;mykey\&quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="941"><span class="lineNum">     941 </span>        [<span class="branchCov" title="Branch 0 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        962 :             &quot;\nAbort the running wallet rescan\n&quot;</span></a>
<a name="942"><span class="lineNum">     942 </span>  [<span class="branchCov" title="Branch 0 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4810 :             + HelpExampleCli(&quot;abortrescan&quot;, &quot;&quot;) +</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="943"><span class="lineNum">     943 </span>        [<span class="branchCov" title="Branch 0 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span>]:<span class="lineCov">        962 :             &quot;\nAs a JSON-RPC call\n&quot;</span></a>
<a name="944"><span class="lineNum">     944 </span>  [<span class="branchCov" title="Branch 0 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       4810 :             + HelpExampleRpc(&quot;abortrescan&quot;, &quot;&quot;)</span></a>
<span class="lineNum">         </span>   <span class="branchCov" title="Branch 4 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span>]
<a name="945"><span class="lineNum">     945 </span>                :<span class="lineCov">        962 :                 },</span></a>
<a name="946"><span class="lineNum">     946 </span>                :<span class="lineNoCov">          0 :         [&amp;](const RPCHelpMan&amp; self, const JSONRPCRequest&amp; request) -&gt; UniValue</span></a>
<a name="947"><span class="lineNum">     947 </span>                :            : {</a>
<a name="948"><span class="lineNum">     948 </span>                :<span class="lineNoCov">          0 :     std::shared_ptr&lt;CWallet&gt; const pwallet = GetWalletForJSONRPCRequest(request);</span></a>
<a name="949"><span class="lineNum">     949 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :     if (!pwallet) return UniValue::VNULL;</span></a>
<a name="950"><span class="lineNum">     950 </span>                :            : </a>
<a name="951"><span class="lineNum">     951 </span>  [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span><span class="branchNoExec" title="Branch 2 was not executed"> # </span><span class="branchNoExec" title="Branch 3 was not executed"> # </span> :<span class="lineNoCov">          0 :     if (!pwallet-&gt;IsScanning() || pwallet-&gt;IsAbortingRescan()) return false;</span></a>
<span class="lineNum">         </span>   <span class="branchNoExec" title="Branch 4 was not executed"> # </span><span class="branchNoExec" title="Branch 5 was not executed"> # </span><span class="branchNoExec" title="Branch 6 was not executed"> # </span><span class="branchNoExec" title="Branch 7 was not executed"> # </span>]
<a name="952"><span class="lineNum">     952 </span>                :<span class="lineNoCov">          0 :     pwallet-&gt;AbortRescan();</span></a>
<a name="953"><span class="lineNum">     953 </span>        [<span class="branchNoExec" title="Branch 0 was not executed"> # </span><span class="branchNoExec" title="Branch 1 was not executed"> # </span>]:<span class="lineNoCov">          0 :     return true;</span></a>
<a name="954"><span class="lineNum">     954 </span>                :            : },</a>
<a name="955"><span class="lineNum">     955 </span>  [<span class="branchCov" title="Branch 0 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 1 was not taken"> - </span><span class="branchCov" title="Branch 2 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 3 was not taken"> - </span> :<span class="lineCov">       6734 :     };</span></a>
<span class="lineNum">         </span><span class="branchCov" title="Branch 4 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 5 was not taken"> - </span><span class="branchCov" title="Branch 6 was taken 962 times"> + </span><span class="branchNoCov" title="Branch 7 was not taken"> - </span><span class="branchCov" title="Branch 8 was taken 962 times"> + </span> 
<span class="lineNum">         </span>            <span class="branchNoCov" title="Branch 9 was not taken"> - </span>]
<a name="956"><span class="lineNum">     956 </span>                :            : }</a>
<a name="957"><span class="lineNum">     957 </span>                :            : } // namespace wallet</a>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.14</a></td></tr>
  </table>
  <br>

</body>
</html>
